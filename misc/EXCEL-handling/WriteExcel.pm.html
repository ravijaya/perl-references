<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
  <link rel="stylesheet" href="WriteExcel.pm_files/style.css" type="text/css">
<style>
.styleswitch {
  text-align: right;
}
</style>


<script type="text/javascript" src="WriteExcel.pm_files/jquery_002.js"></script>
<script type="text/javascript" src="WriteExcel.pm_files/jquery_003.js"></script>
<script type="text/javascript" src="WriteExcel.pm_files/sh_main.js"></script>
<script type="text/javascript" src="WriteExcel.pm_files/sh_perl.js"></script>
<script type="text/javascript" src="WriteExcel.pm_files/jquery.js"></script>

<link rel="stylesheet" href="WriteExcel.pm_files/print.css" type="text/css" media="print">
  <link rel="alternate" type="application/rss+xml" title="RSS 1.0" href="http://search.cpan.org/uploads.rdf">
  <link rel="search" href="http://st.pimg.net/tucs/opensearch.xml" type="application/opensearchdescription+xml" title="SearchCPAN">
  <title>Spreadsheet::WriteExcel - search.cpan.org</title>
 <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3528438-1']);
    _gaq.push(["_setCustomVar",2,"Distribution","Spreadsheet-WriteExcel",3]);
    _gaq.push(["_setCustomVar",5,"Release","Spreadsheet-WriteExcel-2.38",3]);
    _gaq.push(["_setCustomVar",3,"Module","Spreadsheet::WriteExcel",3]);
    _gaq.push(["_setCustomVar",1,"Author","JMCNAMARA",3]);
    _gaq.push(['_trackPageview']);
  </script>
 <link rel="stylesheet" type="text/css" href="WriteExcel.pm_files/sh_none.css" id="theme0.9348627577944596"></head>
 <body id="cpansearch">
<center><div class="logo"><a href="http://search.cpan.org/"><img src="WriteExcel.pm_files/cpan_banner.png" alt="CPAN"></a></div></center>
<div class="menubar">
 <a href="http://search.cpan.org/">Home</a>
 <a href="http://search.cpan.org/author/">Authors</a>
 <a href="http://search.cpan.org/recent">Recent</a>
 <a href="http://log.perl.org/cpansearch/">News</a>
 <a href="http://search.cpan.org/mirror">Mirrors</a>
 <a href="http://search.cpan.org/faq.html">FAQ</a>
 <a href="http://search.cpan.org/feedback">Feedback</a>
</div>
<form method="get" action="/search" name="f" class="searchbox">
<input name="query" size="35" type="text">
<br>in <select name="mode">
 <option selected="selected" value="all">All</option>
 <option value="module">Modules</option>
 <option value="dist">Distributions</option>
 <option value="author">Authors</option>
</select>&nbsp;<input value="CPAN Search" type="submit">
</form>


 <a name="_top"></a>
  <div class="path">
<div id="permalink" class="noprint"><a href="http://search.cpan.org/perldoc?Spreadsheet%3A%3AWriteExcel">permalink</a></div>
  <a href="http://search.cpan.org/%7Ejmcnamara/">John McNamara</a> &gt;
  <a href="http://search.cpan.org/%7Ejmcnamara/Spreadsheet-WriteExcel-2.38/">Spreadsheet-WriteExcel-2.38</a> &gt;
  Spreadsheet::WriteExcel
 </div>

<div class="noprint" style="float:right;align:left;width:19ex">
<a href="http://hexten.net/cpan-faces/"><img src="WriteExcel.pm_files/b8c3b1025babebf20168dd90ea8f268c.jpeg" style="float: right;" height="80" width="80"></a>
<br style="clear:both">
<p style="text-align:right">Download:<br> <a href="http://search.cpan.org/CPAN/authors/id/J/JM/JMCNAMARA/Spreadsheet-WriteExcel-2.38.tar.gz">Spreadsheet-WriteExcel-2.38.tar.gz</a></p>
<p style="text-align:right"><a href="http://deps.cpantesters.org/?module=Spreadsheet%3A%3AWriteExcel;perl=latest">Dependencies</a></p>
<p style="text-align:right"><a href="http://www.annocpan.org/%7EJMCNAMARA/Spreadsheet-WriteExcel-2.38/lib/Spreadsheet/WriteExcel.pm">Annotate this POD
</a></p>
<div class="box" style="width:150px; float: right">
<h1 class="t5">Related Modules</h1>
<div style="margin:2px">
<a href="http://search.cpan.org/perldoc?Win32%3A%3AOLE">Win32::OLE</a><br>
<a href="http://search.cpan.org/perldoc?Excel%3A%3ATemplate">Excel::Template</a><br>
<a href="http://search.cpan.org/perldoc?Parse%3A%3ARecDescent">Parse::RecDescent</a><br>
<a href="http://search.cpan.org/perldoc?Data%3A%3ADumper">Data::Dumper</a><br>
<a href="http://search.cpan.org/perldoc?HTML%3A%3ATemplate">HTML::Template</a><br>
<a href="http://search.cpan.org/perldoc?Text%3A%3ACSV_XS">Text::CSV_XS</a><br>
<a href="http://search.cpan.org/perldoc?Text%3A%3ACSV">Text::CSV</a><br>
<a href="http://search.cpan.org/perldoc?Win32%3A%3AODBC">Win32::ODBC</a><br>
<a href="http://search.cpan.org/perldoc?XML%3A%3ASimple">XML::Simple</a><br>
<a href="http://search.cpan.org/perldoc?Text%3A%3AxSV">Text::xSV</a><br>
<small>
<a href="http://perlmonks.org/?node=cpan+module+search&amp;pivot=1&amp;module=Spreadsheet%3A%3AWriteExcel">more...</a><br>
By <a href="http://perlmonks.org/">perlmonks.org</a></small>
</div>
</div>

<div style="float:right">
<div class="box" style="width:150px">
<h1 class="t5">CPAN RT</h1>
<div style="margin:2px">
<table style="margin-left: auto; margin-right: auto;">
<tbody><tr><td>Open&nbsp;</td><td style="text-align: right;"> 0</td></tr>
</tbody></table>
<a href="https://rt.cpan.org/Public/Dist/Display.html?Name=Spreadsheet-WriteExcel">View/Report Bugs</a><br>
</div>
</div>

</div>
</div>
  Module Version:  2.38 &nbsp;
<span class="noprint">
  <a href="http://search.cpan.org/src/JMCNAMARA/Spreadsheet-WriteExcel-2.38/lib/Spreadsheet/WriteExcel.pm">Source</a> &nbsp;
</span>
<a name="___top"></a>
<div class="pod">
<div class="toc">
<div class="indexgroup">
<ul class="indexList indexList1">
  <li class="indexItem indexItem1"><a href="#NAME">NAME</a>
  </li><li class="indexItem indexItem1"><a href="#VERSION">VERSION</a>
  </li><li class="indexItem indexItem1"><a href="#SYNOPSIS">SYNOPSIS</a>
  </li><li class="indexItem indexItem1"><a href="#DESCRIPTION">DESCRIPTION</a>
  </li><li class="indexItem indexItem1"><a href="#QUICK_START">QUICK START</a>
  </li><li class="indexItem indexItem1"><a href="#WORKBOOK_METHODS">WORKBOOK METHODS</a>
  <ul class="indexList indexList2">
    <li class="indexItem indexItem2"><a href="#new%28%29">new()</a>
    </li><li class="indexItem indexItem2"><a href="#add_worksheet%28$sheetname,_$utf_16_be%29">add_worksheet($sheetname, $utf_16_be)</a>
    </li><li class="indexItem indexItem2"><a href="#add_format%28%properties%29">add_format(%properties)</a>
    </li><li class="indexItem indexItem2"><a href="#add_chart%28%properties%29">add_chart(%properties)</a>
    </li><li class="indexItem indexItem2"><a href="#add_chart_ext%28$chart_data,_$chartname%29">add_chart_ext($chart_data, $chartname)</a>
    </li><li class="indexItem indexItem2"><a href="#close%28%29">close()</a>
    </li><li class="indexItem indexItem2"><a href="#compatibility_mode%28%29">compatibility_mode()</a>
    </li><li class="indexItem indexItem2"><a href="#set_properties%28%29">set_properties()</a>
    </li><li class="indexItem indexItem2"><a href="#define_name%28%29">define_name()</a>
    </li><li class="indexItem indexItem2"><a href="#set_tempdir%28%29">set_tempdir()</a>
    </li><li class="indexItem indexItem2"><a href="#set_custom_color%28$index,_$red,_$green,_$blue%29">set_custom_color($index, $red, $green, $blue)</a>
    </li><li class="indexItem indexItem2"><a href="#sheets%280,_1,_...%29">sheets(0, 1, ...)</a>
    </li><li class="indexItem indexItem2"><a href="#set_1904%28%29">set_1904()</a>
    </li><li class="indexItem indexItem2"><a href="#set_codepage%28$codepage%29">set_codepage($codepage)</a>
  </li></ul>
  </li><li class="indexItem indexItem1"><a href="#WORKSHEET_METHODS">WORKSHEET METHODS</a>
  <ul class="indexList indexList2">
    <li class="indexItem indexItem2"><a href="#Cell_notation">Cell notation</a>
    </li><li class="indexItem indexItem2"><a href="#write%28$row,_$column,_$token,_$format%29">write($row, $column, $token, $format)</a>
    </li><li class="indexItem indexItem2"><a href="#write_number%28$row,_$column,_$number,_$format%29">write_number($row, $column, $number, $format)</a>
    </li><li class="indexItem indexItem2"><a href="#write_string%28$row,_$column,_$string,_$format%29">write_string($row, $column, $string, $format)</a>
    </li><li class="indexItem indexItem2"><a href="#write_utf16be_string%28$row,_$column,_$string,_$format%29">write_utf16be_string($row, $column, $string, $format)</a>
    </li><li class="indexItem indexItem2"><a href="#write_utf16le_string%28$row,_$column,_$string,_$format%29">write_utf16le_string($row, $column, $string, $format)</a>
    </li><li class="indexItem indexItem2"><a href="#keep_leading_zeros%28%29">keep_leading_zeros()</a>
    </li><li class="indexItem indexItem2"><a href="#write_blank%28$row,_$column,_$format%29">write_blank($row, $column, $format)</a>
    </li><li class="indexItem indexItem2"><a href="#write_row%28$row,_$column,_$array_ref,_$format%29">write_row($row, $column, $array_ref, $format)</a>
    </li><li class="indexItem indexItem2"><a href="#write_col%28$row,_$column,_$array_ref,_$format%29">write_col($row, $column, $array_ref, $format)</a>
    </li><li class="indexItem indexItem2"><a href="#write_date_time%28$row,_$col,_$date_string,_$format%29">write_date_time($row, $col, $date_string, $format)</a>
    </li><li class="indexItem indexItem2"><a href="#write_url%28$row,_$col,_$url,_$label,_$format%29">write_url($row, $col, $url, $label, $format)</a>
    </li><li class="indexItem indexItem2"><a href="#write_url_range%28$row1,_$col1,_$row2,_$col2,_$url,_$string,_$format%29">write_url_range($row1, $col1, $row2, $col2, $url, $string, $format)</a>
    </li><li class="indexItem indexItem2"><a href="#write_formula%28$row,_$column,_$formula,_$format,_$value%29">write_formula($row, $column, $formula, $format, $value)</a>
    </li><li class="indexItem indexItem2"><a href="#store_formula%28$formula%29">store_formula($formula)</a>
    </li><li class="indexItem indexItem2"><a href="#repeat_formula%28$row,_$col,_$formula,_$format,_%28$pattern_=%3E_$replace,_...%29%29">repeat_formula($row, $col, $formula, $format, ($pattern =&gt; $replace, ...))</a>
    </li><li class="indexItem indexItem2"><a href="#write_comment%28$row,_$column,_$string,_...%29">write_comment($row, $column, $string, ...)</a>
    </li><li class="indexItem indexItem2"><a href="#show_comments%28%29">show_comments()</a>
    </li><li class="indexItem indexItem2"><a href="#add_write_handler%28$re,_$code_ref%29">add_write_handler($re, $code_ref)</a>
    </li><li class="indexItem indexItem2"><a href="#insert_image%28$row,_$col,_$filename,_$x,_$y,_$scale_x,_$scale_y%29">insert_image($row, $col, $filename, $x, $y, $scale_x, $scale_y)</a>
    </li><li class="indexItem indexItem2"><a href="#insert_chart%28$row,_$col,_$chart,_$x,_$y,_$scale_x,_$scale_y%29">insert_chart($row, $col, $chart, $x, $y, $scale_x, $scale_y)</a>
    </li><li class="indexItem indexItem2"><a href="#embed_chart%28$row,_$col,_$filename,_$x,_$y,_$scale_x,_$scale_y%29">embed_chart($row, $col, $filename, $x, $y, $scale_x, $scale_y)</a>
    </li><li class="indexItem indexItem2"><a href="#data_validation%28%29">data_validation()</a>
    </li><li class="indexItem indexItem2"><a href="#get_name%28%29">get_name()</a>
    </li><li class="indexItem indexItem2"><a href="#activate%28%29">activate()</a>
    </li><li class="indexItem indexItem2"><a href="#select%28%29">select()</a>
    </li><li class="indexItem indexItem2"><a href="#hide%28%29">hide()</a>
    </li><li class="indexItem indexItem2"><a href="#set_first_sheet%28%29">set_first_sheet()</a>
    </li><li class="indexItem indexItem2"><a href="#protect%28$password%29">protect($password)</a>
    </li><li class="indexItem indexItem2"><a href="#set_selection%28$first_row,_$first_col,_$last_row,_$last_col%29">set_selection($first_row, $first_col, $last_row, $last_col)</a>
    </li><li class="indexItem indexItem2"><a href="#set_row%28$row,_$height,_$format,_$hidden,_$level,_$collapsed%29">set_row($row, $height, $format, $hidden, $level, $collapsed)</a>
    </li><li class="indexItem indexItem2"><a href="#set_column%28$first_col,_$last_col,_$width,_$format,_$hidden,_$level,_$collapsed%29">set_column($first_col, $last_col, $width, $format, $hidden, $level, $collapsed)</a>
    </li><li class="indexItem indexItem2"><a href="#outline_settings%28$visible,_$symbols_below,_$symbols_right,_$auto_style%29">outline_settings($visible, $symbols_below, $symbols_right, $auto_style)</a>
    </li><li class="indexItem indexItem2"><a href="#freeze_panes%28$row,_$col,_$top_row,_$left_col%29">freeze_panes($row, $col, $top_row, $left_col)</a>
    </li><li class="indexItem indexItem2"><a href="#split_panes%28$y,_$x,_$top_row,_$left_col%29">split_panes($y, $x, $top_row, $left_col)</a>
    </li><li class="indexItem indexItem2"><a href="#merge_range%28$first_row,_$first_col,_$last_row,_$last_col,_$token,_$format,_$utf_16_be%29">merge_range($first_row, $first_col, $last_row, $last_col, $token, $format, $utf_16_be)</a>
    </li><li class="indexItem indexItem2"><a href="#set_zoom%28$scale%29">set_zoom($scale)</a>
    </li><li class="indexItem indexItem2"><a href="#right_to_left%28%29">right_to_left()</a>
    </li><li class="indexItem indexItem2"><a href="#hide_zero%28%29">hide_zero()</a>
    </li><li class="indexItem indexItem2"><a href="#set_tab_color%28%29">set_tab_color()</a>
    </li><li class="indexItem indexItem2"><a href="#autofilter%28$first_row,_$first_col,_$last_row,_$last_col%29">autofilter($first_row, $first_col, $last_row, $last_col)</a>
    </li><li class="indexItem indexItem2"><a href="#filter_column%28$column,_$expression%29">filter_column($column, $expression)</a>
  </li></ul>
  </li><li class="indexItem indexItem1"><a href="#PAGE_SET-UP_METHODS">PAGE SET-UP METHODS</a>
  <ul class="indexList indexList2">
    <li class="indexItem indexItem2"><a href="#set_landscape%28%29">set_landscape()</a>
    </li><li class="indexItem indexItem2"><a href="#set_portrait%28%29">set_portrait()</a>
    </li><li class="indexItem indexItem2"><a href="#set_page_view%28%29">set_page_view()</a>
    </li><li class="indexItem indexItem2"><a href="#set_paper%28$index%29">set_paper($index)</a>
    </li><li class="indexItem indexItem2"><a href="#center_horizontally%28%29">center_horizontally()</a>
    </li><li class="indexItem indexItem2"><a href="#center_vertically%28%29">center_vertically()</a>
    </li><li class="indexItem indexItem2"><a href="#set_margins%28$inches%29">set_margins($inches)</a>
    </li><li class="indexItem indexItem2"><a href="#set_header%28$string,_$margin%29">set_header($string, $margin)</a>
    </li><li class="indexItem indexItem2"><a href="#set_footer%28%29">set_footer()</a>
    </li><li class="indexItem indexItem2"><a href="#repeat_rows%28$first_row,_$last_row%29">repeat_rows($first_row, $last_row)</a>
    </li><li class="indexItem indexItem2"><a href="#repeat_columns%28$first_col,_$last_col%29">repeat_columns($first_col, $last_col)</a>
    </li><li class="indexItem indexItem2"><a href="#hide_gridlines%28$option%29">hide_gridlines($option)</a>
    </li><li class="indexItem indexItem2"><a href="#print_row_col_headers%28%29">print_row_col_headers()</a>
    </li><li class="indexItem indexItem2"><a href="#print_area%28$first_row,_$first_col,_$last_row,_$last_col%29">print_area($first_row, $first_col, $last_row, $last_col)</a>
    </li><li class="indexItem indexItem2"><a href="#print_across%28%29">print_across()</a>
    </li><li class="indexItem indexItem2"><a href="#fit_to_pages%28$width,_$height%29">fit_to_pages($width, $height)</a>
    </li><li class="indexItem indexItem2"><a href="#set_start_page%28$start_page%29">set_start_page($start_page)</a>
    </li><li class="indexItem indexItem2"><a href="#set_print_scale%28$scale%29">set_print_scale($scale)</a>
    </li><li class="indexItem indexItem2"><a href="#set_h_pagebreaks%28@breaks%29">set_h_pagebreaks(@breaks)</a>
    </li><li class="indexItem indexItem2"><a href="#set_v_pagebreaks%28@breaks%29">set_v_pagebreaks(@breaks)</a>
  </li></ul>
  </li><li class="indexItem indexItem1"><a href="#CELL_FORMATTING">CELL FORMATTING</a>
  <ul class="indexList indexList2">
    <li class="indexItem indexItem2"><a href="#Creating_and_using_a_Format_object">Creating and using a Format object</a>
    </li><li class="indexItem indexItem2"><a href="#Format_methods_and_Format_properties">Format methods and Format properties</a>
    </li><li class="indexItem indexItem2"><a href="#Working_with_formats">Working with formats</a>
  </li></ul>
  </li><li class="indexItem indexItem1"><a href="#FORMAT_METHODS">FORMAT METHODS</a>
  <ul class="indexList indexList2">
    <li class="indexItem indexItem2"><a href="#set_format_properties%28%properties%29">set_format_properties(%properties)</a>
    </li><li class="indexItem indexItem2"><a href="#set_font%28$fontname%29">set_font($fontname)</a>
    </li><li class="indexItem indexItem2"><a href="#set_size%28%29">set_size()</a>
    </li><li class="indexItem indexItem2"><a href="#set_color%28%29">set_color()</a>
    </li><li class="indexItem indexItem2"><a href="#set_bold%28%29">set_bold()</a>
    </li><li class="indexItem indexItem2"><a href="#set_italic%28%29">set_italic()</a>
    </li><li class="indexItem indexItem2"><a href="#set_underline%28%29">set_underline()</a>
    </li><li class="indexItem indexItem2"><a href="#set_font_strikeout%28%29">set_font_strikeout()</a>
    </li><li class="indexItem indexItem2"><a href="#set_font_script%28%29">set_font_script()</a>
    </li><li class="indexItem indexItem2"><a href="#set_font_outline%28%29">set_font_outline()</a>
    </li><li class="indexItem indexItem2"><a href="#set_font_shadow%28%29">set_font_shadow()</a>
    </li><li class="indexItem indexItem2"><a href="#set_num_format%28%29">set_num_format()</a>
    </li><li class="indexItem indexItem2"><a href="#set_locked%28%29">set_locked()</a>
    </li><li class="indexItem indexItem2"><a href="#set_hidden%28%29">set_hidden()</a>
    </li><li class="indexItem indexItem2"><a href="#set_align%28%29">set_align()</a>
    </li><li class="indexItem indexItem2"><a href="#set_center_across%28%29">set_center_across()</a>
    </li><li class="indexItem indexItem2"><a href="#set_text_wrap%28%29">set_text_wrap()</a>
    </li><li class="indexItem indexItem2"><a href="#set_rotation%28%29">set_rotation()</a>
    </li><li class="indexItem indexItem2"><a href="#set_indent%28%29">set_indent()</a>
    </li><li class="indexItem indexItem2"><a href="#set_shrink%28%29">set_shrink()</a>
    </li><li class="indexItem indexItem2"><a href="#set_text_justlast%28%29">set_text_justlast()</a>
    </li><li class="indexItem indexItem2"><a href="#set_pattern%28%29">set_pattern()</a>
    </li><li class="indexItem indexItem2"><a href="#set_bg_color%28%29">set_bg_color()</a>
    </li><li class="indexItem indexItem2"><a href="#set_fg_color%28%29">set_fg_color()</a>
    </li><li class="indexItem indexItem2"><a href="#set_border%28%29">set_border()</a>
    </li><li class="indexItem indexItem2"><a href="#set_border_color%28%29">set_border_color()</a>
    </li><li class="indexItem indexItem2"><a href="#copy%28$format%29">copy($format)</a>
  </li></ul>
  </li><li class="indexItem indexItem1"><a href="#UNICODE_IN_EXCEL">UNICODE IN EXCEL</a>
  </li><li class="indexItem indexItem1"><a href="#COLOURS_IN_EXCEL">COLOURS IN EXCEL</a>
  </li><li class="indexItem indexItem1"><a href="#DATES_AND_TIME_IN_EXCEL">DATES AND TIME IN EXCEL</a>
  <ul class="indexList indexList2">
    <li class="indexItem indexItem2"><a href="#An_Excel_date/time_is_a_number_plus_a_format">An Excel date/time is a number plus a format</a>
    </li><li class="indexItem indexItem2"><a href="#Spreadsheet::WriteExcel_doesn%27t_automatically_convert_date/time_strings">Spreadsheet::WriteExcel doesn't automatically convert date/time strings</a>
    </li><li class="indexItem indexItem2"><a href="#Converting_dates_and_times_to_an_Excel_date_or_time">Converting dates and times to an Excel date or time</a>
  </li></ul>
  </li><li class="indexItem indexItem1"><a href="#OUTLINES_AND_GROUPING_IN_EXCEL">OUTLINES AND GROUPING IN EXCEL</a>
  </li><li class="indexItem indexItem1"><a href="#DATA_VALIDATION_IN_EXCEL">DATA VALIDATION IN EXCEL</a>
  <ul class="indexList indexList2">
    <li class="indexItem indexItem2"><a href="#data_validation%28$row,_$col,_%7B_parameter_=%3E_%27value%27,_..._%7D%29">data_validation($row, $col, { parameter =&gt; 'value', ... })</a>
    </li><li class="indexItem indexItem2"><a href="#validate">validate</a>
    </li><li class="indexItem indexItem2"><a href="#criteria">criteria</a>
    </li><li class="indexItem indexItem2"><a href="#value_%7C_minimum_%7C_source">value | minimum | source</a>
    </li><li class="indexItem indexItem2"><a href="#maximum">maximum</a>
    </li><li class="indexItem indexItem2"><a href="#ignore_blank">ignore_blank</a>
    </li><li class="indexItem indexItem2"><a href="#dropdown">dropdown</a>
    </li><li class="indexItem indexItem2"><a href="#input_title">input_title</a>
    </li><li class="indexItem indexItem2"><a href="#input_message">input_message</a>
    </li><li class="indexItem indexItem2"><a href="#show_input">show_input</a>
    </li><li class="indexItem indexItem2"><a href="#error_title">error_title</a>
    </li><li class="indexItem indexItem2"><a href="#error_message">error_message</a>
    </li><li class="indexItem indexItem2"><a href="#error_type">error_type</a>
    </li><li class="indexItem indexItem2"><a href="#show_error">show_error</a>
    </li><li class="indexItem indexItem2"><a href="#Data_Validation_Examples">Data Validation Examples</a>
  </li></ul>
  </li><li class="indexItem indexItem1"><a href="#ROW_HEIGHTS_AND_WORKSHEET_OBJECTS">ROW HEIGHTS AND WORKSHEET OBJECTS</a>
  </li><li class="indexItem indexItem1"><a href="#FORMULAS_AND_FUNCTIONS_IN_EXCEL">FORMULAS AND FUNCTIONS IN EXCEL</a>
  <ul class="indexList indexList2">
    <li class="indexItem indexItem2"><a href="#Caveats">Caveats</a>
    </li><li class="indexItem indexItem2"><a href="#Introduction">Introduction</a>
    </li><li class="indexItem indexItem2"><a href="#Improving_performance_when_working_with_formulas">Improving performance when working with formulas</a>
  </li></ul>
  </li><li class="indexItem indexItem1"><a href="#EXAMPLES">EXAMPLES</a>
  <ul class="indexList indexList2">
    <li class="indexItem indexItem2"><a href="#Example_1">Example 1</a>
    </li><li class="indexItem indexItem2"><a href="#Example_2">Example 2</a>
    </li><li class="indexItem indexItem2"><a href="#Example_3">Example 3</a>
    </li><li class="indexItem indexItem2"><a href="#Example_4">Example 4</a>
    </li><li class="indexItem indexItem2"><a href="#Example_5">Example 5</a>
    </li><li class="indexItem indexItem2"><a href="#Additional_Examples">Additional Examples</a>
  </li></ul>
  </li><li class="indexItem indexItem1"><a href="#LIMITATIONS">LIMITATIONS</a>
  </li><li class="indexItem indexItem1"><a href="#DOWNLOADING">DOWNLOADING</a>
  </li><li class="indexItem indexItem1"><a href="#REQUIREMENTS">REQUIREMENTS</a>
  </li><li class="indexItem indexItem1"><a href="#INSTALLATION">INSTALLATION</a>
  </li><li class="indexItem indexItem1"><a href="#PORTABILITY">PORTABILITY</a>
  </li><li class="indexItem indexItem1"><a href="#DIAGNOSTICS">DIAGNOSTICS</a>
  </li><li class="indexItem indexItem1"><a href="#THE_EXCEL_BINARY_FORMAT">THE EXCEL BINARY FORMAT</a>
  </li><li class="indexItem indexItem1"><a href="#WRITING_EXCEL_FILES">WRITING EXCEL FILES</a>
  </li><li class="indexItem indexItem1"><a href="#READING_EXCEL_FILES">READING EXCEL FILES</a>
  </li><li class="indexItem indexItem1"><a href="#MODIFYING_AND_REWRITING_EXCEL_FILES">MODIFYING AND REWRITING EXCEL FILES</a>
  </li><li class="indexItem indexItem1"><a href="#Warning_about_XML::Parser_and_perl_5.6">Warning about XML::Parser and perl 5.6</a>
  </li><li class="indexItem indexItem1"><a href="#Warning_about_Office_Service_Pack_3">Warning about Office Service Pack 3</a>
  </li><li class="indexItem indexItem1"><a href="#BUGS">BUGS</a>
  </li><li class="indexItem indexItem1"><a href="#TO_DO">TO DO</a>
  </li><li class="indexItem indexItem1"><a href="#REPOSITORY">REPOSITORY</a>
  </li><li class="indexItem indexItem1"><a href="#MAILING_LIST">MAILING LIST</a>
  </li><li class="indexItem indexItem1"><a href="#DONATIONS">DONATIONS</a>
  </li><li class="indexItem indexItem1"><a href="#SEE_ALSO">SEE ALSO</a>
  </li><li class="indexItem indexItem1"><a href="#ACKNOWLEDGMENTS">ACKNOWLEDGMENTS</a>
  </li><li class="indexItem indexItem1"><a href="#DISCLAIMER_OF_WARRANTY">DISCLAIMER OF WARRANTY</a>
  </li><li class="indexItem indexItem1"><a href="#LICENSE">LICENSE</a>
  </li><li class="indexItem indexItem1"><a href="#AUTHOR">AUTHOR</a>
  </li><li class="indexItem indexItem1"><a href="#COPYRIGHT">COPYRIGHT</a>
</li></ul>
</div>
</div>

<h1><a class="u" href="#___top" title="click to go to top of document" name="NAME">NAME <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Spreadsheet::WriteExcel - Write to a cross-platform Excel binary file.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="VERSION">VERSION <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>This document refers to version 2.38 of Spreadsheet::WriteExcel,
released November 22,
2012.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="SYNOPSIS">SYNOPSIS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>To write a string,
a formatted string,
a number and a formula to the first worksheet in an Excel workbook called perl.xls:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>

    <span class="sh_comment"># Create a new Excel workbook</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span> <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'perl.xls'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Add a worksheet</span>
    <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>

    <span class="sh_comment">#  Add and define a format</span>
    <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span> <span class="sh_comment"># Add a format</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_color</span><span class="sh_symbol">(</span><span class="sh_string">'red'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_align</span><span class="sh_symbol">(</span><span class="sh_string">'center'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Write a formatted and unformatted string, row and column notation.</span>
    <span class="sh_variable">$col</span> <span class="sh_symbol">=</span> <span class="sh_variable">$row</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_variable">$row</span><span class="sh_symbol">,</span> <span class="sh_variable">$col</span><span class="sh_symbol">,</span> <span class="sh_string">'Hi Excel!'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span>    <span class="sh_variable">$col</span><span class="sh_symbol">,</span> <span class="sh_string">'Hi Excel!'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Write a number and a formula using A1 notation</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A3'</span><span class="sh_symbol">,</span> <span class="sh_number">1.2345</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A4'</span><span class="sh_symbol">,</span> <span class="sh_string">'=SIN(PI()/4)'</span><span class="sh_symbol">);</span></pre>

<h1><a class="u" href="#___top" title="click to go to top of document" name="DESCRIPTION">DESCRIPTION <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>The Spreadsheet::WriteExcel Perl module can be used to create a 
cross-platform Excel binary file. Multiple worksheets can be added to a 
workbook and formatting can be applied to cells. Text, numbers, 
formulas, hyperlinks, images and charts can be written to the cells.</p>

<p>The file produced by this module is compatible with Excel 97, 2000, 2002, 2003 and 2007.</p>

<p>The module will work on the majority of Windows, UNIX and Mac 
platforms. Generated files are also compatible with the Linux/UNIX 
spreadsheet applications Gnumeric and OpenOffice.org.</p>

<p>This module cannot be used to write to an existing Excel file (See <a href="#MODIFYING_AND_REWRITING_EXCEL_FILES" class="podlinkpod">"MODIFYING AND REWRITING EXCEL FILES"</a>).</p>

<p>For the Excel 2007+ xlsx file format see the <a href="http://search.cpan.org/perldoc?Excel%3A%3AWriter%3A%3AXLSX" class="podlinkpod">Excel::Writer::XLSX</a> module.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="QUICK_START">QUICK START <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Spreadsheet::WriteExcel tries to provide an interface to as many of 
Excel's features as possible. As a result there is a lot of 
documentation to accompany the interface and it can be difficult at 
first glance to see what it important and what is not. So for those of 
you who prefer to assemble Ikea furniture first and then read the 
instructions, here are three easy steps:</p>

<p>1. Create a new Excel <i>workbook</i> (i.e. file) using <code>new()</code>.</p>

<p>2. Add a <i>worksheet</i> to the new workbook using <code>add_worksheet()</code>.</p>

<p>3. Write to the worksheet using <code>write()</code>.</p>

<p>Like this:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>                             <span class="sh_comment"># Step 0</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span> <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'perl.xls'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Step 1</span>
    <span class="sh_variable">$worksheet</span>   <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>               <span class="sh_comment"># Step 2</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hi Excel!'</span><span class="sh_symbol">);</span>                    <span class="sh_comment"># Step 3</span></pre>

<p>This will create an Excel file called <code>perl.xls</code> with a single worksheet and the text <code>'Hi Excel!'</code> in the relevant cell. And that's it. Okay, so there is actually a zeroth step as well, but <code>use module</code>
 goes without saying. There are also more than 80 examples that come 
with the distribution and which you can use to get you started. See <a href="#EXAMPLES" class="podlinkpod">"EXAMPLES"</a>.</p>

<p>Those of you who read the instructions first and assemble the furniture afterwards will know how to proceed. ;-)</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="WORKBOOK_METHODS">WORKBOOK METHODS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>The Spreadsheet::WriteExcel module provides an object oriented 
interface to a new Excel workbook. The following methods are available 
through a new workbook.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_function">new</span><span class="sh_symbol">()</span>
    <span class="sh_function">add_worksheet</span><span class="sh_symbol">()</span>
    <span class="sh_function">add_format</span><span class="sh_symbol">()</span>
    <span class="sh_function">add_chart</span><span class="sh_symbol">()</span>
    <span class="sh_function">add_chart_ext</span><span class="sh_symbol">()</span>
    <span class="sh_keyword">close</span><span class="sh_symbol">()</span>
    <span class="sh_function">compatibility_mode</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_properties</span><span class="sh_symbol">()</span>
    <span class="sh_function">define_name</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_tempdir</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_custom_color</span><span class="sh_symbol">()</span>
    <span class="sh_function">sheets</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_1904</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_codepage</span><span class="sh_symbol">()</span></pre>

<p>If you are unfamiliar with object oriented interfaces or the way that they are implemented in Perl have a look at <code>perlobj</code> and <code>perltoot</code> in the main Perl documentation.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="new()">new()</a></h2>

<p>A new Excel workbook is created using the <code>new()</code> 
constructor which accepts either a filename or a filehandle as a 
parameter. The following example creates a new Excel file based on a 
filename:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'filename.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Hi Excel!'</span><span class="sh_symbol">);</span></pre>

<p>Here are some other examples of using <code>new()</code> with filenames:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook1</span> <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_variable">$filename</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook2</span> <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'/tmp/filename.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook3</span> <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">"c:\\tmp\\filename.xls"</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook4</span> <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'c:\tmp\filename.xls'</span><span class="sh_symbol">);</span></pre>

<p>The last two examples demonstrates how to create a file on DOS or 
Windows where it is necessary to either escape the directory separator <code>\</code> or to use single quotes to ensure that it isn't interpolated. For more information see <code>perlfaq5: Why can't I use "C:\temp\foo" in DOS paths?</code>.</p>

<p>The <code>new()</code> constructor returns a Spreadsheet::WriteExcel 
object that you can use to add worksheets and store data. It should be 
noted that although <code>my</code> is not specifically required it 
defines the scope of the new workbook variable and, in the majority of 
cases, ensures that the workbook is closed properly without explicitly 
calling the <code>close()</code> method.</p>

<p>If the file cannot be created, due to file permissions or some other reason, <code>new</code> will return <code>undef</code>. Therefore, it is good practice to check the return value of <code>new</code> before proceeding. As usual the Perl variable <code>$!</code> will be set if there is a file creation error. You will also see one of the warning messages detailed in <a href="#DIAGNOSTICS" class="podlinkpod">"DIAGNOSTICS"</a>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'protected.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">die</span> <span class="sh_string">"Problems creating new Excel file: $!"</span> <span class="sh_keyword">unless</span> <span class="sh_keyword">defined</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">;</span></pre>

<p>You can also pass a valid filehandle to the <code>new()</code> constructor. For example in a CGI program you could do something like this:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">binmode</span><span class="sh_symbol">(</span>STDOUT<span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(\*</span>STDOUT<span class="sh_symbol">);</span></pre>

<p>The requirement for <code>binmode()</code> is explained below.</p>

<p>See also, the <code>cgi.pl</code> program in the <code>examples</code> directory of the distro.</p>

<p>However, this special case will not work in <code>mod_perl</code> programs where you will have to do something like the following:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># mod_perl 1</span>
    <span class="sh_symbol">...</span>
    <span class="sh_keyword">tie</span> <span class="sh_symbol">*</span>XLS<span class="sh_symbol">,</span> <span class="sh_string">'Apache'</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">binmode</span><span class="sh_symbol">(</span>XLS<span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(\*</span>XLS<span class="sh_symbol">);</span>
    <span class="sh_symbol">...</span>

    <span class="sh_comment"># mod_perl 2</span>
    <span class="sh_symbol">...</span>
    <span class="sh_keyword">tie</span> <span class="sh_symbol">*</span>XLS <span class="sh_symbol">=&gt;</span> <span class="sh_variable">$r</span><span class="sh_symbol">;</span>  <span class="sh_comment"># Tie to the Apache::RequestRec object</span>
    <span class="sh_keyword">binmode</span><span class="sh_symbol">(*</span>XLS<span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(\*</span>XLS<span class="sh_symbol">);</span>
    <span class="sh_symbol">...</span></pre>

<p>See also, the <code>mod_perl1.pl</code> and <code>mod_perl2.pl</code> programs in the <code>examples</code> directory of the distro.</p>

<p>Filehandles can also be useful if you want to stream an Excel file 
over a socket or if you want to store an Excel file in a scalar.</p>

<p>For example here is a way to write an Excel file to a scalar with <code>perl 5.8</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment">#!/usr/bin/perl -w</span>

    <span class="sh_keyword">use</span> strict<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>

    <span class="sh_comment"># Requires perl 5.8 or later</span>
    <span class="sh_keyword">open</span> <span class="sh_keyword">my</span> <span class="sh_variable">$fh</span><span class="sh_symbol">,</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span> <span class="sh_symbol">\</span><span class="sh_keyword">my</span> <span class="sh_variable">$str</span> or <span class="sh_keyword">die</span> <span class="sh_string">"Failed to open filehandle: $!"</span><span class="sh_symbol">;</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_variable">$fh</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_string">'Hi Excel!'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">close</span><span class="sh_symbol">();</span>

    <span class="sh_comment"># The Excel file in now in $str. Remember to binmode() the output</span>
    <span class="sh_comment"># filehandle before printing it.</span>
    <span class="sh_keyword">binmode</span> STDOUT<span class="sh_symbol">;</span>
    <span class="sh_keyword">print</span> <span class="sh_variable">$str</span><span class="sh_symbol">;</span></pre>

<p>See also the <code>write_to_scalar.pl</code> and <code>filehandle.pl</code> programs in the <code>examples</code> directory of the distro.</p>

<p><b>Note about the requirement for</b> <code>binmode()</code>. An Excel file is comprised of binary data. Therefore, if you are using a filehandle you should ensure that you <code>binmode()</code> it prior to passing it to <code>new()</code>.You
 should do this regardless of whether you are on a Windows platform or 
not. This applies especially to users of perl 5.8 on systems where <code>UTF-8</code> is likely to be in operation such as RedHat Linux 9. If your program, either intentionally or not, writes <code>UTF-8</code> data to a filehandle that is passed to <code>new()</code> it will corrupt the Excel file that is created.</p>

<p>You don't have to worry about <code>binmode()</code> if you are using filenames instead of filehandles. Spreadsheet::WriteExcel performs the <code>binmode()</code> internally when it converts the filename to a filehandle. For more information about <code>binmode()</code> see <code>perlfunc</code> and <code>perlopentut</code> in the main Perl documentation.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="add_worksheet($sheetname,_$utf_16_be)">add_worksheet($sheetname, $utf_16_be)</a></h2>

<p>At least one worksheet should be added to a new workbook. A worksheet is used to write data into cells:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>           <span class="sh_comment"># Sheet1</span>
    <span class="sh_variable">$worksheet2</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_string">'Foglio2'</span><span class="sh_symbol">);</span>  <span class="sh_comment"># Foglio2</span>
    <span class="sh_variable">$worksheet3</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_string">'Data'</span><span class="sh_symbol">);</span>     <span class="sh_comment"># Data</span>
    <span class="sh_variable">$worksheet4</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>           <span class="sh_comment"># Sheet4</span></pre>

<p>If <code>$sheetname</code> is not specified the default Excel convention will be followed, i.e. Sheet1, Sheet2, etc. The <code>$utf_16_be</code> parameter is optional, see below.</p>

<p>The worksheet name must be a valid Excel worksheet name, i.e. it cannot contain any of the following characters, <code>[ ] : * ? / \</code> and it must be less than 32 characters. In addition, you cannot use the same, case insensitive, <code>$sheetname</code> for more than one worksheet.</p>

<p>On systems with <code>perl 5.8</code> and later the <code>add_worksheet()</code> method will also handle strings in <code>UTF-8</code> format.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_string">"\x{263a}"</span><span class="sh_symbol">);</span> <span class="sh_comment"># Smiley</span></pre>

<p>On earlier Perl systems your can specify <code>UTF-16BE</code> worksheet names using an additional optional parameter:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$name</span> <span class="sh_symbol">=</span> <span class="sh_keyword">pack</span> <span class="sh_string">'n'</span><span class="sh_symbol">,</span> <span class="sh_number">0x263a</span><span class="sh_symbol">;</span>
    <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_variable">$name</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>   <span class="sh_comment"># Smiley</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="add_format(%properties)">add_format(%properties)</a></h2>

<p>The <code>add_format()</code> method can be used to create new Format
 objects which are used to apply formatting to a cell. You can either 
define the properties at creation time via a hash of property values or 
later via method calls.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$format1</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span><span class="sh_variable">%props</span><span class="sh_symbol">);</span> <span class="sh_comment"># Set properties at creation</span>
    <span class="sh_variable">$format2</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>       <span class="sh_comment"># Set properties later</span></pre>

<p>See the <a href="#CELL_FORMATTING" class="podlinkpod">"CELL FORMATTING"</a> section for more details about Format properties and how to set them.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="add_chart(%properties)">add_chart(%properties)</a></h2>

<p>This method is use to create a new chart either as a standalone 
worksheet (the default) or as an embeddable object that can be inserted 
into a worksheet via the <code>insert_chart()</code> Worksheet method.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$chart</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_chart</span><span class="sh_symbol">(</span> type <span class="sh_symbol">=&gt;</span> <span class="sh_string">'column'</span> <span class="sh_symbol">);</span></pre>

<p>The properties that can be set are:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_function">type</span>     <span class="sh_symbol">(</span>required<span class="sh_symbol">)</span>
    <span class="sh_function">name</span>     <span class="sh_symbol">(</span>optional<span class="sh_symbol">)</span>
    <span class="sh_function">embedded</span> <span class="sh_symbol">(</span>optional<span class="sh_symbol">)</span></pre>

<ul>
<li><code>type</code>
<p>This is a required parameter. It defines the type of chart that will be created.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$chart</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_chart</span><span class="sh_symbol">(</span> type <span class="sh_symbol">=&gt;</span> <span class="sh_string">'line'</span> <span class="sh_symbol">);</span></pre>

<p>The available types are:</p>

<pre class="sh_perl sh_sourceCode">    area
    bar
    column
    line
    pie
    scatter
    stock</pre>
</li>

<li><code>name</code>
<p>Set the name for the chart sheet. The name property is optional and if it isn't supplied will default to <code>Chart1 .. n</code>. The name must be a valid Excel worksheet name. See <code>add_worksheet()</code> for more details on valid sheet names. The <code>name</code> property can be omitted for embedded charts.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$chart</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_chart</span><span class="sh_symbol">(</span> type <span class="sh_symbol">=&gt;</span> <span class="sh_string">'line'</span><span class="sh_symbol">,</span> name <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Results Chart'</span> <span class="sh_symbol">);</span></pre>
</li>

<li><code>embedded</code>
<p>Specifies that the Chart object will be inserted in a worksheet via the <code>insert_chart()</code> Worksheet method. It is an error to try insert a Chart that doesn't have this flag set.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$chart</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_chart</span><span class="sh_symbol">(</span> type <span class="sh_symbol">=&gt;</span> <span class="sh_string">'line'</span><span class="sh_symbol">,</span> embedded <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span> <span class="sh_symbol">);</span>

    <span class="sh_comment"># Configure the chart.</span>
    <span class="sh_symbol">...</span>

    <span class="sh_comment"># Insert the chart into the a worksheet.</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">insert_chart</span><span class="sh_symbol">(</span> <span class="sh_string">'E2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$chart</span> <span class="sh_symbol">);</span></pre>
</li>
</ul>

<p>See <a href="http://search.cpan.org/%7Ejmcnamara/Spreadsheet-WriteExcel-2.38/lib/Spreadsheet/WriteExcel/Chart.pm" class="podlinkpod">Spreadsheet::WriteExcel::Chart</a> for details on how to configure the chart object once it is created. See also the <code>chart_*.pl</code> programs in the examples directory of the distro.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="add_chart_ext($chart_data,_$chartname)">add_chart_ext($chart_data, $chartname)</a></h2>

<p>This method is use to include externally generated charts in a Spreadsheet::WriteExcel file.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$chart</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_chart_ext</span><span class="sh_symbol">(</span><span class="sh_string">'chart01.bin'</span><span class="sh_symbol">,</span> <span class="sh_string">'Chart1'</span><span class="sh_symbol">);</span></pre>

<p>This feature is semi-deprecated in favour of the "native" charts created using <code>add_chart()</code>. Read <code>external_charts.txt</code> (or <code>.pod</code>) in the external_charts directory of the distro for a full explanation.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="close()">close()</a></h2>

<p>In general your Excel file will be closed automatically when your 
program ends or when the Workbook object goes out of scope, however the <code>close()</code> method can be used to explicitly close an Excel file.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">close</span><span class="sh_symbol">();</span></pre>

<p>An explicit <code>close()</code> is required if the file must be 
closed prior to performing some external action on it such as copying 
it, reading its size or attaching it to an email.</p>

<p>In addition, <code>close()</code> may be required to prevent perl's 
garbage collector from disposing of the Workbook, Worksheet and Format 
objects in the wrong order. Situations where this can occur are:</p>

<ul>
<li>If <code>my()</code> was not used to declare the scope of a workbook variable created using <code>new()</code>.</li>

<li>If the <code>new()</code>, <code>add_worksheet()</code> or <code>add_format()</code> methods are called in subroutines.</li>
</ul>

<p>The reason for this is that Spreadsheet::WriteExcel relies on Perl's <code>DESTROY</code>
 mechanism to trigger destructor methods in a specific sequence. This 
may not happen in cases where the Workbook, Worksheet and Format 
variables are not lexically scoped or where they have different lexical 
scopes.</p>

<p>In general, if you create a file with a size of 0 bytes or you fail to create a file you need to call <code>close()</code>.</p>

<p>The return value of <code>close()</code> is the same as that returned by perl when it closes the file created by <code>new()</code>. This allows you to handle error conditions in the usual way:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">close</span><span class="sh_symbol">()</span> or <span class="sh_keyword">die</span> <span class="sh_string">"Error closing file: $!"</span><span class="sh_symbol">;</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="compatibility_mode()">compatibility_mode()</a></h2>

<p>This method is used to improve compatibility with third party applications that read Excel files.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">compatibility_mode</span><span class="sh_symbol">();</span></pre>

<p>An Excel file is comprised of binary records that describe properties
 of a spreadsheet. Excel is reasonably liberal about this and, outside 
of a core subset, it doesn't require every possible record to be present
 when it reads a file. This is also true of Gnumeric and OpenOffice.Org 
Calc.</p>

<p>Spreadsheet::WriteExcel takes advantage of this fact to omit some 
records in order to minimise the amount of data stored in memory and to 
simplify and speed up the writing of files. However, some third party 
applications that read Excel files often expect certain records to be 
present. In "compatibility mode" Spreadsheet::WriteExcel writes these 
records and tries to be as close to an Excel generated file as possible.</p>

<p>Applications that require <code>compatibility_mode()</code> are Apache POI, Apple Numbers, and Quickoffice on Nokia, Palm and other devices. You should also use <code>compatibility_mode()</code> if your Excel file will be used as an external data source by another Excel file.</p>

<p>If you encounter other situations that require <code>compatibility_mode()</code>, please let me know.</p>

<p>It should be noted that <code>compatibility_mode()</code> requires 
additional data to be stored in memory and additional processing. This 
incurs a memory and speed penalty and may not be suitable for very large
 files (&gt;20MB).</p>

<p>You must call <code>compatibility_mode()</code> before calling <code>add_worksheet()</code>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_properties()">set_properties()</a></h2>

<p>The <code>set_properties</code> method can be used to set the document properties of the Excel file created by <code>Spreadsheet::WriteExcel</code>. These properties are visible when you use the <code>File-&gt;Properties</code> menu option in Excel and are also available to external applications that read or index windows files.</p>

<p>The properties should be passed as a hash of values as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_properties</span><span class="sh_symbol">(</span>
        title    <span class="sh_symbol">=&gt;</span> <span class="sh_string">'This is an example spreadsheet'</span><span class="sh_symbol">,</span>
        author   <span class="sh_symbol">=&gt;</span> <span class="sh_string">'John McNamara'</span><span class="sh_symbol">,</span>
        comments <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Created with Perl and Spreadsheet::WriteExcel'</span><span class="sh_symbol">,</span>
    <span class="sh_symbol">);</span></pre>

<p>The properties that can be set are:</p>

<pre class="sh_perl sh_sourceCode">    title
    subject
    author
    manager
    company
    category
    keywords
    comments</pre>

<p>User defined properties are not supported due to effort required.</p>

<p>In perl 5.8+ you can also pass UTF-8 strings as properties. See <a href="#UNICODE_IN_EXCEL" class="podlinkpod">"UNICODE IN EXCEL"</a>.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$smiley</span> <span class="sh_symbol">=</span> <span class="sh_keyword">chr</span> <span class="sh_number">0x263A</span><span class="sh_symbol">;</span>

    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_properties</span><span class="sh_symbol">(</span>
        subject <span class="sh_symbol">=&gt;</span> <span class="sh_string">"Happy now? $smiley"</span><span class="sh_symbol">,</span>
    <span class="sh_symbol">);</span></pre>

<p>With older versions of perl you can use a module to convert a 
non-ASCII string to a binary representation of UTF-8 and then pass an 
additional <code>utf8</code> flag to <code>set_properties()</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$smiley</span> <span class="sh_symbol">=</span> <span class="sh_keyword">pack</span> <span class="sh_string">'H*'</span><span class="sh_symbol">,</span> <span class="sh_string">'E298BA'</span><span class="sh_symbol">;</span>

    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_properties</span><span class="sh_symbol">(</span>
        subject <span class="sh_symbol">=&gt;</span> <span class="sh_string">"Happy now? $smiley"</span><span class="sh_symbol">,</span>
        utf8    <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
    <span class="sh_symbol">);</span></pre>

<p>Usually Spreadsheet::WriteExcel allows you to use UTF-16 with pre 5.8
 versions of perl. However, document properties don't support UTF-16 for
 these type of strings.</p>

<p>In order to promote the usefulness of Perl and the 
Spreadsheet::WriteExcel module consider adding a comment such as the 
following when using document properties:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_properties</span><span class="sh_symbol">(</span>
        <span class="sh_symbol">...,</span>
        comments <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Created with Perl and Spreadsheet::WriteExcel'</span><span class="sh_symbol">,</span>
        <span class="sh_symbol">...,</span>
    <span class="sh_symbol">);</span></pre>

<p>This feature requires that the <code>OLE::Storage_Lite</code> module 
is installed (which is usually the case for a standard 
Spreadsheet::WriteExcel installation). However, this also means that the
 resulting OLE document may <b>possibly</b> be buggy for files less than 7MB since it hasn't been as rigorously tested in that domain. As a result of this <code>set_properties</code>
 is currently incompatible with Gnumeric for files less than 7MB. This 
is being investigated. If you encounter any problems with this features 
let me know.</p>

<p>For convenience it is possible to pass either a hash or hash ref of arguments to this method.</p>

<p>See also the <code>properties.pl</code> program in the examples directory of the distro.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="define_name()">define_name()</a></h2>

<p>This method is used to defined a name that can be used to represent a value, a single cell or a range of cells in a workbook.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">define_name</span><span class="sh_symbol">(</span><span class="sh_string">'Exchange_rate'</span><span class="sh_symbol">,</span> <span class="sh_string">'=0.96'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">define_name</span><span class="sh_symbol">(</span><span class="sh_string">'Sales'</span><span class="sh_symbol">,</span>         <span class="sh_string">'=Sheet1!$G$1:$H$10'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">define_name</span><span class="sh_symbol">(</span><span class="sh_string">'Sheet2!Sales'</span><span class="sh_symbol">,</span>  <span class="sh_string">'=Sheet2!$G$1:$G$10'</span><span class="sh_symbol">);</span></pre>

<p>See the defined_name.pl program in the examples dir of the distro.</p>

<p>Note: This currently a beta feature. More documentation and examples will be added.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_tempdir()">set_tempdir()</a></h2>

<p>For speed and efficiency <code>Spreadsheet::WriteExcel</code> stores worksheet data in temporary files prior to assembling the final workbook.</p>

<p>If Spreadsheet::WriteExcel is unable to create these temporary files 
it will store the required data in memory. This can be slow for large 
files.</p>

<p>The problem occurs mainly with IIS on Windows although it could 
feasibly occur on Unix systems as well. The problem generally occurs 
because the default temp file directory is defined as <code>C:/</code> or some other directory that IIS doesn't provide write access to.</p>

<p>To check if this might be a problem on a particular system you can run a simple test program with <code>-w</code> or <code>use warnings</code>. This will generate a warning if the module cannot create the required temporary files:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment">#!/usr/bin/perl -w</span>

    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'test.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span></pre>

<p>To avoid this problem the <code>set_tempdir()</code> method can be used to specify a directory that is accessible for the creation of temporary files.</p>

<p>The <code>File::Temp</code> module is used to create the temporary files. File::Temp uses <code>File::Spec</code> to determine an appropriate location for these files such as <code>/tmp</code> or <code>c:\windows\temp</code>. You can find out which directory is used on your system as follows:</p>

<pre class="sh_perl sh_sourceCode">    perl <span class="sh_symbol">-</span>MFile<span class="sh_symbol">::</span>Spec <span class="sh_symbol">-</span>le <span class="sh_string">"print File::Spec-&gt;tmpdir"</span></pre>

<p>Even if the default temporary file directory is accessible you may 
wish to specify an alternative location for security or maintenance 
reasons:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_tempdir</span><span class="sh_symbol">(</span><span class="sh_string">'/tmp/writeexcel'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_tempdir</span><span class="sh_symbol">(</span><span class="sh_string">'c:\windows\temp\writeexcel'</span><span class="sh_symbol">);</span></pre>

<p>The directory for the temporary file must exist, <code>set_tempdir()</code> will not create a new directory.</p>

<p>One disadvantage of using the <code>set_tempdir()</code> method is 
that on some Windows systems it will limit you to approximately 800 
concurrent tempfiles. This means that a single program running on one of
 these systems will be limited to creating a total of 800 workbook and 
worksheet objects. You can run multiple, non-concurrent programs to work
 around this if necessary.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_custom_color($index,_$red,_$green,_$blue)">set_custom_color($index, $red, $green, $blue)</a></h2>

<p>The <code>set_custom_color()</code> method can be used to override one of the built-in palette values with a more suitable colour.</p>

<p>The value for <code>$index</code> should be in the range 8..63, see <a href="#COLOURS_IN_EXCEL" class="podlinkpod">"COLOURS IN EXCEL"</a>.</p>

<p>The default named colours use the following indices:</p>

<pre class="sh_perl sh_sourceCode">     <span class="sh_number">8</span>   <span class="sh_symbol">=&gt;</span>   black
     <span class="sh_number">9</span>   <span class="sh_symbol">=&gt;</span>   white
    <span class="sh_number">10</span>   <span class="sh_symbol">=&gt;</span>   red
    <span class="sh_number">11</span>   <span class="sh_symbol">=&gt;</span>   lime
    <span class="sh_number">12</span>   <span class="sh_symbol">=&gt;</span>   blue
    <span class="sh_number">13</span>   <span class="sh_symbol">=&gt;</span>   yellow
    <span class="sh_number">14</span>   <span class="sh_symbol">=&gt;</span>   magenta
    <span class="sh_number">15</span>   <span class="sh_symbol">=&gt;</span>   cyan
    <span class="sh_number">16</span>   <span class="sh_symbol">=&gt;</span>   brown
    <span class="sh_number">17</span>   <span class="sh_symbol">=&gt;</span>   green
    <span class="sh_number">18</span>   <span class="sh_symbol">=&gt;</span>   navy
    <span class="sh_number">20</span>   <span class="sh_symbol">=&gt;</span>   purple
    <span class="sh_number">22</span>   <span class="sh_symbol">=&gt;</span>   silver
    <span class="sh_number">23</span>   <span class="sh_symbol">=&gt;</span>   gray
    <span class="sh_number">33</span>   <span class="sh_symbol">=&gt;</span>   pink
    <span class="sh_number">53</span>   <span class="sh_symbol">=&gt;</span>   orange</pre>

<p>A new colour is set using its RGB (red green blue) components. The <code>$red</code>, <code>$green</code> and <code>$blue</code> values must be in the range 0..255. You can determine the required values in Excel using the <code>Tools-&gt;Options-&gt;Colors-&gt;Modify</code> dialog.</p>

<p>The <code>set_custom_color()</code> workbook method can also be used with a HTML style <code>#rrggbb</code> hex value:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_custom_color</span><span class="sh_symbol">(</span><span class="sh_number">40</span><span class="sh_symbol">,</span> <span class="sh_number">255</span><span class="sh_symbol">,</span>  <span class="sh_number">102</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span>   <span class="sh_symbol">);</span> <span class="sh_comment"># Orange</span>
    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_custom_color</span><span class="sh_symbol">(</span><span class="sh_number">40</span><span class="sh_symbol">,</span> <span class="sh_number">0xFF</span><span class="sh_symbol">,</span> <span class="sh_number">0x66</span><span class="sh_symbol">,</span> <span class="sh_number">0x00</span><span class="sh_symbol">);</span> <span class="sh_comment"># Same thing</span>
    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_custom_color</span><span class="sh_symbol">(</span><span class="sh_number">40</span><span class="sh_symbol">,</span> <span class="sh_string">'#FF6600'</span>       <span class="sh_symbol">);</span> <span class="sh_comment"># Same thing</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$font</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>color <span class="sh_symbol">=&gt;</span> <span class="sh_number">40</span><span class="sh_symbol">);</span> <span class="sh_comment"># Use the modified colour</span></pre>

<p>The return value from <code>set_custom_color()</code> is the index of the colour that was changed:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$ferrari</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_custom_color</span><span class="sh_symbol">(</span><span class="sh_number">40</span><span class="sh_symbol">,</span> <span class="sh_number">216</span><span class="sh_symbol">,</span> <span class="sh_number">12</span><span class="sh_symbol">,</span> <span class="sh_number">12</span><span class="sh_symbol">);</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span>  <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>
                                        bg_color <span class="sh_symbol">=&gt;</span> <span class="sh_variable">$ferrari</span><span class="sh_symbol">,</span>
                                        pattern  <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
                                        border   <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span>
                                      <span class="sh_symbol">);</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="sheets(0,_1,_...)">sheets(0, 1, ...)</a></h2>

<p>The <code>sheets()</code> method returns a list, or a sliced list, of the worksheets in a workbook.</p>

<p>If no arguments are passed the method returns a list of all the 
worksheets in the workbook. This is useful if you want to repeat an 
operation on each worksheet:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">foreach</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">(</span><span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">sheets</span><span class="sh_symbol">())</span> <span class="sh_cbracket">{</span>
       <span class="sh_keyword">print</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">get_name</span><span class="sh_symbol">();</span>
    <span class="sh_cbracket">}</span></pre>

<p>You can also specify a slice list to return one or more worksheet objects:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">sheets</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">);</span></pre>

<p>Or since return value from <code>sheets()</code> is a reference to a worksheet object you can write the above example as:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">sheets</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">)-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">);</span></pre>

<p>The following example returns the first and last worksheet in a workbook:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">foreach</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">(</span><span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">sheets</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">))</span> <span class="sh_cbracket">{</span>
       <span class="sh_comment"># Do something</span>
    <span class="sh_cbracket">}</span></pre>

<p>Array slices are explained in the perldata manpage.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_1904()">set_1904()</a></h2>

<p>Excel stores dates as real numbers where the integer part stores the 
number of days since the epoch and the fractional part stores the 
percentage of the day. The epoch can be either 1900 or 1904. Excel for 
Windows uses 1900 and Excel for Macintosh uses 1904. However, Excel on 
either platform will convert automatically between one system and the 
other.</p>

<p>Spreadsheet::WriteExcel stores dates in the 1900 format by default. If you wish to change this you can call the <code>set_1904()</code> workbook method. You can query the current value by calling the <code>get_1904()</code> workbook method. This returns 0 for 1900 and 1 for 1904.</p>

<p>See also <a href="#DATES_AND_TIME_IN_EXCEL" class="podlinkpod">"DATES AND TIME IN EXCEL"</a> for more information about working with Excel's date system.</p>

<p>In general you probably won't need to use <code>set_1904()</code>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_codepage($codepage)">set_codepage($codepage)</a></h2>

<p>The default code page or character set used by 
Spreadsheet::WriteExcel is ANSI. This is also the default used by Excel 
for Windows. Occasionally however it may be necessary to change the code
 page via the <code>set_codepage()</code> method.</p>

<p>Changing the code page may be required if your are using 
Spreadsheet::WriteExcel on the Macintosh and you are using characters 
outside the ASCII 128 character set:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_codepage</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># ANSI, MS Windows</span>
    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_codepage</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">);</span> <span class="sh_comment"># Apple Macintosh</span></pre>

<p>The <code>set_codepage()</code> method is rarely required.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="WORKSHEET_METHODS">WORKSHEET METHODS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>A new worksheet is created by calling the <code>add_worksheet()</code> method from a workbook object:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$worksheet2</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span></pre>

<p>The following methods are available through a new worksheet:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">write</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_number</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_string</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_utf16be_string</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_utf16le_string</span><span class="sh_symbol">()</span>
    <span class="sh_function">keep_leading_zeros</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_blank</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_row</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_col</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_date_time</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_url</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_url_range</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_formula</span><span class="sh_symbol">()</span>
    <span class="sh_function">store_formula</span><span class="sh_symbol">()</span>
    <span class="sh_function">repeat_formula</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_comment</span><span class="sh_symbol">()</span>
    <span class="sh_function">show_comments</span><span class="sh_symbol">()</span>
    <span class="sh_function">add_write_handler</span><span class="sh_symbol">()</span>
    <span class="sh_function">insert_image</span><span class="sh_symbol">()</span>
    <span class="sh_function">insert_chart</span><span class="sh_symbol">()</span>
    <span class="sh_function">data_validation</span><span class="sh_symbol">()</span>
    <span class="sh_function">get_name</span><span class="sh_symbol">()</span>
    <span class="sh_function">activate</span><span class="sh_symbol">()</span>
    <span class="sh_keyword">select</span><span class="sh_symbol">()</span>
    <span class="sh_function">hide</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_first_sheet</span><span class="sh_symbol">()</span>
    <span class="sh_function">protect</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_selection</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_row</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_column</span><span class="sh_symbol">()</span>
    <span class="sh_function">outline_settings</span><span class="sh_symbol">()</span>
    <span class="sh_function">freeze_panes</span><span class="sh_symbol">()</span>
    <span class="sh_function">split_panes</span><span class="sh_symbol">()</span>
    <span class="sh_function">merge_range</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_zoom</span><span class="sh_symbol">()</span>
    <span class="sh_function">right_to_left</span><span class="sh_symbol">()</span>
    <span class="sh_function">hide_zero</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_tab_color</span><span class="sh_symbol">()</span>
    <span class="sh_function">autofilter</span><span class="sh_symbol">()</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Cell_notation">Cell notation</a></h2>

<p>Spreadsheet::WriteExcel supports two forms of notation to designate the position of cells: Row-column notation and A1 notation.</p>

<p>Row-column notation uses a zero based index for both row and column 
while A1 notation uses the standard Excel alphanumeric sequence of 
column letter and 1-based row. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">)</span>      <span class="sh_comment"># The top left cell in row-column notation.</span>
    <span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">)</span>      <span class="sh_comment"># The top left cell in A1 notation.</span>

    <span class="sh_symbol">(</span><span class="sh_number">1999</span><span class="sh_symbol">,</span> <span class="sh_number">29</span><span class="sh_symbol">)</span>  <span class="sh_comment"># Row-column notation.</span>
    <span class="sh_symbol">(</span><span class="sh_string">'AD2000'</span><span class="sh_symbol">)</span>  <span class="sh_comment"># The same cell in A1 notation.</span></pre>

<p>Row-column notation is useful if you are referring to cells programmatically:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">for</span> <span class="sh_keyword">my</span> <span class="sh_variable">$i</span> <span class="sh_symbol">(</span><span class="sh_number">0</span> <span class="sh_symbol">..</span> <span class="sh_number">9</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_variable">$i</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Cells A1 to A10</span>
    <span class="sh_cbracket">}</span></pre>

<p>A1 notation is useful for setting up a worksheet manually and for working with formulas:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'H1'</span><span class="sh_symbol">,</span> <span class="sh_number">200</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'H2'</span><span class="sh_symbol">,</span> <span class="sh_string">'=H1+1'</span><span class="sh_symbol">);</span></pre>

<p>In formulas and applicable methods you can also use the <code>A:A</code> column notation:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'=SUM(B:B)'</span><span class="sh_symbol">);</span></pre>

<p>The <code>Spreadsheet::WriteExcel::Utility</code> module that is included in the distro contains helper functions for dealing with A1 notation, for example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">::</span>Utility<span class="sh_symbol">;</span>

    <span class="sh_symbol">(</span><span class="sh_variable">$row</span><span class="sh_symbol">,</span> <span class="sh_variable">$col</span><span class="sh_symbol">)</span>    <span class="sh_symbol">=</span> <span class="sh_function">xl_cell_to_rowcol</span><span class="sh_symbol">(</span><span class="sh_string">'C2'</span><span class="sh_symbol">);</span>  <span class="sh_comment"># (1, 2)</span>
    <span class="sh_variable">$str</span>            <span class="sh_symbol">=</span> <span class="sh_function">xl_rowcol_to_cell</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">);</span>  <span class="sh_comment"># C2</span></pre>

<p>For simplicity, the parameter lists for the worksheet method calls in
 the following sections are given in terms of row-column notation. In 
all cases it is also possible to use A1 notation.</p>

<p>Note: in Excel it is also possible to use a R1C1 notation. This is not supported by Spreadsheet::WriteExcel.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write($row,_$column,_$token,_$format)">write($row, $column, $token, $format)</a></h2>

<p>Excel makes a distinction between data types such as strings, 
numbers, blanks, formulas and hyperlinks. To simplify the process of 
writing data the <code>write()</code> method acts as a general alias for several more specific methods:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_function">write_string</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_number</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_blank</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_formula</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_url</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_row</span><span class="sh_symbol">()</span>
    <span class="sh_function">write_col</span><span class="sh_symbol">()</span></pre>

<p>The general rule is that if the data looks like a <i>something</i> then a <i>something</i> is written. Here are some examples in both row-column and A1 notation:</p>

<pre class="sh_perl sh_sourceCode">                                                      <span class="sh_comment"># Same as:</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span>                <span class="sh_symbol">);</span> <span class="sh_comment"># write_string()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'One'</span>                  <span class="sh_symbol">);</span> <span class="sh_comment"># write_string()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_number">2</span>                     <span class="sh_symbol">);</span> <span class="sh_comment"># write_number()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_number">3.00001</span>               <span class="sh_symbol">);</span> <span class="sh_comment"># write_number()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_string">""</span>                    <span class="sh_symbol">);</span> <span class="sh_comment"># write_blank()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">5</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_string">''</span>                    <span class="sh_symbol">);</span> <span class="sh_comment"># write_blank()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">6</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_keyword">undef</span>                 <span class="sh_symbol">);</span> <span class="sh_comment"># write_blank()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">7</span><span class="sh_symbol">,</span> <span class="sh_number">0</span>                         <span class="sh_symbol">);</span> <span class="sh_comment"># write_blank()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">8</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_string">'</span><a href="http://www.perl.com/" class="podlinkurl"><span class="sh_string">http://www.perl.com/</span></a><span class="sh_string">'</span><span class="sh_symbol">);</span> <span class="sh_comment"># write_url()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A9'</span><span class="sh_symbol">,</span>  <span class="sh_string">'</span><a href="ftp://ftp.cpan.org/" class="podlinkurl"><span class="sh_string">ftp://ftp.cpan.org/</span></a><span class="sh_string">'</span> <span class="sh_symbol">);</span> <span class="sh_comment"># write_url()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A10'</span><span class="sh_symbol">,</span> <span class="sh_string">'internal:Sheet1!A1'</span>  <span class="sh_symbol">);</span> <span class="sh_comment"># write_url()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A11'</span><span class="sh_symbol">,</span> <span class="sh_string">'external:c:\foo.xls'</span> <span class="sh_symbol">);</span> <span class="sh_comment"># write_url()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A12'</span><span class="sh_symbol">,</span> <span class="sh_string">'=A3 + 3*A4'</span>          <span class="sh_symbol">);</span> <span class="sh_comment"># write_formula()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A13'</span><span class="sh_symbol">,</span> <span class="sh_string">'=SIN(PI()/4)'</span>        <span class="sh_symbol">);</span> <span class="sh_comment"># write_formula()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A14'</span><span class="sh_symbol">,</span> <span class="sh_symbol">\</span><span class="sh_variable">@array</span>               <span class="sh_symbol">);</span> <span class="sh_comment"># write_row()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A15'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[\</span><span class="sh_variable">@array</span><span class="sh_symbol">]</span>             <span class="sh_symbol">);</span> <span class="sh_comment"># write_col()</span>

    <span class="sh_comment"># And if the keep_leading_zeros property is set:</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A16'</span><span class="sh_symbol">,</span> <span class="sh_string">'2'</span>                   <span class="sh_symbol">);</span> <span class="sh_comment"># write_number()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A17'</span><span class="sh_symbol">,</span> <span class="sh_string">'02'</span>                  <span class="sh_symbol">);</span> <span class="sh_comment"># write_string()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A18'</span><span class="sh_symbol">,</span> <span class="sh_string">'00002'</span>               <span class="sh_symbol">);</span> <span class="sh_comment"># write_string()</span></pre>

<p>The "looks like" rule is defined by regular expressions:</p>

<p><code>write_number()</code> if <code>$token</code> is a number based on the following regex: <code>$token =~ /^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/</code>.</p>

<p><code>write_string()</code> if <code>keep_leading_zeros()</code> is set and <code>$token</code> is an integer with leading zeros based on the following regex: <code>$token =~ /^0\d+$/</code>.</p>

<p><code>write_blank()</code> if <code>$token</code> is undef or a blank string: <code>undef</code>, <code>""</code> or <code>''</code>.</p>

<p><code>write_url()</code> if <code>$token</code> is a http, https, ftp or mailto URL based on the following regexes: <code>$token =~ m|^[fh]tt?ps?://|</code> or <code>$token =~ m|^mailto:|</code>.</p>

<p><code>write_url()</code> if <code>$token</code> is an internal or external sheet reference based on the following regex: <code>$token =~ m[^(in|ex)ternal:]</code>.</p>

<p><code>write_formula()</code> if the first character of <code>$token</code> is <code>"="</code>.</p>

<p><code>write_row()</code> if <code>$token</code> is an array ref.</p>

<p><code>write_col()</code> if <code>$token</code> is an array ref of array refs.</p>

<p><code>write_string()</code> if none of the previous conditions apply.</p>

<p>The <code>$format</code> parameter is optional. It should be a valid Format object, see <a href="#CELL_FORMATTING" class="podlinkpod">"CELL FORMATTING"</a>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_color</span><span class="sh_symbol">(</span><span class="sh_string">'red'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_align</span><span class="sh_symbol">(</span><span class="sh_string">'center'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span> <span class="sh_comment"># Formatted string</span></pre>

<p>The write() method will ignore empty strings or <code>undef</code> tokens unless a format is also supplied. As such you needn't worry about special handling for empty or <code>undef</code> values in your data. See also the <code>write_blank()</code> method.</p>

<p>One problem with the <code>write()</code> method is that occasionally
 data looks like a number but you don't want it treated as a number. For
 example, zip codes or ID numbers often start with a leading zero. If 
you write this data as a number then the leading zero(s) will be 
stripped. You can change this default behaviour by using the <code>keep_leading_zeros()</code>
 method. While this property is in place any integers with leading zeros
 will be treated as strings and the zeros will be preserved. See the <code>keep_leading_zeros()</code> section for a full discussion of this issue.</p>

<p>You can also add your own data handlers to the <code>write()</code> method using <code>add_write_handler()</code>.</p>

<p>On systems with <code>perl 5.8</code> and later the <code>write()</code> method will also handle Unicode strings in <code>UTF-8</code> format.</p>

<p>The <code>write</code> methods return:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_number">0</span> <span class="sh_keyword">for</span> success<span class="sh_symbol">.</span>
   <span class="sh_symbol">-</span><span class="sh_number">1</span> <span class="sh_keyword">for</span> insufficient number of arguments<span class="sh_symbol">.</span>
   <span class="sh_symbol">-</span><span class="sh_number">2</span> <span class="sh_keyword">for</span> row or column out of bounds<span class="sh_symbol">.</span>
   <span class="sh_symbol">-</span><span class="sh_number">3</span> <span class="sh_keyword">for</span> string too long<span class="sh_symbol">.</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_number($row,_$column,_$number,_$format)">write_number($row, $column, $number, $format)</a></h2>

<p>Write an integer or a float to the cell specified by <code>$row</code> and <code>$column</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_number</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_number">123456</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_number</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span>  <span class="sh_number">2.3451</span><span class="sh_symbol">);</span></pre>

<p>See the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a>. The <code>$format</code> parameter is optional.</p>

<p>In general it is sufficient to use the <code>write()</code> method.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_string($row,_$column,_$string,_$format)">write_string($row, $column, $string, $format)</a></h2>

<p>Write a string to the cell specified by <code>$row</code> and <code>$column</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_string</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Your text here'</span> <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_string</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span> <span class="sh_string">'or here'</span> <span class="sh_symbol">);</span></pre>

<p>The maximum string size is 32767 characters. However the maximum 
string segment that Excel can display in a cell is 1000. All 32767 
characters can be displayed in the formula bar.</p>

<p>The <code>$format</code> parameter is optional.</p>

<p>On systems with <code>perl 5.8</code> and later the <code>write()</code> method will also handle strings in <code>UTF-8</code> format. With older perls you can also write Unicode in <code>UTF16</code> format via the <code>write_utf16be_string()</code> method. See also the <code>unicode_*.pl</code> programs in the examples directory of the distro.</p>

<p>In general it is sufficient to use the <code>write()</code> method. However, you may sometimes wish to use the <code>write_string()</code>
 method to write data that looks like a number but that you don't want 
treated as a number. For example, zip codes or phone numbers:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># Write as a plain string</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_string</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'01209'</span><span class="sh_symbol">);</span></pre>

<p>However, if the user edits this string Excel may convert it back to a
 number. To get around this you can use the Excel text format <code>@</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># Format as a string. Doesn't change to a number when edited</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$format1</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>num_format <span class="sh_symbol">=&gt;</span> <span class="sh_string">'@'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_string</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span> <span class="sh_string">'01209'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format1</span><span class="sh_symbol">);</span></pre>

<p>See also the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_utf16be_string($row,_$column,_$string,_$format)">write_utf16be_string($row, $column, $string, $format)</a></h2>

<p>This method is used to write <code>UTF-16BE</code> strings to a cell in Excel. It is functionally the same as the <code>write_string()</code> method except that the string should be in <code>UTF-16BE</code> Unicode format. It is generally easier, when using Spreadsheet::WriteExcel, to write unicode strings in <code>UTF-8</code> format, see <a href="#UNICODE_IN_EXCEL" class="podlinkpod">"UNICODE IN EXCEL"</a>. The <code>write_utf16be_string()</code> method is mainly of use in versions of perl prior to 5.8.</p>

<p>The following is a simple example showing how to write some Unicode strings in <code>UTF-16BE</code> format:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment">#!/usr/bin/perl -w</span>


    <span class="sh_keyword">use</span> strict<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Unicode<span class="sh_symbol">::</span><span class="sh_function">Map</span><span class="sh_symbol">();</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'utf_16_be.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>

    <span class="sh_comment"># Increase the column width for clarity</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'A:A'</span><span class="sh_symbol">,</span> <span class="sh_number">25</span><span class="sh_symbol">);</span>


    <span class="sh_comment"># Write a Unicode character</span>
    <span class="sh_comment">#</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$smiley</span> <span class="sh_symbol">=</span> <span class="sh_keyword">pack</span> <span class="sh_string">'n'</span><span class="sh_symbol">,</span> <span class="sh_number">0x263a</span><span class="sh_symbol">;</span>

    <span class="sh_comment"># Increase the font size for legibility.</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$big_font</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>size <span class="sh_symbol">=&gt;</span> <span class="sh_number">72</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_utf16be_string</span><span class="sh_symbol">(</span><span class="sh_string">'A3'</span><span class="sh_symbol">,</span> <span class="sh_variable">$smiley</span><span class="sh_symbol">,</span> <span class="sh_variable">$big_font</span><span class="sh_symbol">);</span>



    <span class="sh_comment"># Write a phrase in Cyrillic using a hex-encoded string</span>
    <span class="sh_comment">#</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$str</span> <span class="sh_symbol">=</span> <span class="sh_keyword">pack</span> <span class="sh_string">'H*'</span><span class="sh_symbol">,</span> <span class="sh_string">'042d0442043e0020044404400430043704300020043d'</span> <span class="sh_symbol">.</span>
                         <span class="sh_string">'043000200440044304410441043a043e043c0021'</span><span class="sh_symbol">;</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_utf16be_string</span><span class="sh_symbol">(</span><span class="sh_string">'A5'</span><span class="sh_symbol">,</span> <span class="sh_variable">$str</span><span class="sh_symbol">);</span>



    <span class="sh_comment"># Map a string to UTF-16BE using an external module.</span>
    <span class="sh_comment">#</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$map</span>   <span class="sh_symbol">=</span> Unicode<span class="sh_symbol">::</span>Map<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'ISO-8859-1'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$utf16</span> <span class="sh_symbol">=</span> <span class="sh_variable">$map</span><span class="sh_symbol">-&gt;</span><span class="sh_function">to_unicode</span><span class="sh_symbol">(</span><span class="sh_string">'Hello world!'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_utf16be_string</span><span class="sh_symbol">(</span><span class="sh_string">'A7'</span><span class="sh_symbol">,</span> <span class="sh_variable">$utf16</span><span class="sh_symbol">);</span></pre>

<p>You can convert ASCII encodings to the required <code>UTF-16BE</code> format using one of the many Unicode modules on CPAN. For example <code>Unicode::Map</code> and <code>Unicode::String</code>: <a href="http://search.cpan.org/author/MSCHWARTZ/Unicode-Map/Map.pm" class="podlinkurl">http://search.cpan.org/author/MSCHWARTZ/Unicode-Map/Map.pm</a> and <a href="http://search.cpan.org/author/GAAS/Unicode-String/String.pm" class="podlinkurl">http://search.cpan.org/author/GAAS/Unicode-String/String.pm</a>.</p>

<p>For a full list of the Perl Unicode modules see: <a href="http://search.cpan.org/search?query=unicode&amp;mode=all" class="podlinkurl">http://search.cpan.org/search?query=unicode&amp;mode=all</a>.</p>

<p><code>UTF-16BE</code> is the format most often returned by <code>Perl</code> modules that generate <code>UTF-16</code>. To write <code>UTF-16</code> strings in little-endian format use the <code>write_utf16be_string_le()</code> method below.</p>

<p>The <code>write_utf16be_string()</code> method was previously called <code>write_unicode()</code>. That, overly general, name is still supported but deprecated.</p>

<p>See also the <code>unicode_*.pl</code> programs in the examples directory of the distro.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_utf16le_string($row,_$column,_$string,_$format)">write_utf16le_string($row, $column, $string, $format)</a></h2>

<p>This method is the same as <code>write_utf16be()</code> except that the string should be 16-bit characters in little-endian format. This is generally referred to as <code>UTF-16LE</code>. See <a href="#UNICODE_IN_EXCEL" class="podlinkpod">"UNICODE IN EXCEL"</a>.</p>

<p><code>UTF-16</code> data can be changed from little-endian to big-endian format (and vice-versa) as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$utf16be</span> <span class="sh_symbol">=</span> <span class="sh_keyword">pack</span> <span class="sh_string">'n*'</span><span class="sh_symbol">,</span> <span class="sh_keyword">unpack</span> <span class="sh_string">'v*'</span><span class="sh_symbol">,</span> <span class="sh_variable">$utf16le</span><span class="sh_symbol">;</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="keep_leading_zeros()">keep_leading_zeros()</a></h2>

<p>This method changes the default handling of integers with leading zeros when using the <code>write()</code> method.</p>

<p>The <code>write()</code> method uses regular expressions to determine
 what type of data to write to an Excel worksheet. If the data looks 
like a number it writes a number using <code>write_number()</code>. One problem with this approach is that occasionally data looks like a number but you don't want it treated as a number.</p>

<p>Zip codes and ID numbers, for example, often start with a leading 
zero. If you write this data as a number then the leading zero(s) will 
be stripped. This is the also the default behaviour when you enter data 
manually in Excel.</p>

<p>To get around this you can use one of three options. Write a formatted number, write the number as a string or use the <code>keep_leading_zeros()</code> method to change the default behaviour of <code>write()</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># Implicitly write a number, the leading zero is removed: 1209</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'01209'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Write a zero padded number using a format: 01209</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$format1</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>num_format <span class="sh_symbol">=&gt;</span> <span class="sh_string">'00000'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span> <span class="sh_string">'01209'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format1</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Write explicitly as a string: 01209</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_string</span><span class="sh_symbol">(</span><span class="sh_string">'A3'</span><span class="sh_symbol">,</span> <span class="sh_string">'01209'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Write implicitly as a string: 01209</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">keep_leading_zeros</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A4'</span><span class="sh_symbol">,</span> <span class="sh_string">'01209'</span><span class="sh_symbol">);</span></pre>

<p>The above code would generate a worksheet that looked like the following:</p>

<pre class="sh_perl sh_sourceCode">     <span class="sh_symbol">-----------------------------------------------------------</span>
    <span class="sh_symbol">|</span>   <span class="sh_symbol">|</span>     A     <span class="sh_symbol">|</span>     B     <span class="sh_symbol">|</span>     C     <span class="sh_symbol">|</span>     D     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
     <span class="sh_symbol">-----------------------------------------------------------</span>
    <span class="sh_symbol">|</span> <span class="sh_number">1</span> <span class="sh_symbol">|</span>      <span class="sh_number">1209</span> <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">2</span> <span class="sh_symbol">|</span>     <span class="sh_number">01209</span> <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">3</span> <span class="sh_symbol">|</span> <span class="sh_number">01209</span>     <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">4</span> <span class="sh_symbol">|</span> <span class="sh_number">01209</span>     <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span>           <span class="sh_symbol">|</span> <span class="sh_symbol">...</span></pre>

<p>The examples are on different sides of the cells due to the fact that
 Excel displays strings with a left justification and numbers with a 
right justification by default. You can change this by using a format to
 justify the data, see <a href="#CELL_FORMATTING" class="podlinkpod">"CELL FORMATTING"</a>.</p>

<p>It should be noted that if the user edits the data in examples <code>A3</code> and <code>A4</code> the strings will revert back to numbers. Again this is Excel's default behaviour. To avoid this you can use the text format <code>@</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># Format as a string (01209)</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$format2</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>num_format <span class="sh_symbol">=&gt;</span> <span class="sh_string">'@'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_string</span><span class="sh_symbol">(</span><span class="sh_string">'A5'</span><span class="sh_symbol">,</span> <span class="sh_string">'01209'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format2</span><span class="sh_symbol">);</span></pre>

<p>The <code>keep_leading_zeros()</code> property is off by default. The <code>keep_leading_zeros()</code> method takes 0 or 1 as an argument. It defaults to 1 if an argument isn't specified:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">keep_leading_zeros</span><span class="sh_symbol">();</span>  <span class="sh_comment"># Set on</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">keep_leading_zeros</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># Set on</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">keep_leading_zeros</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span> <span class="sh_comment"># Set off</span></pre>

<p>See also the <code>add_write_handler()</code> method.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_blank($row,_$column,_$format)">write_blank($row, $column, $format)</a></h2>

<p>Write a blank cell specified by <code>$row</code> and <code>$column</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_blank</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>This method is used to add formatting to a cell which doesn't contain a string or number value.</p>

<p>Excel differentiates between an "Empty" cell and a "Blank" cell. An 
"Empty" cell is a cell which doesn't contain data whilst a "Blank" cell 
is a cell which doesn't contain data but does contain formatting. Excel 
stores "Blank" cells but ignores "Empty" cells.</p>

<p>As such, if you write an empty cell without formatting it is ignored:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span>  <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span> <span class="sh_comment"># write_blank()</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span>  <span class="sh_keyword">undef</span>         <span class="sh_symbol">);</span> <span class="sh_comment"># Ignored</span></pre>

<p>This seemingly uninteresting fact means that you can write arrays of 
data without special treatment for undef or empty string values.</p>

<p>See the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_row($row,_$column,_$array_ref,_$format)">write_row($row, $column, $array_ref, $format)</a></h2>

<p>The <code>write_row()</code> method can be used to write a 1D or 2D 
array of data in one go. This is useful for converting the results of a 
database query into an Excel worksheet. You must pass a reference to the
 array of data rather than the array itself. The <code>write()</code> method is then called for each element of the data. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">@array</span>      <span class="sh_symbol">=</span> <span class="sh_symbol">(</span><span class="sh_string">'awk'</span><span class="sh_symbol">,</span> <span class="sh_string">'gawk'</span><span class="sh_symbol">,</span> <span class="sh_string">'mawk'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$array_ref</span>  <span class="sh_symbol">=</span> <span class="sh_symbol">\</span><span class="sh_variable">@array</span><span class="sh_symbol">;</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_row</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_variable">$array_ref</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># The above example is equivalent to:</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_variable">$array</span><span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_variable">$array</span><span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_variable">$array</span><span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]);</span></pre>

<p>Note: For convenience the <code>write()</code> method behaves in the same way as <code>write_row()</code> if it is passed an array reference. Therefore the following two method calls are equivalent:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_row</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$array_ref</span><span class="sh_symbol">);</span> <span class="sh_comment"># Write a row of data</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span>    <span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$array_ref</span><span class="sh_symbol">);</span> <span class="sh_comment"># Same thing</span></pre>

<p>As with all of the write methods the <code>$format</code> parameter is optional. If a format is specified it is applied to all the elements of the data array.</p>

<p>Array references within the data will be treated as columns. This allows you to write 2D arrays of data in one go. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">@eec</span> <span class="sh_symbol">=</span>  <span class="sh_symbol">(</span>
                <span class="sh_symbol">[</span><span class="sh_string">'maggie'</span><span class="sh_symbol">,</span> <span class="sh_string">'milly'</span><span class="sh_symbol">,</span> <span class="sh_string">'molly'</span><span class="sh_symbol">,</span> <span class="sh_string">'may'</span>  <span class="sh_symbol">],</span>
                <span class="sh_symbol">[</span><span class="sh_number">13</span><span class="sh_symbol">,</span>       <span class="sh_number">14</span><span class="sh_symbol">,</span>      <span class="sh_number">15</span><span class="sh_symbol">,</span>      <span class="sh_number">16</span>     <span class="sh_symbol">],</span>
                <span class="sh_symbol">[</span><span class="sh_string">'shell'</span><span class="sh_symbol">,</span>  <span class="sh_string">'star'</span><span class="sh_symbol">,</span>  <span class="sh_string">'crab'</span><span class="sh_symbol">,</span>  <span class="sh_string">'stone'</span><span class="sh_symbol">]</span>
            <span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_row</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_symbol">\</span><span class="sh_variable">@eec</span><span class="sh_symbol">);</span></pre>

<p>Would produce a worksheet as follows:</p>

<pre class="sh_perl sh_sourceCode">     <span class="sh_symbol">-----------------------------------------------------------</span>
    <span class="sh_symbol">|</span>   <span class="sh_symbol">|</span>    A    <span class="sh_symbol">|</span>    B    <span class="sh_symbol">|</span>    C    <span class="sh_symbol">|</span>    D    <span class="sh_symbol">|</span>    E    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
     <span class="sh_symbol">-----------------------------------------------------------</span>
    <span class="sh_symbol">|</span> <span class="sh_number">1</span> <span class="sh_symbol">|</span> maggie  <span class="sh_symbol">|</span> <span class="sh_number">13</span>      <span class="sh_symbol">|</span> shell   <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">2</span> <span class="sh_symbol">|</span> milly   <span class="sh_symbol">|</span> <span class="sh_number">14</span>      <span class="sh_symbol">|</span> star    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">3</span> <span class="sh_symbol">|</span> molly   <span class="sh_symbol">|</span> <span class="sh_number">15</span>      <span class="sh_symbol">|</span> crab    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">4</span> <span class="sh_symbol">|</span> may     <span class="sh_symbol">|</span> <span class="sh_number">16</span>      <span class="sh_symbol">|</span> stone   <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">5</span> <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">6</span> <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span></pre>

<p>To write the data in a row-column order refer to the <code>write_col()</code> method below.</p>

<p>Any <code>undef</code> values in the data will be ignored unless a 
format is applied to the data, in which case a formatted blank cell will
 be written. In either case the appropriate row or column value will 
still be incremented.</p>

<p>To find out more about array references refer to <code>perlref</code> and <code>perlreftut</code> in the main Perl documentation. To find out more about 2D arrays or "lists of lists" refer to <code>perllol</code>.</p>

<p>The <code>write_row()</code> method returns the first error 
encountered when writing the elements of the data or zero if no errors 
were encountered. See the return values described for the <code>write()</code> method above.</p>

<p>See also the <code>write_arrays.pl</code> program in the <code>examples</code> directory of the distro.</p>

<p>The <code>write_row()</code> method allows the following idiomatic conversion of a text file to an Excel file:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment">#!/usr/bin/perl -w</span>

    <span class="sh_keyword">use</span> strict<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'file.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>

    <span class="sh_keyword">open</span> INPUT<span class="sh_symbol">,</span> <span class="sh_string">'file.txt'</span> or <span class="sh_keyword">die</span> <span class="sh_string">"Couldn't open file: $!"</span><span class="sh_symbol">;</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span>$<span class="sh_symbol">.-</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_symbol">[</span><span class="sh_keyword">split</span><span class="sh_symbol">])</span> <span class="sh_keyword">while</span> <span class="sh_string">&lt;INPUT&gt;</span><span class="sh_symbol">;</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_col($row,_$column,_$array_ref,_$format)">write_col($row, $column, $array_ref, $format)</a></h2>

<p>The <code>write_col()</code> method can be used to write a 1D or 2D 
array of data in one go. This is useful for converting the results of a 
database query into an Excel worksheet. You must pass a reference to the
 array of data rather than the array itself. The <code>write()</code> method is then called for each element of the data. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">@array</span>      <span class="sh_symbol">=</span> <span class="sh_symbol">(</span><span class="sh_string">'awk'</span><span class="sh_symbol">,</span> <span class="sh_string">'gawk'</span><span class="sh_symbol">,</span> <span class="sh_string">'mawk'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$array_ref</span>  <span class="sh_symbol">=</span> <span class="sh_symbol">\</span><span class="sh_variable">@array</span><span class="sh_symbol">;</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_col</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_variable">$array_ref</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># The above example is equivalent to:</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_variable">$array</span><span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_variable">$array</span><span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_variable">$array</span><span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]);</span></pre>

<p>As with all of the write methods the <code>$format</code> parameter is optional. If a format is specified it is applied to all the elements of the data array.</p>

<p>Array references within the data will be treated as rows. This allows you to write 2D arrays of data in one go. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">@eec</span> <span class="sh_symbol">=</span>  <span class="sh_symbol">(</span>
                <span class="sh_symbol">[</span><span class="sh_string">'maggie'</span><span class="sh_symbol">,</span> <span class="sh_string">'milly'</span><span class="sh_symbol">,</span> <span class="sh_string">'molly'</span><span class="sh_symbol">,</span> <span class="sh_string">'may'</span>  <span class="sh_symbol">],</span>
                <span class="sh_symbol">[</span><span class="sh_number">13</span><span class="sh_symbol">,</span>       <span class="sh_number">14</span><span class="sh_symbol">,</span>      <span class="sh_number">15</span><span class="sh_symbol">,</span>      <span class="sh_number">16</span>     <span class="sh_symbol">],</span>
                <span class="sh_symbol">[</span><span class="sh_string">'shell'</span><span class="sh_symbol">,</span>  <span class="sh_string">'star'</span><span class="sh_symbol">,</span>  <span class="sh_string">'crab'</span><span class="sh_symbol">,</span>  <span class="sh_string">'stone'</span><span class="sh_symbol">]</span>
            <span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_col</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_symbol">\</span><span class="sh_variable">@eec</span><span class="sh_symbol">);</span></pre>

<p>Would produce a worksheet as follows:</p>

<pre class="sh_perl sh_sourceCode">     <span class="sh_symbol">-----------------------------------------------------------</span>
    <span class="sh_symbol">|</span>   <span class="sh_symbol">|</span>    A    <span class="sh_symbol">|</span>    B    <span class="sh_symbol">|</span>    C    <span class="sh_symbol">|</span>    D    <span class="sh_symbol">|</span>    E    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
     <span class="sh_symbol">-----------------------------------------------------------</span>
    <span class="sh_symbol">|</span> <span class="sh_number">1</span> <span class="sh_symbol">|</span> maggie  <span class="sh_symbol">|</span> milly   <span class="sh_symbol">|</span> molly   <span class="sh_symbol">|</span> may     <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">2</span> <span class="sh_symbol">|</span> <span class="sh_number">13</span>      <span class="sh_symbol">|</span> <span class="sh_number">14</span>      <span class="sh_symbol">|</span> <span class="sh_number">15</span>      <span class="sh_symbol">|</span> <span class="sh_number">16</span>      <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">3</span> <span class="sh_symbol">|</span> shell   <span class="sh_symbol">|</span> star    <span class="sh_symbol">|</span> crab    <span class="sh_symbol">|</span> stone   <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">4</span> <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">5</span> <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">6</span> <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">...</span>     <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>    <span class="sh_symbol">|</span> <span class="sh_symbol">...</span></pre>

<p>To write the data in a column-row order refer to the <code>write_row()</code> method above.</p>

<p>Any <code>undef</code> values in the data will be ignored unless a 
format is applied to the data, in which case a formatted blank cell will
 be written. In either case the appropriate row or column value will 
still be incremented.</p>

<p>As noted above the <code>write()</code> method can be used as a synonym for <code>write_row()</code> and <code>write_row()</code>
 handles nested array refs as columns. Therefore, the following two 
method calls are equivalent although the more explicit call to <code>write_col()</code> would be preferable for maintainability:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_col</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$array_ref</span>    <span class="sh_symbol">);</span> <span class="sh_comment"># Write a column of data</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span>    <span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_symbol">[</span> <span class="sh_variable">$array_ref</span> <span class="sh_symbol">]);</span> <span class="sh_comment"># Same thing</span></pre>

<p>To find out more about array references refer to <code>perlref</code> and <code>perlreftut</code> in the main Perl documentation. To find out more about 2D arrays or "lists of lists" refer to <code>perllol</code>.</p>

<p>The <code>write_col()</code> method returns the first error 
encountered when writing the elements of the data or zero if no errors 
were encountered. See the return values described for the <code>write()</code> method above.</p>

<p>See also the <code>write_arrays.pl</code> program in the <code>examples</code> directory of the distro.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_date_time($row,_$col,_$date_string,_$format)">write_date_time($row, $col, $date_string, $format)</a></h2>

<p>The <code>write_date_time()</code> method can be used to write a date or time to the cell specified by <code>$row</code> and <code>$column</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_date_time</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'2004-05-13T23:20'</span><span class="sh_symbol">,</span> <span class="sh_variable">$date_format</span><span class="sh_symbol">);</span></pre>

<p>The <code>$date_string</code> should be in the following format:</p>

<pre class="sh_perl sh_sourceCode">    yyyy<span class="sh_symbol">-</span>mm<span class="sh_symbol">-</span>ddThh<span class="sh_symbol">:</span>mm<span class="sh_symbol">:</span>ss<span class="sh_symbol">.</span>sss</pre>

<p>This conforms to an ISO8601 date but it should be noted that the full range of ISO8601 formats are not supported.</p>

<p>The following variations on the <code>$date_string</code> parameter are permitted:</p>

<pre class="sh_perl sh_sourceCode">    yyyy<span class="sh_symbol">-</span>mm<span class="sh_symbol">-</span>ddThh<span class="sh_symbol">:</span>mm<span class="sh_symbol">:</span>ss<span class="sh_symbol">.</span>sss         <span class="sh_comment"># Standard format</span>
    yyyy<span class="sh_symbol">-</span>mm<span class="sh_symbol">-</span>ddT                     <span class="sh_comment"># No time</span>
              Thh<span class="sh_symbol">:</span>mm<span class="sh_symbol">:</span>ss<span class="sh_symbol">.</span>sss         <span class="sh_comment"># No date</span>
    yyyy<span class="sh_symbol">-</span>mm<span class="sh_symbol">-</span>ddThh<span class="sh_symbol">:</span>mm<span class="sh_symbol">:</span>ss<span class="sh_symbol">.</span>sssZ        <span class="sh_comment"># Additional Z (but not time zones)</span>
    yyyy<span class="sh_symbol">-</span>mm<span class="sh_symbol">-</span>ddThh<span class="sh_symbol">:</span>mm<span class="sh_symbol">:</span>ss             <span class="sh_comment"># No fractional seconds</span>
    yyyy<span class="sh_symbol">-</span>mm<span class="sh_symbol">-</span>ddThh<span class="sh_symbol">:</span>mm                <span class="sh_comment"># No seconds</span></pre>

<p>Note that the <code>T</code> is required in all cases.</p>

<p>A date should always have a <code>$format</code>, otherwise it will appear as a number, see <a href="#DATES_AND_TIME_IN_EXCEL" class="podlinkpod">"DATES AND TIME IN EXCEL"</a> and <a href="#CELL_FORMATTING" class="podlinkpod">"CELL FORMATTING"</a>. Here is a typical example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$date_format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>num_format <span class="sh_symbol">=&gt;</span> <span class="sh_string">'mm/dd/yy'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_date_time</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'2004-05-13T23:20'</span><span class="sh_symbol">,</span> <span class="sh_variable">$date_format</span><span class="sh_symbol">);</span></pre>

<p>Valid dates should be in the range 1900-01-01 to 9999-12-31, for the 
1900 epoch and 1904-01-01 to 9999-12-31, for the 1904 epoch. As with 
Excel, dates outside these ranges will be written as a string.</p>

<p>See also the date_time.pl program in the <code>examples</code> directory of the distro.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_url($row,_$col,_$url,_$label,_$format)">write_url($row, $col, $url, $label, $format)</a></h2>

<p>Write a hyperlink to a URL in the cell specified by <code>$row</code> and <code>$column</code>.
 The hyperlink is comprised of two elements: the visible label and the 
invisible link. The visible label is the same as the link unless an 
alternative label is specified. The parameters <code>$label</code> and the <code>$format</code> are optional and their position is interchangeable.</p>

<p>The label is written using the <code>write()</code> method. Therefore it is possible to write strings, numbers or formulas as labels.</p>

<p>There are four web style URI's supported: <code>http://</code>, <code>https://</code>, <code>ftp://</code> and <code>mailto:</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_string">'</span><a href="ftp://www.perl.org/" class="podlinkurl"><span class="sh_string">ftp://www.perl.org/</span></a><span class="sh_string">'</span>                  <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_string">'</span><a href="http://www.perl.com/" class="podlinkurl"><span class="sh_string">http://www.perl.com/</span></a><span class="sh_string">'</span><span class="sh_symbol">,</span> <span class="sh_string">'Perl home'</span>    <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A3'</span><span class="sh_symbol">,</span>  <span class="sh_string">'</span><a href="http://www.perl.com/" class="podlinkurl"><span class="sh_string">http://www.perl.com/</span></a><span class="sh_string">'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span>        <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A4'</span><span class="sh_symbol">,</span>  <span class="sh_string">'</span><a href="http://www.perl.com/" class="podlinkurl"><span class="sh_string">http://www.perl.com/</span></a><span class="sh_string">'</span><span class="sh_symbol">,</span> <span class="sh_string">'Perl'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A5'</span><span class="sh_symbol">,</span>  <span class="sh_string">'mailto:jmcnamara@cpan.org'</span>            <span class="sh_symbol">);</span></pre>

<p>There are two local URIs supported: <code>internal:</code> and <code>external:</code>. These are used for hyperlinks to internal worksheet references or external workbook and worksheet references:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A6'</span><span class="sh_symbol">,</span>  <span class="sh_string">'internal:Sheet2!A1'</span>                   <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A7'</span><span class="sh_symbol">,</span>  <span class="sh_string">'internal:Sheet2!A1'</span><span class="sh_symbol">,</span>   <span class="sh_variable">$format</span>        <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A8'</span><span class="sh_symbol">,</span>  <span class="sh_string">'internal:Sheet2!A1:B2'</span>                <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A9'</span><span class="sh_symbol">,</span>  <span class="sh_keyword">q</span><span class="sh_string">{internal:'Sales Data'!A1}</span>            <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A10'</span><span class="sh_symbol">,</span> <span class="sh_string">'external:c:\temp\foo.xls'</span>             <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A11'</span><span class="sh_symbol">,</span> <span class="sh_string">'external:c:\temp\foo.xls#Sheet2!A1'</span>   <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A12'</span><span class="sh_symbol">,</span> <span class="sh_string">'external:..\..\..\foo.xls'</span>            <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A13'</span><span class="sh_symbol">,</span> <span class="sh_string">'external:..\..\..\foo.xls#Sheet2!A1'</span>  <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A13'</span><span class="sh_symbol">,</span> <span class="sh_string">'external:\\\\NETWORK\share\foo.xls'</span>   <span class="sh_symbol">);</span></pre>

<p>All of the these URI types are recognised by the <code>write()</code> method, see above.</p>

<p>Worksheet references are typically of the form <code>Sheet1!A1</code>. You can also refer to a worksheet range using the standard Excel notation: <code>Sheet1!A1:B2</code>.</p>

<p>In external links the workbook and worksheet name must be separated by the <code>#</code> character: <code>external:Workbook.xls#Sheet1!A1'</code>.</p>

<p>You can also link to a named range in the target worksheet. For example say you have a named range called <code>my_name</code> in the workbook <code>c:\temp\foo.xls</code> you could link to it as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A14'</span><span class="sh_symbol">,</span> <span class="sh_string">'external:c:\temp\foo.xls#my_name'</span><span class="sh_symbol">);</span></pre>

<p>Note, you cannot currently create named ranges with <code>Spreadsheet::WriteExcel</code>.</p>

<p>Excel requires that worksheet names containing spaces or non alphanumeric characters are single quoted as follows <code>'Sales Data'!A1</code>. If you need to do this in a single quoted string then you can either escape the single quotes <code>\'</code> or use the quote operator <code>q{}</code> as described in <code>perlop</code> in the main Perl documentation.</p>

<p>Links to network files are also supported. MS/Novell Network files normally begin with two back slashes as follows <code>\\NETWORK\etc</code>. In order to generate this in a single or double quoted string you will have to escape the backslashes, <code>'\\\\NETWORK\etc'</code>.</p>

<p>If you are using double quote strings then you should be careful to 
escape anything that looks like a metacharacter. For more information 
see <code>perlfaq5: Why can't I use "C:\temp\foo" in DOS paths?</code>.</p>

<p>Finally, you can avoid most of these quoting problems by using forward slashes. These are translated internally to backslashes:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A14'</span><span class="sh_symbol">,</span> <span class="sh_string">"external:c:/temp/foo.xls"</span>             <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A15'</span><span class="sh_symbol">,</span> <span class="sh_string">'</span><a href="external://NETWORK/share/foo.xls" class="podlinkurl"><span class="sh_string">external://NETWORK/share/foo.xls</span></a><span class="sh_string">'</span>     <span class="sh_symbol">);</span></pre>

<p>See also, the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_url_range($row1,_$col1,_$row2,_$col2,_$url,_$string,_$format)">write_url_range($row1, $col1, $row2, $col2, $url, $string, $format)</a></h2>

<p>This method is essentially the same as the <code>write_url()</code> method described above. The main difference is that you can specify a link for a range of cells:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_string">'</span><a href="ftp://www.perl.org/" class="podlinkurl"><span class="sh_string">ftp://www.perl.org/</span></a><span class="sh_string">'</span>              <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_string">'</span><a href="http://www.perl.com/" class="podlinkurl"><span class="sh_string">http://www.perl.com/</span></a><span class="sh_string">'</span><span class="sh_symbol">,</span> <span class="sh_string">'Perl home'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A3:D3'</span><span class="sh_symbol">,</span>    <span class="sh_string">'internal:Sheet2!A1'</span>               <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_url</span><span class="sh_symbol">(</span><span class="sh_string">'A4:D4'</span><span class="sh_symbol">,</span>    <span class="sh_string">'external:c:\temp\foo.xls'</span>         <span class="sh_symbol">);</span></pre>

<p>This method is generally only required when used in conjunction with merged cells. See the <code>merge_range()</code> method and the <code>merge</code> property of a Format object, <a href="#CELL_FORMATTING" class="podlinkpod">"CELL FORMATTING"</a>.</p>

<p>There is no way to force this behaviour through the <code>write()</code> method.</p>

<p>The parameters <code>$string</code> and the <code>$format</code> are optional and their position is interchangeable. However, they are applied only to the first cell in the range.</p>

<p>See also, the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_formula($row,_$column,_$formula,_$format,_$value)">write_formula($row, $column, $formula, $format, $value)</a></h2>

<p>Write a formula or function to the cell specified by <code>$row</code> and <code>$column</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_formula</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'=$B$3 + B4'</span>  <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_formula</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'=SIN(PI()/4)'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_formula</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'=SUM(B1:B5)'</span> <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_formula</span><span class="sh_symbol">(</span><span class="sh_string">'A4'</span><span class="sh_symbol">,</span> <span class="sh_string">'=IF(A3&gt;1,"Yes", "No")'</span>   <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_formula</span><span class="sh_symbol">(</span><span class="sh_string">'A5'</span><span class="sh_symbol">,</span> <span class="sh_string">'=AVERAGE(1, 2, 3, 4)'</span>    <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_formula</span><span class="sh_symbol">(</span><span class="sh_string">'A6'</span><span class="sh_symbol">,</span> <span class="sh_string">'=DATEVALUE("1-Jan-2001")'</span><span class="sh_symbol">);</span></pre>

<p>See the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a>. For more information about writing Excel formulas see <a href="#FORMULAS_AND_FUNCTIONS_IN_EXCEL" class="podlinkpod">"FORMULAS AND FUNCTIONS IN EXCEL"</a></p>

<p>See also the section "Improving performance when working with formulas" and the <code>store_formula()</code> and <code>repeat_formula()</code> methods.</p>

<p>If required, it is also possible to specify the calculated value of 
the formula. This is occasionally necessary when working with non-Excel 
applications that don't calculate the value of the formula. The 
calculated <code>$value</code> is added at the end of the argument list:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'=2+2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_number">4</span><span class="sh_symbol">);</span></pre>

<p>However, this probably isn't something that will ever need to do. If you do use this feature then do so with care.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="store_formula($formula)">store_formula($formula)</a></h2>

<p>The <code>store_formula()</code> method is used in conjunction with <code>repeat_formula()</code> to speed up the generation of repeated formulas. See "Improving performance when working with formulas" in <a href="#FORMULAS_AND_FUNCTIONS_IN_EXCEL" class="podlinkpod">"FORMULAS AND FUNCTIONS IN EXCEL"</a>.</p>

<p>The <code>store_formula()</code> method pre-parses a textual representation of a formula and stores it for use at a later stage by the <code>repeat_formula()</code> method.</p>

<p><code>store_formula()</code> carries the same speed penalty as <code>write_formula()</code>. However, in practice it will be used less frequently.</p>

<p>The return value of this method is a scalar that can be thought of as a reference to a formula.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$sin</span> <span class="sh_symbol">=</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">store_formula</span><span class="sh_symbol">(</span><span class="sh_string">'=SIN(A1)'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$cos</span> <span class="sh_symbol">=</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">store_formula</span><span class="sh_symbol">(</span><span class="sh_string">'=COS(A1)'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$sin</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'A2'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'C1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$cos</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'A2'</span><span class="sh_symbol">);</span></pre>

<p>Although <code>store_formula()</code> is a worksheet method the return value can be used in any worksheet:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$now</span> <span class="sh_symbol">=</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">store_formula</span><span class="sh_symbol">(</span><span class="sh_string">'=NOW()'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$now</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$now</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet3</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$now</span><span class="sh_symbol">);</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="repeat_formula($row,_$col,_$formula,_$format,_($pattern_=&gt;_$replace,_...))">repeat_formula($row, $col, $formula, $format, ($pattern =&gt; $replace, ...))</a></h2>

<p>The <code>repeat_formula()</code> method is used in conjunction with <code>store_formula()</code> to speed up the generation of repeated formulas. See "Improving performance when working with formulas" in <a href="#FORMULAS_AND_FUNCTIONS_IN_EXCEL" class="podlinkpod">"FORMULAS AND FUNCTIONS IN EXCEL"</a>.</p>

<p>In many respects <code>repeat_formula()</code> behaves like <code>write_formula()</code> except that it is significantly faster.</p>

<p>The <code>repeat_formula()</code> method creates a new formula based on the pre-parsed tokens returned by <code>store_formula()</code>. The new formula is generated by substituting <code>$pattern</code>, <code>$replace</code> pairs in the stored formula:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$formula</span> <span class="sh_symbol">=</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">store_formula</span><span class="sh_symbol">(</span><span class="sh_string">'=A1 * 3 + 50'</span><span class="sh_symbol">);</span>

    <span class="sh_keyword">for</span> <span class="sh_keyword">my</span> <span class="sh_variable">$row</span> <span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">..</span><span class="sh_number">99</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_variable">$row</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_variable">$formula</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'A'</span><span class="sh_symbol">.(</span><span class="sh_variable">$row</span> <span class="sh_symbol">+</span><span class="sh_number">1</span><span class="sh_symbol">));</span>
    <span class="sh_cbracket">}</span></pre>

<p>It should be noted that <code>repeat_formula()</code> doesn't modify the tokens. In the above example the substitution is always made against the original token, <code>A1</code>, which doesn't change.</p>

<p>As usual, you can use <code>undef</code> if you don't wish to specify a <code>$format</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$formula</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'A2'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B3'</span><span class="sh_symbol">,</span> <span class="sh_variable">$formula</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span>   <span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'A3'</span><span class="sh_symbol">);</span></pre>

<p>The substitutions are made from left to right and you can use as many <code>$pattern</code>, <code>$replace</code> pairs as you need. However, each substitution is made only once:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$formula</span> <span class="sh_symbol">=</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">store_formula</span><span class="sh_symbol">(</span><span class="sh_string">'=A1 + A1'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Gives '=B1 + A1'</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$formula</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'B1'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Gives '=B1 + B1'</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$formula</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'B1'</span><span class="sh_symbol">)</span> <span class="sh_keyword">x</span> <span class="sh_number">2</span><span class="sh_symbol">);</span></pre>

<p>Since the <code>$pattern</code> is interpolated each time that it is used it is worth using the <code>qr</code> operator to quote the pattern. The <code>qr</code> operator is explained in the <code>perlop</code> man page.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$formula</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_keyword">qr</span><span class="sh_regexp">/A1/</span><span class="sh_symbol">,</span> <span class="sh_string">'A2'</span><span class="sh_symbol">);</span></pre>

<p>Care should be taken with the values that are substituted. The formula returned by <code>repeat_formula()</code>
 contains several other tokens in addition to those in the formula and 
these might also match the pattern that you are trying to replace. In 
particular you should avoid substituting a single 0, 1, 2 or 3.</p>

<p>You should also be careful to avoid false matches. For example the 
following snippet is meant to change the stored formula in steps from <code>=A1 + SIN(A1)</code> to <code>=A10 + SIN(A10)</code>.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$formula</span> <span class="sh_symbol">=</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">store_formula</span><span class="sh_symbol">(</span><span class="sh_string">'=A1 + SIN(A1)'</span><span class="sh_symbol">);</span>

    <span class="sh_keyword">for</span> <span class="sh_keyword">my</span> <span class="sh_variable">$row</span> <span class="sh_symbol">(</span><span class="sh_number">1</span> <span class="sh_symbol">..</span> <span class="sh_number">10</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_variable">$row</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_variable">$formula</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span>
                                    <span class="sh_keyword">qw</span><span class="sh_string">/A1/</span><span class="sh_symbol">,</span> <span class="sh_string">'A'</span> <span class="sh_symbol">.</span> <span class="sh_variable">$row</span><span class="sh_symbol">,</span>   <span class="sh_comment">#! Bad.</span>
                                    <span class="sh_keyword">qw</span><span class="sh_string">/A1/</span><span class="sh_symbol">,</span> <span class="sh_string">'A'</span> <span class="sh_symbol">.</span> <span class="sh_variable">$row</span>    <span class="sh_comment">#! Bad.</span>
                                  <span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span></pre>

<p>However it contains a bug. In the last iteration of the loop when <code>$row</code> is 10 the following substitutions will occur:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">s</span><span class="sh_regexp">/A1/A10/</span><span class="sh_symbol">;</span>    changes    <span class="sh_symbol">=</span>A1 <span class="sh_symbol">+</span> <span class="sh_function">SIN</span><span class="sh_symbol">(</span>A1<span class="sh_symbol">)</span>     to    <span class="sh_symbol">=</span>A10 <span class="sh_symbol">+</span> <span class="sh_function">SIN</span><span class="sh_symbol">(</span>A1<span class="sh_symbol">)</span>
    <span class="sh_keyword">s</span><span class="sh_regexp">/A1/A10/</span><span class="sh_symbol">;</span>    changes    <span class="sh_symbol">=</span>A10 <span class="sh_symbol">+</span> <span class="sh_function">SIN</span><span class="sh_symbol">(</span>A1<span class="sh_symbol">)</span>    to    <span class="sh_symbol">=</span>A100 <span class="sh_symbol">+</span> <span class="sh_function">SIN</span><span class="sh_symbol">(</span>A1<span class="sh_symbol">)</span> <span class="sh_comment"># !!</span></pre>

<p>The solution in this case is to use a more explicit match such as <code>qw/^A1$/</code>:</p>

<pre class="sh_perl sh_sourceCode">        <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_variable">$row</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_variable">$formula</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span>
                                    <span class="sh_keyword">qw</span><span class="sh_string">/^A1$/</span><span class="sh_symbol">,</span> <span class="sh_string">'A'</span> <span class="sh_symbol">.</span> <span class="sh_variable">$row</span><span class="sh_symbol">,</span>
                                    <span class="sh_keyword">qw</span><span class="sh_string">/^A1$/</span><span class="sh_symbol">,</span> <span class="sh_string">'A'</span> <span class="sh_symbol">.</span> <span class="sh_variable">$row</span>
                                  <span class="sh_symbol">);</span></pre>

<p>Another similar problem occurs due to the fact that substitutions are
 made in order. For example the following snippet is meant to change the
 stored formula from <code>=A10 + A11</code> to <code>=A11 + A12</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$formula</span> <span class="sh_symbol">=</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">store_formula</span><span class="sh_symbol">(</span><span class="sh_string">'=A10 + A11'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$formula</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span>
                                <span class="sh_keyword">qw</span><span class="sh_string">/A10/</span><span class="sh_symbol">,</span> <span class="sh_string">'A11'</span><span class="sh_symbol">,</span>   <span class="sh_comment">#! Bad.</span>
                                <span class="sh_keyword">qw</span><span class="sh_string">/A11/</span><span class="sh_symbol">,</span> <span class="sh_string">'A12'</span>    <span class="sh_comment">#! Bad.</span>
                              <span class="sh_symbol">);</span></pre>

<p>However, the actual substitution yields <code>=A12 + A11</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">s</span><span class="sh_regexp">/A10/A11/</span><span class="sh_symbol">;</span>    changes    <span class="sh_symbol">=</span>A10 <span class="sh_symbol">+</span> A11    to    <span class="sh_symbol">=</span>A11 <span class="sh_symbol">+</span> A11
    <span class="sh_keyword">s</span><span class="sh_regexp">/A11/A12/</span><span class="sh_symbol">;</span>    changes    <span class="sh_symbol">=</span>A11 <span class="sh_symbol">+</span> A11    to    <span class="sh_symbol">=</span>A12 <span class="sh_symbol">+</span> A11 <span class="sh_comment"># !!</span></pre>

<p>The solution here would be to reverse the order of the substitutions 
or to start with a stored formula that won't yield a false match such as
 <code>=X10 + Y11</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$formula</span> <span class="sh_symbol">=</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">store_formula</span><span class="sh_symbol">(</span><span class="sh_string">'=X10 + Y11'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$formula</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span>
                                <span class="sh_keyword">qw</span><span class="sh_string">/X10/</span><span class="sh_symbol">,</span> <span class="sh_string">'A11'</span><span class="sh_symbol">,</span>
                                <span class="sh_keyword">qw</span><span class="sh_string">/Y11/</span><span class="sh_symbol">,</span> <span class="sh_string">'A12'</span>
                              <span class="sh_symbol">);</span></pre>

<p>If you think that you have a problem related to a false match you can
 check the tokens that you are substituting against as follows.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$formula</span> <span class="sh_symbol">=</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">store_formula</span><span class="sh_symbol">(</span><span class="sh_string">'=A1*5+4'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">print</span> <span class="sh_string">"@$formula\n"</span><span class="sh_symbol">;</span></pre>

<p>See also the <code>repeat.pl</code> program in the <code>examples</code> directory of the distro.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="write_comment($row,_$column,_$string,_...)">write_comment($row, $column, $string, ...)</a></h2>

<p>The <code>write_comment()</code> method is used to add a comment to a
 cell. A cell comment is indicated in Excel by a small red triangle in 
the upper right-hand corner of the cell. Moving the cursor over the red 
triangle will reveal the comment.</p>

<p>The following example shows how to add a comment to a cell:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span>        <span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_string">'This is a comment.'</span><span class="sh_symbol">);</span></pre>

<p>As usual you can replace the <code>$row</code> and <code>$column</code> parameters with an <code>A1</code> cell reference. See the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a>.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span>        <span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'This is a comment.'</span><span class="sh_symbol">);</span></pre>

<p>On systems with <code>perl 5.8</code> and later the <code>write_comment()</code> method will also handle strings in <code>UTF-8</code> format.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">"\x{263a}"</span><span class="sh_symbol">);</span>       <span class="sh_comment"># Smiley</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C4'</span><span class="sh_symbol">,</span> <span class="sh_string">'Comment ca va?'</span><span class="sh_symbol">);</span></pre>

<p>In addition to the basic 3 argument form of <code>write_comment()</code> you can pass in several optional key/value pairs to control the format of the comment. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> visible <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> author <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Perl'</span><span class="sh_symbol">);</span></pre>

<p>Most of these options are quite specific and in general the default 
comment behaviour will be all that you need. However, should you need 
greater control over the format of the cell comment the following 
options are available:</p>

<pre class="sh_perl sh_sourceCode">    encoding
    author
    author_encoding
    visible
    x_scale
    width
    y_scale
    height
    color
    start_cell
    start_row
    start_col
    x_offset
    y_offset</pre>

<dl>
<dt><a name="Option"></a><a name="Option:_encoding">Option: encoding</a></dt>

<dd>
<p>This option is used to indicate that the comment string is encoded as <code>UTF-16BE</code>.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$comment</span> <span class="sh_symbol">=</span> <span class="sh_keyword">pack</span> <span class="sh_string">'n'</span><span class="sh_symbol">,</span> <span class="sh_number">0x263a</span><span class="sh_symbol">;</span> <span class="sh_comment"># UTF-16BE Smiley symbol</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_variable">$comment</span><span class="sh_symbol">,</span> encoding <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>If you wish to use Unicode characters in the comment string then the preferred method is to use perl 5.8 and <code>UTF-8</code> strings, see <a href="#UNICODE_IN_EXCEL" class="podlinkpod">"UNICODE IN EXCEL"</a>.</p>

</dd><dt><a name="Option"></a><a name="Option:_author">Option: author</a></dt>

<dd>
<p>This option is used to indicate who the author of the comment is. 
Excel displays the author of the comment in the status bar at the bottom
 of the worksheet. This is usually of interest in corporate environments
 where several people might review and provide comments to a workbook.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Atonement'</span><span class="sh_symbol">,</span> author <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Ian McEwan'</span><span class="sh_symbol">);</span></pre>

</dd><dt><a name="Option"></a><a name="Option:_author_encoding">Option: author_encoding</a></dt>

<dd>
<p>This option is used to indicate that the author string is encoded as <code>UTF-16BE</code>.</p>

</dd><dt><a name="Option"></a><a name="Option:_visible">Option: visible</a></dt>

<dd>
<p>This option is used to make a cell comment visible when the worksheet
 is opened. The default behaviour in Excel is that comments are 
initially hidden. However, it is also possible in Excel to make 
individual or all comments visible. In Spreadsheet::WriteExcel 
individual comments can be made visible as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> visible <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>It is possible to make all comments in a worksheet visible using the <code>show_comments()</code>
 worksheet method (see below). Alternatively, if all of the cell 
comments have been made visible you can hide individual comments:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> visible <span class="sh_symbol">=&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">);</span></pre>

</dd><dt><a name="Option"></a><a name="Option:_x_scale">Option: x_scale</a></dt>

<dd>
<p>This option is used to set the width of the cell comment box as a factor of the default width.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> x_scale <span class="sh_symbol">=&gt;</span> <span class="sh_number">2</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C4'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> x_scale <span class="sh_symbol">=&gt;</span> <span class="sh_number">4.2</span><span class="sh_symbol">);</span></pre>

</dd><dt><a name="Option"></a><a name="Option:_width">Option: width</a></dt>

<dd>
<p>This option is used to set the width of the cell comment box explicitly in pixels.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> width <span class="sh_symbol">=&gt;</span> <span class="sh_number">200</span><span class="sh_symbol">);</span></pre>

</dd><dt><a name="Option"></a><a name="Option:_y_scale">Option: y_scale</a></dt>

<dd>
<p>This option is used to set the height of the cell comment box as a factor of the default height.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> y_scale <span class="sh_symbol">=&gt;</span> <span class="sh_number">2</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C4'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> y_scale <span class="sh_symbol">=&gt;</span> <span class="sh_number">4.2</span><span class="sh_symbol">);</span></pre>

</dd><dt><a name="Option"></a><a name="Option:_height">Option: height</a></dt>

<dd>
<p>This option is used to set the height of the cell comment box explicitly in pixels.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> height <span class="sh_symbol">=&gt;</span> <span class="sh_number">200</span><span class="sh_symbol">);</span></pre>

</dd><dt><a name="Option"></a><a name="Option:_color">Option: color</a></dt>

<dd>
<p>This option is used to set the background colour of cell comment box.
 You can use one of the named colours recognised by 
Spreadsheet::WriteExcel or a colour index. See <a href="#COLOURS_IN_EXCEL" class="podlinkpod">"COLOURS IN EXCEL"</a>.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> color <span class="sh_symbol">=&gt;</span> <span class="sh_string">'green'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C4'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> color <span class="sh_symbol">=&gt;</span> <span class="sh_number">0x35</span><span class="sh_symbol">);</span>    <span class="sh_comment"># Orange</span></pre>

</dd><dt><a name="Option"></a><a name="Option:_start_cell">Option: start_cell</a></dt>

<dd>
<p>This option is used to set the cell in which the comment will appear.
 By default Excel displays comments one cell to the right and one cell 
above the cell to which the comment relates. However, you can change 
this behaviour if you wish. In the following example the comment which 
would appear by default in cell <code>D2</code> is moved to <code>E2</code>.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> start_cell <span class="sh_symbol">=&gt;</span> <span class="sh_string">'E2'</span><span class="sh_symbol">);</span></pre>

</dd><dt><a name="Option"></a><a name="Option:_start_row">Option: start_row</a></dt>

<dd>
<p>This option is used to set the row in which the comment will appear. See the <code>start_cell</code> option above. The row is zero indexed.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> start_row <span class="sh_symbol">=&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">);</span></pre>

</dd><dt><a name="Option"></a><a name="Option:_start_col">Option: start_col</a></dt>

<dd>
<p>This option is used to set the column in which the comment will appear. See the <code>start_cell</code> option above. The column is zero indexed.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> start_col <span class="sh_symbol">=&gt;</span> <span class="sh_number">4</span><span class="sh_symbol">);</span></pre>

</dd><dt><a name="Option"></a><a name="Option:_x_offset">Option: x_offset</a></dt>

<dd>
<p>This option is used to change the x offset, in pixels, of a comment within a cell:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_variable">$comment</span><span class="sh_symbol">,</span> x_offset <span class="sh_symbol">=&gt;</span> <span class="sh_number">30</span><span class="sh_symbol">);</span></pre>

</dd><dt><a name="Option"></a><a name="Option:_y_offset">Option: y_offset</a></dt>

<dd>
<p>This option is used to change the y offset, in pixels, of a comment within a cell:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_variable">$comment</span><span class="sh_symbol">,</span> x_offset <span class="sh_symbol">=&gt;</span> <span class="sh_number">30</span><span class="sh_symbol">);</span></pre>
</dd>
</dl>

<p>You can apply as many of these options as you require.</p>

<p>See also <a href="#ROW_HEIGHTS_AND_WORKSHEET_OBJECTS" class="podlinkpod">"ROW HEIGHTS AND WORKSHEET OBJECTS"</a>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="show_comments()">show_comments()</a></h2>

<p>This method is used to make all cell comments visible when a worksheet is opened.</p>

<p>Individual comments can be made visible using the <code>visible</code> parameter of the <code>write_comment</code> method (see above):</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> visible <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>If all of the cell comments have been made visible you can hide individual comments as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_comment</span><span class="sh_symbol">(</span><span class="sh_string">'C3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> visible <span class="sh_symbol">=&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">);</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="add_write_handler($re,_$code_ref)">add_write_handler($re, $code_ref)</a></h2>

<p>This method is used to extend the Spreadsheet::WriteExcel write() method to handle user defined data.</p>

<p>If you refer to the section on <code>write()</code> above you will see that it acts as an alias for several more specific <code>write_*</code> methods. However, it doesn't always act in exactly the way that you would like it to.</p>

<p>One solution is to filter the input data yourself and call the appropriate <code>write_*</code> method. Another approach is to use the <code>add_write_handler()</code> method to add your own automated behaviour to <code>write()</code>.</p>

<p>The <code>add_write_handler()</code> method take two arguments, <code>$re</code>, a regular expression to match incoming data and <code>$code_ref</code> a callback function to handle the matched data:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_write_handler</span><span class="sh_symbol">(</span><span class="sh_keyword">qr</span><span class="sh_regexp">/^\d\d\d\d$/</span><span class="sh_symbol">,</span> <span class="sh_symbol">\&amp;</span>my_write<span class="sh_symbol">);</span></pre>

<p>(In the these examples the <code>qr</code> operator is used to quote the regular expression strings, see <a href="http://search.cpan.org/perldoc?perlop" class="podlinkpod">perlop</a> for more details).</p>

<p>The method is used as follows. say you wished to write 7 digit ID 
numbers as a string so that any leading zeros were preserved*, you could
 do something like the following:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_write_handler</span><span class="sh_symbol">(</span><span class="sh_keyword">qr</span><span class="sh_regexp">/^\d{7}$/</span><span class="sh_symbol">,</span> <span class="sh_symbol">\&amp;</span>write_my_id<span class="sh_symbol">);</span>


    <span class="sh_keyword">sub</span> write_my_id <span class="sh_cbracket">{</span>
        <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_keyword">shift</span><span class="sh_symbol">;</span>
        <span class="sh_keyword">return</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_string</span><span class="sh_symbol">(</span><span class="sh_variable">@_</span><span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span></pre>

<p>* You could also use the <code>keep_leading_zeros()</code> method for this.</p>

<p>Then if you call <code>write()</code> with an appropriate string it will be handled automatically:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># Writes 0000000. It would normally be written as a number; 0.</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'0000000'</span><span class="sh_symbol">);</span></pre>

<p>The callback function will receive a reference to the calling worksheet and all of the other arguments that were passed to <code>write()</code>. The callback will see an <code>@_</code> argument list that looks like the following:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$_</span><span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span>   A <span class="sh_keyword">ref</span> to the calling worksheet<span class="sh_symbol">.</span> <span class="sh_symbol">*</span>
    <span class="sh_variable">$_</span><span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span>   Zero based row number<span class="sh_symbol">.</span>
    <span class="sh_variable">$_</span><span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]</span>   Zero based column number<span class="sh_symbol">.</span>
    <span class="sh_variable">$_</span><span class="sh_symbol">[</span><span class="sh_number">3</span><span class="sh_symbol">]</span>   A number or string or token<span class="sh_symbol">.</span>
    <span class="sh_variable">$_</span><span class="sh_symbol">[</span><span class="sh_number">4</span><span class="sh_symbol">]</span>   A <span class="sh_keyword">format</span> <span class="sh_keyword">ref</span> <span class="sh_keyword">if</span> any<span class="sh_symbol">.</span>
    <span class="sh_variable">$_</span><span class="sh_symbol">[</span><span class="sh_number">5</span><span class="sh_symbol">]</span>   Any other arguments<span class="sh_symbol">.</span>
    <span class="sh_symbol">...</span>

    <span class="sh_symbol">*</span>  It is good style to <span class="sh_keyword">shift</span> this off the list so the <span class="sh_variable">@_</span> is the same
       as the argument list seen by <span class="sh_keyword">write</span><span class="sh_symbol">().</span></pre>

<p>Your callback should <code>return()</code> the return value of the <code>write_*</code> method that was called or <code>undef</code> to indicate that you rejected the match and want <code>write()</code> to continue as normal.</p>

<p>So for example if you wished to apply the previous filter only to ID 
values that occur in the first column you could modify your callback 
function as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">sub</span> write_my_id <span class="sh_cbracket">{</span>
        <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_keyword">shift</span><span class="sh_symbol">;</span>
        <span class="sh_keyword">my</span> <span class="sh_variable">$col</span>       <span class="sh_symbol">=</span> <span class="sh_variable">$_</span><span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">];</span>

        <span class="sh_keyword">if</span> <span class="sh_symbol">(</span><span class="sh_variable">$col</span> <span class="sh_symbol">==</span> <span class="sh_number">0</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
            <span class="sh_keyword">return</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_string</span><span class="sh_symbol">(</span><span class="sh_variable">@_</span><span class="sh_symbol">);</span>
        <span class="sh_cbracket">}</span>
        <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
            <span class="sh_comment"># Reject the match and return control to write()</span>
            <span class="sh_keyword">return</span> <span class="sh_keyword">undef</span><span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span></pre>

<p>Now, you will get different behaviour for the first column and other columns:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'0000000'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Writes 0000000</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'B1'</span><span class="sh_symbol">,</span> <span class="sh_string">'0000000'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Writes 0</span></pre>

<p>You may add more than one handler in which case they will be called in the order that they were added.</p>

<p>Note, the <code>add_write_handler()</code> method is particularly suited for handling dates.</p>

<p>See the <code>write_handler 1-4</code> programs in the <code>examples</code> directory for further examples.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="insert_image($row,_$col,_$filename,_$x,_$y,_$scale_x,_$scale_y)">insert_image($row, $col, $filename, $x, $y, $scale_x, $scale_y)</a></h2>

<p>This method can be used to insert a image into a worksheet. The image can be in PNG, JPEG or BMP format. The <code>$x</code>, <code>$y</code>, <code>$scale_x</code> and <code>$scale_y</code> parameters are optional.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">insert_image</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'perl.bmp'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">insert_image</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'../images/perl.bmp'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet3</span><span class="sh_symbol">-&gt;</span><span class="sh_function">insert_image</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'.c:\images\perl.bmp'</span><span class="sh_symbol">);</span></pre>

<p>The parameters <code>$x</code> and <code>$y</code> can be used to specify an offset from the top left hand corner of the cell specified by <code>$row</code> and <code>$col</code>. The offset values are in pixels.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">insert_image</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'perl.bmp'</span><span class="sh_symbol">,</span> <span class="sh_number">32</span><span class="sh_symbol">,</span> <span class="sh_number">10</span><span class="sh_symbol">);</span></pre>

<p>The default width of a cell is 63 pixels. The default height of a 
cell is 17 pixels. The pixels offsets can be calculated using the 
following relationships:</p>

<pre class="sh_perl sh_sourceCode">    Wp <span class="sh_symbol">=</span> <span class="sh_keyword">int</span><span class="sh_symbol">(</span>12We<span class="sh_symbol">)</span>   <span class="sh_keyword">if</span> We <span class="sh_string">&lt;  1</span>
    Wp <span class="sh_symbol">=</span> <span class="sh_keyword">int</span><span class="sh_symbol">(</span>7We <span class="sh_symbol">+</span><span class="sh_number">5</span><span class="sh_symbol">)</span> <span class="sh_keyword">if</span> We <span class="sh_symbol">&gt;=</span> <span class="sh_number">1</span>
    Hp <span class="sh_symbol">=</span> <span class="sh_keyword">int</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">/</span>3He<span class="sh_symbol">)</span>

    where<span class="sh_symbol">:</span>
    We is the cell width in Excels units
    Wp is width in pixels
    He is the cell height in Excels units
    Hp is height in pixels</pre>

<p>The offsets can be greater than the width or height of the underlying
 cell. This can be occasionally useful if you wish to align two or more 
images relative to the same cell.</p>

<p>The parameters <code>$scale_x</code> and <code>$scale_y</code> can be used to scale the inserted image horizontally and vertically:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># Scale the inserted image: width x 2.0, height x 0.8</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">insert_image</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'perl.bmp'</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">0.8</span><span class="sh_symbol">);</span></pre>

<p>See also the <code>images.pl</code> program in the <code>examples</code> directory of the distro.</p>

<p>BMP images must be 24 bit, true colour, bitmaps. In general it is 
best to avoid BMP images since they aren't compressed. The older <code>insert_bitmap()</code> method is still supported but deprecated.</p>

<p>See also <a href="#ROW_HEIGHTS_AND_WORKSHEET_OBJECTS" class="podlinkpod">"ROW HEIGHTS AND WORKSHEET OBJECTS"</a>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="insert_chart($row,_$col,_$chart,_$x,_$y,_$scale_x,_$scale_y)">insert_chart($row, $col, $chart, $x, $y, $scale_x, $scale_y)</a></h2>

<p>This method can be used to insert a Chart object into a worksheet. The Chart must be created by the <code>add_chart()</code> Workbook method and it must have the <code>embedded</code> option set.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$chart</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_chart</span><span class="sh_symbol">(</span> type <span class="sh_symbol">=&gt;</span> <span class="sh_string">'line'</span><span class="sh_symbol">,</span> embedded <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span> <span class="sh_symbol">);</span>

    <span class="sh_comment"># Configure the chart.</span>
    <span class="sh_symbol">...</span>

    <span class="sh_comment"># Insert the chart into the a worksheet.</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">insert_chart</span><span class="sh_symbol">(</span><span class="sh_string">'E2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$chart</span><span class="sh_symbol">);</span></pre>

<p>See <code>add_chart()</code> for details on how to create the Chart object and <a href="http://search.cpan.org/%7Ejmcnamara/Spreadsheet-WriteExcel-2.38/lib/Spreadsheet/WriteExcel/Chart.pm" class="podlinkpod">Spreadsheet::WriteExcel::Chart</a> for details on how to configure it. See also the <code>chart_*.pl</code> programs in the examples directory of the distro.</p>

<p>The <code>$x</code>, <code>$y</code>, <code>$scale_x</code> and <code>$scale_y</code> parameters are optional.</p>

<p>The parameters <code>$x</code> and <code>$y</code> can be used to specify an offset from the top left hand corner of the cell specified by <code>$row</code> and <code>$col</code>. The offset values are in pixels. See the <code>insert_image</code> method above for more information on sizes.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">insert_chart</span><span class="sh_symbol">(</span><span class="sh_string">'E2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$chart</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">);</span></pre>

<p>The parameters <code>$scale_x</code> and <code>$scale_y</code> can be used to scale the inserted image horizontally and vertically:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># Scale the width by 120% and the height by 150%</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">insert_chart</span><span class="sh_symbol">(</span><span class="sh_string">'E2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$chart</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1.2</span><span class="sh_symbol">,</span> <span class="sh_number">1.5</span><span class="sh_symbol">);</span></pre>

<p>The easiest way to calculate the required scaling is to create a test
 chart worksheet with Spreadsheet::WriteExcel. Then open the file, 
select the chart and drag the corner to get the required size. While 
holding down the mouse the scale of the resized chart is shown to the 
left of the formula bar.</p>

<p>See also <a href="#ROW_HEIGHTS_AND_WORKSHEET_OBJECTS" class="podlinkpod">"ROW HEIGHTS AND WORKSHEET OBJECTS"</a>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="embed_chart($row,_$col,_$filename,_$x,_$y,_$scale_x,_$scale_y)">embed_chart($row, $col, $filename, $x, $y, $scale_x, $scale_y)</a></h2>

<p>This method can be used to insert a externally generated chart into a
 worksheet. The chart must first be extracted from an existing Excel 
file. This feature is semi-deprecated in favour of the "native" charts 
created using <code>add_chart()</code>. Read <code>external_charts.txt</code> (or <code>.pod</code>) in the external_charts directory of the distro for a full explanation.</p>

<p>Here is an example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">embed_chart</span><span class="sh_symbol">(</span><span class="sh_string">'B2'</span><span class="sh_symbol">,</span> <span class="sh_string">'sales_chart.bin'</span><span class="sh_symbol">);</span></pre>

<p>The <code>$x</code>, <code>$y</code>, <code>$scale_x</code> and <code>$scale_y</code> parameters are optional. See <code>insert_chart()</code> above for details.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="data_validation()">data_validation()</a></h2>

<p>The <code>data_validation()</code> method is used to construct an Excel data validation or to limit the user input to a dropdown list of values.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'B3'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">{</span>
            validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
            criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span>
            value    <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'B5:B9'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">{</span>
            validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'list'</span><span class="sh_symbol">,</span>
            value    <span class="sh_symbol">=&gt;</span> <span class="sh_symbol">[</span><span class="sh_string">'open'</span><span class="sh_symbol">,</span> <span class="sh_string">'high'</span><span class="sh_symbol">,</span> <span class="sh_string">'close'</span><span class="sh_symbol">],</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<p>This method contains a lot of parameters and is described in detail in a separate section <a href="#DATA_VALIDATION_IN_EXCEL" class="podlinkpod">"DATA VALIDATION IN EXCEL"</a>.</p>

<p>See also the <code>data_validate.pl</code> program in the examples directory of the distro</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="get_name()">get_name()</a></h2>

<p>The <code>get_name()</code> method is used to retrieve the name of a worksheet. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">foreach</span> <span class="sh_keyword">my</span> <span class="sh_variable">$sheet</span> <span class="sh_symbol">(</span><span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">sheets</span><span class="sh_symbol">())</span> <span class="sh_cbracket">{</span>
        <span class="sh_keyword">print</span> <span class="sh_variable">$sheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">get_name</span><span class="sh_symbol">();</span>
    <span class="sh_cbracket">}</span></pre>

<p>For reasons related to the design of Spreadsheet::WriteExcel and to the internals of Excel there is no <code>set_name()</code> method. The only way to set the worksheet name is via the <code>add_worksheet()</code> method.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="activate()">activate()</a></h2>

<p>The <code>activate()</code> method is used to specify which worksheet is initially visible in a multi-sheet workbook:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_string">'To'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet2</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_string">'the'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet3</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_string">'wind'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet3</span><span class="sh_symbol">-&gt;</span><span class="sh_function">activate</span><span class="sh_symbol">();</span></pre>

<p>This is similar to the Excel VBA activate method. More than one worksheet can be selected via the <code>select()</code> method, see below, however only one worksheet can be active.</p>

<p>The default active worksheet is the first worksheet.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="select()">select()</a></h2>

<p>The <code>select()</code> method is used to indicate that a worksheet is selected in a multi-sheet workbook:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">activate</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">select</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$worksheet3</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">select</span><span class="sh_symbol">();</span></pre>

<p>A selected worksheet has its tab highlighted. Selecting worksheets is
 a way of grouping them together so that, for example, several 
worksheets could be printed in one go. A worksheet that has been 
activated via the <code>activate()</code> method will also appear as selected.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="hide()">hide()</a></h2>

<p>The <code>hide()</code> method is used to hide a worksheet:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">hide</span><span class="sh_symbol">();</span></pre>

<p>You may wish to hide a worksheet in order to avoid confusing a user with intermediate data or calculations.</p>

<p>A hidden worksheet can not be activated or selected so this method is mutually exclusive with the <code>activate()</code> and <code>select()</code>
 methods. In addition, since the first worksheet will default to being 
the active worksheet, you cannot hide the first worksheet without 
activating another sheet:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">activate</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">hide</span><span class="sh_symbol">();</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_first_sheet()">set_first_sheet()</a></h2>

<p>The <code>activate()</code> method determines which worksheet is 
initially selected. However, if there are a large number of worksheets 
the selected worksheet may not appear on the screen. To avoid this you 
can select which is the leftmost visible worksheet using <code>set_first_sheet()</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">..</span><span class="sh_number">20</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span>add_worksheet<span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>

    <span class="sh_variable">$worksheet21</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$worksheet22</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>

    <span class="sh_variable">$worksheet21</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_first_sheet</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$worksheet22</span><span class="sh_symbol">-&gt;</span><span class="sh_function">activate</span><span class="sh_symbol">();</span></pre>

<p>This method is not required very often. The default value is the first worksheet.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="protect($password)">protect($password)</a></h2>

<p>The <code>protect()</code> method is used to protect a worksheet from modification:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">protect</span><span class="sh_symbol">();</span></pre>

<p>It can be turned off in Excel via the <code>Tools-&gt;Protection-&gt;Unprotect Sheet</code> menu command.</p>

<p>The <code>protect()</code> method also has the effect of enabling a cell's <code>locked</code> and <code>hidden</code>
 properties if they have been set. A "locked" cell cannot be edited. A 
"hidden" cell will display the results of a formula but not the formula 
itself. In Excel a cell's locked property is on by default.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># Set some format properties</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$unlocked</span>  <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>locked <span class="sh_symbol">=&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$hidden</span>    <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>hidden <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Enable worksheet protection</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">protect</span><span class="sh_symbol">();</span>

    <span class="sh_comment"># This cell cannot be edited, it is locked by default</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'=1+2'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># This cell can be edited</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span> <span class="sh_string">'=1+2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$unlocked</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># The formula in this cell isn't visible</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A3'</span><span class="sh_symbol">,</span> <span class="sh_string">'=1+2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$hidden</span><span class="sh_symbol">);</span></pre>

<p>See also the <code>set_locked</code> and <code>set_hidden</code> format methods in <a href="#CELL_FORMATTING" class="podlinkpod">"CELL FORMATTING"</a>.</p>

<p>You can optionally add a password to the worksheet protection:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">protect</span><span class="sh_symbol">(</span><span class="sh_string">'drowssap'</span><span class="sh_symbol">);</span></pre>

<p>Note, the worksheet level password in Excel provides very weak 
protection. It does not encrypt your data in any way and it is very easy
 to deactivate. Therefore, do not use the above method if you wish to 
protect sensitive data or calculations. However, before you get worried,
 Excel's own workbook level password protection does provide strong 
encryption in Excel 97+. For technical reasons this will never be 
supported by <code>Spreadsheet::WriteExcel</code>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_selection($first_row,_$first_col,_$last_row,_$last_col)">set_selection($first_row, $first_col, $last_row, $last_col)</a></h2>

<p>This method can be used to specify which cell or cells are selected 
in a worksheet. The most common requirement is to select a single cell, 
in which case <code>$last_row</code> and <code>$last_col</code> can be omitted. The active cell within a selected range is determined by the order in which <code>$first</code> and <code>$last</code> are specified. It is also possible to specify a cell or a range using A1 notation. See the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a>.</p>

<p>Examples:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_selection</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">);</span>       <span class="sh_comment"># 1. Cell D4.</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_selection</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">6</span><span class="sh_symbol">,</span> <span class="sh_number">6</span><span class="sh_symbol">);</span> <span class="sh_comment"># 2. Cells D4 to G7.</span>
    <span class="sh_variable">$worksheet3</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_selection</span><span class="sh_symbol">(</span><span class="sh_number">6</span><span class="sh_symbol">,</span> <span class="sh_number">6</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">);</span> <span class="sh_comment"># 3. Cells G7 to D4.</span>
    <span class="sh_variable">$worksheet4</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_selection</span><span class="sh_symbol">(</span><span class="sh_string">'D4'</span><span class="sh_symbol">);</span>       <span class="sh_comment"># Same as 1.</span>
    <span class="sh_variable">$worksheet5</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_selection</span><span class="sh_symbol">(</span><span class="sh_string">'D4:G7'</span><span class="sh_symbol">);</span>    <span class="sh_comment"># Same as 2.</span>
    <span class="sh_variable">$worksheet6</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_selection</span><span class="sh_symbol">(</span><span class="sh_string">'G7:D4'</span><span class="sh_symbol">);</span>    <span class="sh_comment"># Same as 3.</span></pre>

<p>The default cell selections is (0, 0), 'A1'.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_row($row,_$height,_$format,_$hidden,_$level,_$collapsed)">set_row($row, $height, $format, $hidden, $level, $collapsed)</a></h2>

<p>This method can be used to change the default properties of a row. All parameters apart from <code>$row</code> are optional.</p>

<p>The most common use for this method is to change the height of a row:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">20</span><span class="sh_symbol">);</span> <span class="sh_comment"># Row 1 height set to 20</span></pre>

<p>If you wish to set the format without changing the height you can pass <code>undef</code> as the height parameter:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>The <code>$format</code> parameter will be applied to any cells in the row that don't have a format. For example</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_variable">$format1</span><span class="sh_symbol">);</span>    <span class="sh_comment"># Set the format for row 1</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">);</span>           <span class="sh_comment"># Defaults to $format1</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'B1'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format2</span><span class="sh_symbol">);</span> <span class="sh_comment"># Keeps $format2</span></pre>

<p>If you wish to define a row format in this way you should call the method before any calls to <code>write()</code>. Calling it afterwards will overwrite any format that was previously specified.</p>

<p>The <code>$hidden</code> parameter should be set to 1 if you wish to 
hide a row. This can be used, for example, to hide intermediary steps in
 a complicated calculation:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">20</span><span class="sh_symbol">,</span>    <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span>   <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>The <code>$level</code> parameter is used to set the outline level of the row. Outlines are described in <a href="#OUTLINES_AND_GROUPING_IN_EXCEL" class="podlinkpod">"OUTLINES AND GROUPING IN EXCEL"</a>. Adjacent rows with the same outline level are grouped together into a single outline.</p>

<p>The following example sets an outline level of 1 for rows 1 and 2 (zero-indexed):</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>The <code>$hidden</code> parameter can also be used to hide collapsed outlined rows when used in conjunction with the <code>$level</code> parameter.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>For collapsed outlines you should also indicate which row has the collapsed <code>+</code> symbol using the optional <code>$collapsed</code> parameter.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>For a more complete example see the <code>outline.pl</code> and <code>outline_collapsed.pl</code> programs in the examples directory of the distro.</p>

<p>Excel allows up to 7 outline levels. Therefore the <code>$level</code> parameter should be in the range <code>0 &lt;= $level &lt;= 7</code>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_column($first_col,_$last_col,_$width,_$format,_$hidden,_$level,_$collapsed)">set_column($first_col, $last_col, $width, $format, $hidden, $level, $collapsed)</a></h2>

<p>This method can be used to change the default properties of a single column or a range of columns. All parameters apart from <code>$first_col</code> and <code>$last_col</code> are optional.</p>

<p>If <code>set_column()</code> is applied to a single column the value of <code>$first_col</code> and <code>$last_col</code> should be the same. In the case where <code>$last_col</code> is zero it is set to the same value as <code>$first_col</code>.</p>

<p>It is also possible, and generally clearer, to specify a column range
 using the form of A1 notation used for columns. See the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a>.</p>

<p>Examples:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_number">20</span><span class="sh_symbol">);</span> <span class="sh_comment"># Column  A   width set to 20</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span>  <span class="sh_number">30</span><span class="sh_symbol">);</span> <span class="sh_comment"># Columns B-D width set to 30</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'E:E'</span><span class="sh_symbol">,</span> <span class="sh_number">20</span><span class="sh_symbol">);</span> <span class="sh_comment"># Column  E   width set to 20</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'F:H'</span><span class="sh_symbol">,</span> <span class="sh_number">30</span><span class="sh_symbol">);</span> <span class="sh_comment"># Columns F-H width set to 30</span></pre>

<p>The width corresponds to the column width value that is specified in 
Excel. It is approximately equal to the length of a string in the 
default font of Arial 10. Unfortunately, there is no way to specify 
"AutoFit" for a column in the Excel file format. This feature is only 
available at runtime from within Excel.</p>

<p>As usual the <code>$format</code> parameter is optional, for additional information, see <a href="#CELL_FORMATTING" class="podlinkpod">"CELL FORMATTING"</a>. If you wish to set the format without changing the width you can pass <code>undef</code> as the width parameter:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>The <code>$format</code> parameter will be applied to any cells in the column that don't have a format. For example</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'A:A'</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_variable">$format1</span><span class="sh_symbol">);</span> <span class="sh_comment"># Set format for col 1</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">);</span>               <span class="sh_comment"># Defaults to $format1</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format2</span><span class="sh_symbol">);</span>     <span class="sh_comment"># Keeps $format2</span></pre>

<p>If you wish to define a column format in this way you should call the method before any calls to <code>write()</code>. If you call it afterwards it won't have any effect.</p>

<p>A default row format takes precedence over a default column format</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span>        <span class="sh_variable">$format1</span><span class="sh_symbol">);</span> <span class="sh_comment"># Set format for row 1</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'A:A'</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_variable">$format2</span><span class="sh_symbol">);</span> <span class="sh_comment"># Set format for col 1</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">);</span>               <span class="sh_comment"># Defaults to $format1</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello'</span><span class="sh_symbol">);</span>               <span class="sh_comment"># Defaults to $format2</span></pre>

<p>The <code>$hidden</code> parameter should be set to 1 if you wish to 
hide a column. This can be used, for example, to hide intermediary steps
 in a complicated calculation:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'D:D'</span><span class="sh_symbol">,</span> <span class="sh_number">20</span><span class="sh_symbol">,</span>    <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'E:E'</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span>   <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>The <code>$level</code> parameter is used to set the outline level of the column. Outlines are described in <a href="#OUTLINES_AND_GROUPING_IN_EXCEL" class="podlinkpod">"OUTLINES AND GROUPING IN EXCEL"</a>. Adjacent columns with the same outline level are grouped together into a single outline.</p>

<p>The following example sets an outline level of 1 for columns B to G:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'B:G'</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>The <code>$hidden</code> parameter can also be used to hide collapsed outlined columns when used in conjunction with the <code>$level</code> parameter.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'B:G'</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>For collapsed outlines you should also indicate which row has the collapsed <code>+</code> symbol using the optional <code>$collapsed</code> parameter.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'H:H'</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>For a more complete example see the <code>outline.pl</code> and <code>outline_collapsed.pl</code> programs in the examples directory of the distro.</p>

<p>Excel allows up to 7 outline levels. Therefore the <code>$level</code> parameter should be in the range <code>0 &lt;= $level &lt;= 7</code>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="outline_settings($visible,_$symbols_below,_$symbols_right,_$auto_style)">outline_settings($visible, $symbols_below, $symbols_right, $auto_style)</a></h2>

<p>The <code>outline_settings()</code> method is used to control the appearance of outlines in Excel. Outlines are described in <a href="#OUTLINES_AND_GROUPING_IN_EXCEL" class="podlinkpod">"OUTLINES AND GROUPING IN EXCEL"</a>.</p>

<p>The <code>$visible</code> parameter is used to control whether or not
 outlines are visible. Setting this parameter to 0 will cause all 
outlines on the worksheet to be hidden. They can be unhidden in Excel by
 means of the "Show Outline Symbols" command button. The default setting
 is 1 for visible outlines.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">outline_settings</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span></pre>

<p>The <code>$symbols_below</code> parameter is used to control whether 
the row outline symbol will appear above or below the outline level bar.
 The default setting is 1 for symbols to appear below the outline level 
bar.</p>

<p>The <code>symbols_right</code> parameter is used to control whether 
the column outline symbol will appear to the left or the right of the 
outline level bar. The default setting is 1 for symbols to appear to the
 right of the outline level bar.</p>

<p>The <code>$auto_style</code> parameter is used to control whether the
 automatic outline generator in Excel uses automatic styles when 
creating an outline. This has no effect on a file generated by <code>Spreadsheet::WriteExcel</code>
 but it does have an effect on how the worksheet behaves after it is 
created. The default setting is 0 for "Automatic Styles" to be turned 
off.</p>

<p>The default settings for all of these parameters correspond to Excel's default parameters.</p>

<p>The worksheet parameters controlled by <code>outline_settings()</code> are rarely used.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="freeze_panes($row,_$col,_$top_row,_$left_col)">freeze_panes($row, $col, $top_row, $left_col)</a></h2>

<p>This method can be used to divide a worksheet into horizontal or 
vertical regions known as panes and to also "freeze" these panes so that
 the splitter bars are not visible. This is the same as the <code>Window-&gt;Freeze Panes</code> menu command in Excel</p>

<p>The parameters <code>$row</code> and <code>$col</code> are used to 
specify the location of the split. It should be noted that the split is 
specified at the top or left of a cell and that the method uses zero 
based indexing. Therefore to freeze the first row of a worksheet it is 
necessary to specify the split at row 2 (which is 1 as the zero-based 
index). This might lead you to think that you are using a 1 based index 
but this is not the case.</p>

<p>You can set one of the <code>$row</code> and <code>$col</code> parameters as zero if you do not want either a vertical or horizontal split.</p>

<p>Examples:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">freeze_panes</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span> <span class="sh_comment"># Freeze the first row</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">freeze_panes</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Same using A1 notation</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">freeze_panes</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># Freeze the first column</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">freeze_panes</span><span class="sh_symbol">(</span><span class="sh_string">'B1'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Same using A1 notation</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">freeze_panes</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">);</span> <span class="sh_comment"># Freeze first row and first 2 columns</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">freeze_panes</span><span class="sh_symbol">(</span><span class="sh_string">'C2'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Same using A1 notation</span></pre>

<p>The parameters <code>$top_row</code> and <code>$left_col</code> are 
optional. They are used to specify the top-most or left-most visible row
 or column in the scrolling region of the panes. For example to freeze 
the first row and to have the scrolling region begin at row twenty:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">freeze_panes</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">20</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span></pre>

<p>You cannot use A1 notation for the <code>$top_row</code> and <code>$left_col</code> parameters.</p>

<p>See also the <code>panes.pl</code> program in the <code>examples</code> directory of the distribution.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="split_panes($y,_$x,_$top_row,_$left_col)">split_panes($y, $x, $top_row, $left_col)</a></h2>

<p>This method can be used to divide a worksheet into horizontal or 
vertical regions known as panes. This method is different from the <code>freeze_panes()</code> method in that the splits between the panes will be visible to the user and each pane will have its own scroll bars.</p>

<p>The parameters <code>$y</code> and <code>$x</code> are used to specify the vertical and horizontal position of the split. The units for <code>$y</code> and <code>$x</code>
 are the same as those used by Excel to specify row height and column 
width. However, the vertical and horizontal units are different from 
each other. Therefore you must specify the <code>$y</code> and <code>$x</code> parameters in terms of the row heights and column widths that you have set or the default values which are <code>12.75</code> for a row and <code>8.43</code> for a column.</p>

<p>You can set one of the <code>$y</code> and <code>$x</code> parameters as zero if you do not want either a vertical or horizontal split. The parameters <code>$top_row</code> and <code>$left_col</code> are optional. They are used to specify the top-most or left-most visible row or column in the bottom-right pane.</p>

<p>Example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">split_panes</span><span class="sh_symbol">(</span><span class="sh_number">12.75</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>    <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span> <span class="sh_comment"># First row</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">split_panes</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span>     <span class="sh_number">8.43</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># First column</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">split_panes</span><span class="sh_symbol">(</span><span class="sh_number">12.75</span><span class="sh_symbol">,</span> <span class="sh_number">8.43</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># First row and column</span></pre>

<p>You cannot use A1 notation with this method.</p>

<p>See also the <code>freeze_panes()</code> method and the <code>panes.pl</code> program in the <code>examples</code> directory of the distribution.</p>

<p>Note: This <code>split_panes()</code> method was called <code>thaw_panes()</code> in older versions. The older name is still available for backwards compatibility.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="merge_range($first_row,_$first_col,_$last_row,_$last_col,_$token,_$format,_$utf_16_be)">merge_range($first_row, $first_col, $last_row, $last_col, $token, $format, $utf_16_be)</a></h2>

<p>Merging cells can be achieved by setting the <code>merge</code> property of a Format object, see <a href="#CELL_FORMATTING" class="podlinkpod">"CELL FORMATTING"</a>. However, this only allows simple Excel5 style horizontal merging which Excel refers to as "center across selection".</p>

<p>The <code>merge_range()</code> method allows you to do Excel97+ style
 formatting where the cells can contain other types of alignment in 
addition to the merging:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>
                                        border  <span class="sh_symbol">=&gt;</span> <span class="sh_number">6</span><span class="sh_symbol">,</span>
                                        valign  <span class="sh_symbol">=&gt;</span> <span class="sh_string">'vcenter'</span><span class="sh_symbol">,</span>
                                        align   <span class="sh_symbol">=&gt;</span> <span class="sh_string">'center'</span><span class="sh_symbol">,</span>
                                      <span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">merge_range</span><span class="sh_symbol">(</span><span class="sh_string">'B3:D4'</span><span class="sh_symbol">,</span> <span class="sh_string">'Vertical and horizontal'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p><b>WARNING</b>. The format object that is used with a <code>merge_range()</code>
 method call is marked internally as being associated with a merged 
range. It is a fatal error to use a merged format in a non-merged cell. 
Instead you should use separate formats for merged and non-merged cells.
 This restriction will be removed in a future release.</p>

<p>The <code>$utf_16_be</code> parameter is optional, see below.</p>

<p><code>merge_range()</code> writes its <code>$token</code> argument using the worksheet <code>write()</code> method. Therefore it will handle numbers, strings, formulas or urls as required.</p>

<p>Setting the <code>merge</code> property of the format isn't required when you are using <code>merge_range()</code>. In fact using it will exclude the use of any other horizontal alignment option.</p>

<p>On systems with <code>perl 5.8</code> and later the <code>merge_range()</code> method will also handle strings in <code>UTF-8</code> format.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">merge_range</span><span class="sh_symbol">(</span><span class="sh_string">'B3:D4'</span><span class="sh_symbol">,</span> <span class="sh_string">"\x{263a}"</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span> <span class="sh_comment"># Smiley</span></pre>

<p>On earlier Perl systems your can specify <code>UTF-16BE</code> worksheet names using an additional optional parameter:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$str</span> <span class="sh_symbol">=</span> <span class="sh_keyword">pack</span> <span class="sh_string">'n'</span><span class="sh_symbol">,</span> <span class="sh_number">0x263a</span><span class="sh_symbol">;</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">merge_range</span><span class="sh_symbol">(</span><span class="sh_string">'B3:D4'</span><span class="sh_symbol">,</span> <span class="sh_variable">$str</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># Smiley</span></pre>

<p>The full possibilities of this method are shown in the <code>merge3.pl</code> to <code>merge6.pl</code> programs in the <code>examples</code> directory of the distribution.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_zoom($scale)">set_zoom($scale)</a></h2>

<p>Set the worksheet zoom factor in the range <code>10 &lt;= $scale &lt;= 400</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_zoom</span><span class="sh_symbol">(</span><span class="sh_number">50</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_zoom</span><span class="sh_symbol">(</span><span class="sh_number">75</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet3</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_zoom</span><span class="sh_symbol">(</span><span class="sh_number">300</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet4</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_zoom</span><span class="sh_symbol">(</span><span class="sh_number">400</span><span class="sh_symbol">);</span></pre>

<p>The default zoom factor is 100. You cannot zoom to "Selection" because it is calculated by Excel at run-time.</p>

<p>Note, <code>set_zoom()</code> does not affect the scale of the printed page. For that you should use <code>set_print_scale()</code>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="right_to_left()">right_to_left()</a></h2>

<p>The <code>right_to_left()</code> method is used to change the default
 direction of the worksheet from left-to-right, with the A1 cell in the 
top left, to right-to-left, with the he A1 cell in the top right.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">right_to_left</span><span class="sh_symbol">();</span></pre>

<p>This is useful when creating Arabic, Hebrew or other near or far 
eastern worksheets that use right-to-left as the default direction.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="hide_zero()">hide_zero()</a></h2>

<p>The <code>hide_zero()</code> method is used to hide any zero values that appear in cells.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">hide_zero</span><span class="sh_symbol">();</span></pre>

<p>In Excel this option is found under Tools-&gt;Options-&gt;View.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_tab_color()">set_tab_color()</a></h2>

<p>The <code>set_tab_color()</code> method is used to change the colour 
of the worksheet tab. This feature is only available in Excel 2002 and 
later. You can use one of the standard colour names provided by the 
Format object or a colour index. See <a href="#COLOURS_IN_EXCEL" class="podlinkpod">"COLOURS IN EXCEL"</a> and the <code>set_custom_color()</code> method.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_tab_color</span><span class="sh_symbol">(</span><span class="sh_string">'red'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_tab_color</span><span class="sh_symbol">(</span><span class="sh_number">0x0C</span><span class="sh_symbol">);</span></pre>

<p>See the <code>tab_colors.pl</code> program in the examples directory of the distro.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="autofilter($first_row,_$first_col,_$last_row,_$last_col)">autofilter($first_row, $first_col, $last_row, $last_col)</a></h2>

<p>This method allows an autofilter to be added to a worksheet. An 
autofilter is a way of adding drop down lists to the headers of a 2D 
range of worksheet data. This in turn allow users to filter the data 
based on simple criteria so that some data is shown and some is hidden.</p>

<p>To add an autofilter to a worksheet:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">autofilter</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">10</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">autofilter</span><span class="sh_symbol">(</span><span class="sh_string">'A1:D11'</span><span class="sh_symbol">);</span>    <span class="sh_comment"># Same as above in A1 notation.</span></pre>

<p>Filter conditions can be applied using the <code>filter_column()</code> method.</p>

<p>See the <code>autofilter.pl</code> program in the examples directory of the distro for a more detailed example.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="filter_column($column,_$expression)">filter_column($column, $expression)</a></h2>

<p>The <code>filter_column</code> method can be used to filter columns in a autofilter range based on simple conditions.</p>

<p><b>NOTE:</b> It isn't sufficient to just specify the filter 
condition. You must also hide any rows that don't match the filter 
condition. Rows are hidden using the <code>set_row()</code> <code>visible</code> parameter. <code>Spreadsheet::WriteExcel</code> cannot do this automatically since it isn't part of the file format. See the <code>autofilter.pl</code> program in the examples directory of the distro for an example.</p>

<p>The conditions for the filter are specified using simple expressions:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">filter_column</span><span class="sh_symbol">(</span><span class="sh_string">'A'</span><span class="sh_symbol">,</span> <span class="sh_string">'x &gt; 2000'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">filter_column</span><span class="sh_symbol">(</span><span class="sh_string">'B'</span><span class="sh_symbol">,</span> <span class="sh_string">'x &gt; 2000 and x &lt; 5000'</span><span class="sh_symbol">);</span></pre>

<p>The <code>$column</code> parameter can either be a zero indexed column number or a string column name.</p>

<p>The following operators are available:</p>

<pre class="sh_perl sh_sourceCode">    Operator        Synonyms
       <span class="sh_symbol">==</span>           <span class="sh_symbol">=</span>   <span class="sh_keyword">eq</span>  <span class="sh_symbol">=~</span>
       <span class="sh_symbol">!=</span>           <span class="sh_string">&lt;&gt;</span>  ne  <span class="sh_symbol">!=</span>
       <span class="sh_symbol">&gt;</span>
       <span class="sh_string">&lt;</span>
       <span class="sh_symbol">&gt;=</span>
       <span class="sh_string">&lt;=</span>

       <span class="sh_keyword">and</span>          <span class="sh_symbol">&amp;&amp;</span>
       or           <span class="sh_symbol">||</span></pre>

<p>The operator synonyms are just syntactic sugar to make you more 
comfortable using the expressions. It is important to remember that the 
expressions will be interpreted by Excel and not by perl.</p>

<p>An expression can comprise a single statement or two statements separated by the <code>and</code> and <code>or</code> operators. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_string">'x &lt;  2000'</span>
    <span class="sh_string">'x &gt;  2000'</span>
    <span class="sh_string">'x == 2000'</span>
    <span class="sh_string">'x &gt;  2000 and x &lt;  5000'</span>
    <span class="sh_string">'x == 2000 or  x == 5000'</span></pre>

<p>Filtering of blank or non-blank data can be achieved by using a value of <code>Blanks</code> or <code>NonBlanks</code> in the expression:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_string">'x == Blanks'</span>
    <span class="sh_string">'x == NonBlanks'</span></pre>

<p>Top 10 style filters can be specified using a expression like the following:</p>

<pre class="sh_perl sh_sourceCode">    Top<span class="sh_symbol">|</span>Bottom <span class="sh_number">1-500</span> Items<span class="sh_symbol">|%</span></pre>

<p>For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_string">'Top    10 Items'</span>
    <span class="sh_string">'Bottom  5 Items'</span>
    <span class="sh_string">'Top    25 %'</span>
    <span class="sh_string">'Bottom 50 %'</span></pre>

<p>Excel also allows some simple string matching operations:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_string">'x =~ b*'</span>   <span class="sh_comment"># begins with b</span>
    <span class="sh_string">'x !~ b*'</span>   <span class="sh_comment"># doesn't begin with b</span>
    <span class="sh_string">'x =~ *b'</span>   <span class="sh_comment"># ends with b</span>
    <span class="sh_string">'x !~ *b'</span>   <span class="sh_comment"># doesn't end with b</span>
    <span class="sh_string">'x =~ *b*'</span>  <span class="sh_comment"># contains b</span>
    <span class="sh_string">'x !~ *b*'</span>  <span class="sh_comment"># doesn't contains b</span></pre>

<p>You can also use <code>*</code> to match any character or number and <code>?</code>
 to match any single character or number. No other regular expression 
quantifier is supported by Excel's filters. Excel's regular expression 
characters can be escaped using <code>~</code>.</p>

<p>The placeholder variable <code>x</code> in the above examples can be 
replaced by any simple string. The actual placeholder name is ignored 
internally so the following are all equivalent:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_string">'x     &lt; 2000'</span>
    <span class="sh_string">'col   &lt; 2000'</span>
    <span class="sh_string">'Price &lt; 2000'</span></pre>

<p>Also, note that a filter condition can only be applied to a column in a range specified by the <code>autofilter()</code> Worksheet method.</p>

<p>See the <code>autofilter.pl</code> program in the examples directory of the distro for a more detailed example.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="PAGE_SET-UP_METHODS">PAGE SET-UP METHODS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Page set-up methods affect the way that a worksheet looks when it is 
printed. They control features such as page headers and footers and 
margins. These methods are really just standard worksheet methods. They 
are documented here in a separate section for the sake of clarity.</p>

<p>The following methods are available for page set-up:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_function">set_landscape</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_portrait</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_page_view</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_paper</span><span class="sh_symbol">()</span>
    <span class="sh_function">center_horizontally</span><span class="sh_symbol">()</span>
    <span class="sh_function">center_vertically</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_margins</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_header</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_footer</span><span class="sh_symbol">()</span>
    <span class="sh_function">repeat_rows</span><span class="sh_symbol">()</span>
    <span class="sh_function">repeat_columns</span><span class="sh_symbol">()</span>
    <span class="sh_function">hide_gridlines</span><span class="sh_symbol">()</span>
    <span class="sh_function">print_row_col_headers</span><span class="sh_symbol">()</span>
    <span class="sh_function">print_area</span><span class="sh_symbol">()</span>
    <span class="sh_function">print_across</span><span class="sh_symbol">()</span>
    <span class="sh_function">fit_to_pages</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_start_page</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_print_scale</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_h_pagebreaks</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_v_pagebreaks</span><span class="sh_symbol">()</span></pre>

<p>A common requirement when working with Spreadsheet::WriteExcel is to 
apply the same page set-up features to all of the worksheets in a 
workbook. To do this you can use the <code>sheets()</code> method of the <code>workbook</code> class to access the array of worksheets in a workbook:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">foreach</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">(</span><span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">sheets</span><span class="sh_symbol">())</span> <span class="sh_cbracket">{</span>
       <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_landscape</span><span class="sh_symbol">();</span>
    <span class="sh_cbracket">}</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_landscape()">set_landscape()</a></h2>

<p>This method is used to set the orientation of a worksheet's printed page to landscape:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_landscape</span><span class="sh_symbol">();</span> <span class="sh_comment"># Landscape mode</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_portrait()">set_portrait()</a></h2>

<p>This method is used to set the orientation of a worksheet's printed 
page to portrait. The default worksheet orientation is portrait, so you 
won't generally need to call this method.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_portrait</span><span class="sh_symbol">();</span> <span class="sh_comment"># Portrait mode</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_page_view()">set_page_view()</a></h2>

<p>This method is used to display the worksheet in "Page View" mode. 
This is currently only supported by Mac Excel, where it is the default.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_page_view</span><span class="sh_symbol">();</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_paper($index)">set_paper($index)</a></h2>

<p>This method is used to set the paper format for the printed output of a worksheet. The following paper styles are available:</p>

<pre class="sh_perl sh_sourceCode">    Index   Paper <span class="sh_keyword">format</span>            Paper size
    <span class="sh_symbol">=====</span>   <span class="sh_symbol">============</span>            <span class="sh_symbol">==========</span>
      <span class="sh_number">0</span>     Printer default         <span class="sh_symbol">-</span>
      <span class="sh_number">1</span>     Letter                  <span class="sh_number">8</span> <span class="sh_number">1</span><span class="sh_symbol">/</span><span class="sh_number">2</span> <span class="sh_keyword">x</span> <span class="sh_number">11</span> in
      <span class="sh_number">2</span>     Letter Small            <span class="sh_number">8</span> <span class="sh_number">1</span><span class="sh_symbol">/</span><span class="sh_number">2</span> <span class="sh_keyword">x</span> <span class="sh_number">11</span> in
      <span class="sh_number">3</span>     Tabloid                 <span class="sh_number">11</span> <span class="sh_keyword">x</span> <span class="sh_number">17</span> in
      <span class="sh_number">4</span>     Ledger                  <span class="sh_number">17</span> <span class="sh_keyword">x</span> <span class="sh_number">11</span> in
      <span class="sh_number">5</span>     Legal                   <span class="sh_number">8</span> <span class="sh_number">1</span><span class="sh_symbol">/</span><span class="sh_number">2</span> <span class="sh_keyword">x</span> <span class="sh_number">14</span> in
      <span class="sh_number">6</span>     Statement               <span class="sh_number">5</span> <span class="sh_number">1</span><span class="sh_string">/2 x 8 1/</span><span class="sh_number">2</span> in
      <span class="sh_number">7</span>     Executive               <span class="sh_number">7</span> <span class="sh_number">1</span><span class="sh_string">/4 x 10 1/</span><span class="sh_number">2</span> in
      <span class="sh_number">8</span>     A3                      <span class="sh_number">297</span> <span class="sh_keyword">x</span> <span class="sh_number">420</span> mm
      <span class="sh_number">9</span>     A4                      <span class="sh_number">210</span> <span class="sh_keyword">x</span> <span class="sh_number">297</span> mm
     <span class="sh_number">10</span>     A4 Small                <span class="sh_number">210</span> <span class="sh_keyword">x</span> <span class="sh_number">297</span> mm
     <span class="sh_number">11</span>     A5                      <span class="sh_number">148</span> <span class="sh_keyword">x</span> <span class="sh_number">210</span> mm
     <span class="sh_number">12</span>     B4                      <span class="sh_number">250</span> <span class="sh_keyword">x</span> <span class="sh_number">354</span> mm
     <span class="sh_number">13</span>     B5                      <span class="sh_number">182</span> <span class="sh_keyword">x</span> <span class="sh_number">257</span> mm
     <span class="sh_number">14</span>     Folio                   <span class="sh_number">8</span> <span class="sh_number">1</span><span class="sh_symbol">/</span><span class="sh_number">2</span> <span class="sh_keyword">x</span> <span class="sh_number">13</span> in
     <span class="sh_number">15</span>     Quarto                  <span class="sh_number">215</span> <span class="sh_keyword">x</span> <span class="sh_number">275</span> mm
     <span class="sh_number">16</span>     <span class="sh_symbol">-</span>                       10x14 in
     <span class="sh_number">17</span>     <span class="sh_symbol">-</span>                       11x17 in
     <span class="sh_number">18</span>     Note                    <span class="sh_number">8</span> <span class="sh_number">1</span><span class="sh_symbol">/</span><span class="sh_number">2</span> <span class="sh_keyword">x</span> <span class="sh_number">11</span> in
     <span class="sh_number">19</span>     Envelope  <span class="sh_number">9</span>             <span class="sh_number">3</span> <span class="sh_number">7</span><span class="sh_string">/8 x 8 7/</span><span class="sh_number">8</span>
     <span class="sh_number">20</span>     Envelope <span class="sh_number">10</span>             <span class="sh_number">4</span> <span class="sh_number">1</span><span class="sh_string">/8 x 9 1/</span><span class="sh_number">2</span>
     <span class="sh_number">21</span>     Envelope <span class="sh_number">11</span>             <span class="sh_number">4</span> <span class="sh_number">1</span><span class="sh_string">/2 x 10 3/</span><span class="sh_number">8</span>
     <span class="sh_number">22</span>     Envelope <span class="sh_number">12</span>             <span class="sh_number">4</span> <span class="sh_number">3</span><span class="sh_symbol">/</span><span class="sh_number">4</span> <span class="sh_keyword">x</span> <span class="sh_number">11</span>
     <span class="sh_number">23</span>     Envelope <span class="sh_number">14</span>             <span class="sh_number">5</span> <span class="sh_keyword">x</span> <span class="sh_number">11</span> <span class="sh_number">1</span><span class="sh_symbol">/</span><span class="sh_number">2</span>
     <span class="sh_number">24</span>     C size sheet            <span class="sh_symbol">-</span>
     <span class="sh_number">25</span>     D size sheet            <span class="sh_symbol">-</span>
     <span class="sh_number">26</span>     E size sheet            <span class="sh_symbol">-</span>
     <span class="sh_number">27</span>     Envelope DL             <span class="sh_number">110</span> <span class="sh_keyword">x</span> <span class="sh_number">220</span> mm
     <span class="sh_number">28</span>     Envelope C3             <span class="sh_number">324</span> <span class="sh_keyword">x</span> <span class="sh_number">458</span> mm
     <span class="sh_number">29</span>     Envelope C4             <span class="sh_number">229</span> <span class="sh_keyword">x</span> <span class="sh_number">324</span> mm
     <span class="sh_number">30</span>     Envelope C5             <span class="sh_number">162</span> <span class="sh_keyword">x</span> <span class="sh_number">229</span> mm
     <span class="sh_number">31</span>     Envelope C6             <span class="sh_number">114</span> <span class="sh_keyword">x</span> <span class="sh_number">162</span> mm
     <span class="sh_number">32</span>     Envelope C65            <span class="sh_number">114</span> <span class="sh_keyword">x</span> <span class="sh_number">229</span> mm
     <span class="sh_number">33</span>     Envelope B4             <span class="sh_number">250</span> <span class="sh_keyword">x</span> <span class="sh_number">353</span> mm
     <span class="sh_number">34</span>     Envelope B5             <span class="sh_number">176</span> <span class="sh_keyword">x</span> <span class="sh_number">250</span> mm
     <span class="sh_number">35</span>     Envelope B6             <span class="sh_number">176</span> <span class="sh_keyword">x</span> <span class="sh_number">125</span> mm
     <span class="sh_number">36</span>     Envelope                <span class="sh_number">110</span> <span class="sh_keyword">x</span> <span class="sh_number">230</span> mm
     <span class="sh_number">37</span>     Monarch                 <span class="sh_number">3.875</span> <span class="sh_keyword">x</span> <span class="sh_number">7.5</span> in
     <span class="sh_number">38</span>     Envelope                <span class="sh_number">3</span> <span class="sh_number">5</span><span class="sh_string">/8 x 6 1/</span><span class="sh_number">2</span> in
     <span class="sh_number">39</span>     Fanfold                 <span class="sh_number">14</span> <span class="sh_number">7</span><span class="sh_symbol">/</span><span class="sh_number">8</span> <span class="sh_keyword">x</span> <span class="sh_number">11</span> in
     <span class="sh_number">40</span>     German Std Fanfold      <span class="sh_number">8</span> <span class="sh_number">1</span><span class="sh_symbol">/</span><span class="sh_number">2</span> <span class="sh_keyword">x</span> <span class="sh_number">12</span> in
     <span class="sh_number">41</span>     German Legal Fanfold    <span class="sh_number">8</span> <span class="sh_number">1</span><span class="sh_symbol">/</span><span class="sh_number">2</span> <span class="sh_keyword">x</span> <span class="sh_number">13</span> in</pre>

<p>Note, it is likely that not all of these paper types will be 
available to the end user since it will depend on the paper formats that
 the user's printer supports. Therefore, it is best to stick to standard
 paper types.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_paper</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># US Letter</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_paper</span><span class="sh_symbol">(</span><span class="sh_number">9</span><span class="sh_symbol">);</span> <span class="sh_comment"># A4</span></pre>

<p>If you do not specify a paper type the worksheet will print using the printer's default paper.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="center_horizontally()">center_horizontally()</a></h2>

<p>Center the worksheet data horizontally between the margins on the printed page:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">center_horizontally</span><span class="sh_symbol">();</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="center_vertically()">center_vertically()</a></h2>

<p>Center the worksheet data vertically between the margins on the printed page:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">center_vertically</span><span class="sh_symbol">();</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_margins($inches)">set_margins($inches)</a></h2>

<p>There are several methods available for setting the worksheet margins on the printed page:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_function">set_margins</span><span class="sh_symbol">()</span>        <span class="sh_comment"># Set all margins to the same value</span>
    <span class="sh_function">set_margins_LR</span><span class="sh_symbol">()</span>     <span class="sh_comment"># Set left and right margins to the same value</span>
    <span class="sh_function">set_margins_TB</span><span class="sh_symbol">()</span>     <span class="sh_comment"># Set top and bottom margins to the same value</span>
    <span class="sh_function">set_margin_left</span><span class="sh_symbol">();</span>   <span class="sh_comment"># Set left margin</span>
    <span class="sh_function">set_margin_right</span><span class="sh_symbol">();</span>  <span class="sh_comment"># Set right margin</span>
    <span class="sh_function">set_margin_top</span><span class="sh_symbol">();</span>    <span class="sh_comment"># Set top margin</span>
    <span class="sh_function">set_margin_bottom</span><span class="sh_symbol">();</span> <span class="sh_comment"># Set bottom margin</span></pre>

<p>All of these methods take a distance in inches as a parameter. Note: 1
 inch = 25.4mm. ;-) The default left and right margin is 0.75 inch. The 
default top and bottom margin is 1.00 inch.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_header($string,_$margin)">set_header($string, $margin)</a></h2>

<p>Headers and footers are generated using a <code>$string</code> which is a combination of plain text and control characters. The <code>$margin</code> parameter is optional.</p>

<p>The available control character are:</p>

<pre class="sh_perl sh_sourceCode">    Control             Category            Description
    <span class="sh_symbol">=======</span>             <span class="sh_symbol">========</span>            <span class="sh_symbol">===========</span>
    <span class="sh_symbol">&amp;</span>L                  Justification       Left
    <span class="sh_symbol">&amp;</span>C                                      Center
    <span class="sh_symbol">&amp;</span>R                                      Right

    <span class="sh_symbol">&amp;</span>P                  Information         Page number
    <span class="sh_symbol">&amp;</span>N                                      Total number of pages
    <span class="sh_symbol">&amp;</span>D                                      Date
    <span class="sh_symbol">&amp;</span>T                                      Time
    <span class="sh_symbol">&amp;</span>F                                      File name
    <span class="sh_symbol">&amp;</span>A                                      Worksheet name
    <span class="sh_symbol">&amp;</span>Z                                      Workbook path

    <span class="sh_symbol">&amp;</span>fontsize           Font                Font size
    <span class="sh_symbol">&amp;</span><span class="sh_string">"font,style"</span>                           Font name <span class="sh_keyword">and</span> style
    <span class="sh_symbol">&amp;</span>U                                      Single underline
    <span class="sh_symbol">&amp;</span>E                                      Double underline
    <span class="sh_symbol">&amp;</span>S                                      Strikethrough
    <span class="sh_symbol">&amp;</span>X                                      Superscript
    <span class="sh_symbol">&amp;</span>Y                                      Subscript

    <span class="sh_symbol">&amp;&amp;</span>                  Miscellaneous       Literal ampersand <span class="sh_symbol">&amp;</span></pre>

<p>Text in headers and footers can be justified (aligned) to the left, 
center and right by prefixing the text with the control characters <code>&amp;L</code>, <code>&amp;C</code> and <code>&amp;R</code>.</p>

<p>For example (with ASCII art representation of the results):</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;LHello'</span><span class="sh_symbol">);</span>

     <span class="sh_symbol">---------------------------------------------------------------</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span> Hello                                                         <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span>


    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;CHello'</span><span class="sh_symbol">);</span>

     <span class="sh_symbol">---------------------------------------------------------------</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                          Hello                                <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span>


    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;RHello'</span><span class="sh_symbol">);</span>

     <span class="sh_symbol">---------------------------------------------------------------</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                                                         Hello <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span></pre>

<p>For simple text, if you do not specify any justification the text will be centred. However, you must prefix the text with <code>&amp;C</code> if you specify a font name or any other formatting:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'Hello'</span><span class="sh_symbol">);</span>

     <span class="sh_symbol">---------------------------------------------------------------</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                          Hello                                <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span></pre>

<p>You can have text in each of the justification regions:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;LCiao&amp;CBello&amp;RCielo'</span><span class="sh_symbol">);</span>

     <span class="sh_symbol">---------------------------------------------------------------</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span> Ciao                     Bello                          Cielo <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span></pre>

<p>The information control characters act as variables that Excel will 
update as the workbook or worksheet changes. Times and dates are in the 
users default format:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;CPage &amp;P of &amp;N'</span><span class="sh_symbol">);</span>

     <span class="sh_symbol">---------------------------------------------------------------</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                        Page <span class="sh_number">1</span> of <span class="sh_number">6</span>                            <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span>


    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;CUpdated at &amp;T'</span><span class="sh_symbol">);</span>

     <span class="sh_symbol">---------------------------------------------------------------</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                    Updated at <span class="sh_number">12</span><span class="sh_symbol">:</span><span class="sh_number">30</span> PM                        <span class="sh_symbol">|</span>
    <span class="sh_symbol">|</span>                                                               <span class="sh_symbol">|</span></pre>

<p>You can specify the font size of a section of the text by prefixing it with the control character <code>&amp;n</code> where <code>n</code> is the font size:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;C&amp;30Hello Big'</span>  <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;C&amp;10Hello Small'</span><span class="sh_symbol">);</span></pre>

<p>You can specify the font of a section of the text by prefixing it with the control sequence <code>&amp;"font,style"</code> where <code>fontname</code> is a font name such as "Courier New" or "Times New Roman" and <code>style</code> is one of the standard Windows font descriptions: "Regular", "Italic", "Bold" or "Bold Italic":</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;C&amp;"Courier New,Italic"Hello'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;C&amp;"Courier New,Bold Italic"Hello'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet3</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;C&amp;"Times New Roman,Regular"Hello'</span><span class="sh_symbol">);</span></pre>

<p>It is possible to combine all of these features together to create 
sophisticated headers and footers. As an aid to setting up complicated 
headers and footers you can record a page set-up as a macro in Excel and
 look at the format strings that VBA produces. Remember however that VBA
 uses two double quotes <code>""</code> to indicate a single double quote. For the last example above the equivalent VBA code looks like this:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_symbol">.</span>LeftHeader   <span class="sh_symbol">=</span> <span class="sh_string">""</span>
    <span class="sh_symbol">.</span>CenterHeader <span class="sh_symbol">=</span> <span class="sh_string">"&amp;""Times New Roman,Regular""Hello"</span>
    <span class="sh_symbol">.</span>RightHeader  <span class="sh_symbol">=</span> <span class="sh_string">""</span></pre>

<p>To include a single literal ampersand <code>&amp;</code> in a header or footer you should use a double ampersand <code>&amp;&amp;</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;CCuriouser &amp;&amp; Curiouser - Attorneys at Law'</span><span class="sh_symbol">);</span></pre>

<p>As stated above the margin parameter is optional. As with the other 
margins the value should be in inches. The default header and footer 
margin is 0.50 inch. The header and footer margin size can be set as 
follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">'&amp;CHello'</span><span class="sh_symbol">,</span> <span class="sh_number">0.75</span><span class="sh_symbol">);</span></pre>

<p>The header and footer margins are independent of the top and bottom margins.</p>

<p>Note, the header or footer string must be less than 255 characters. 
Strings longer than this will not be written and a warning will be 
generated.</p>

<p>On systems with <code>perl 5.8</code> and later the <code>set_header()</code> method can also handle Unicode strings in <code>UTF-8</code> format.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_header</span><span class="sh_symbol">(</span><span class="sh_string">"&amp;C\x{263a}"</span><span class="sh_symbol">)</span></pre>

<p>See, also the <code>headers.pl</code> program in the <code>examples</code> directory of the distribution.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_footer()">set_footer()</a></h2>

<p>The syntax of the <code>set_footer()</code> method is the same as <code>set_header()</code>, see above.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="repeat_rows($first_row,_$last_row)">repeat_rows($first_row, $last_row)</a></h2>

<p>Set the number of rows to repeat at the top of each printed page.</p>

<p>For large Excel documents it is often desirable to have the first row
 or rows of the worksheet print out at the top of each page. This can be
 achieved by using the <code>repeat_rows()</code> method. The parameters <code>$first_row</code> and <code>$last_row</code> are zero based. The <code>$last_row</code> parameter is optional if you only wish to specify one row:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_rows</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span>    <span class="sh_comment"># Repeat the first row</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_rows</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># Repeat the first two rows</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="repeat_columns($first_col,_$last_col)">repeat_columns($first_col, $last_col)</a></h2>

<p>Set the columns to repeat at the left hand side of each printed page.</p>

<p>For large Excel documents it is often desirable to have the first 
column or columns of the worksheet print out at the left hand side of 
each page. This can be achieved by using the <code>repeat_columns()</code> method. The parameters <code>$first_column</code> and <code>$last_column</code> are zero based. The <code>$last_column</code>
 parameter is optional if you only wish to specify one column. You can 
also specify the columns using A1 column notation, see the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a>.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_columns</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span>     <span class="sh_comment"># Repeat the first column</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_columns</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>  <span class="sh_comment"># Repeat the first two columns</span>
    <span class="sh_variable">$worksheet3</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_columns</span><span class="sh_symbol">(</span><span class="sh_string">'A:A'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Repeat the first column</span>
    <span class="sh_variable">$worksheet4</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_columns</span><span class="sh_symbol">(</span><span class="sh_string">'A:B'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Repeat the first two columns</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="hide_gridlines($option)">hide_gridlines($option)</a></h2>

<p>This method is used to hide the gridlines on the screen and printed 
page. Gridlines are the lines that divide the cells on a worksheet. 
Screen and printed gridlines are turned on by default in an Excel 
worksheet. If you have defined your own cell borders you may wish to 
hide the default gridlines.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">hide_gridlines</span><span class="sh_symbol">();</span></pre>

<p>The following values of <code>$option</code> are valid:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_number">0</span> <span class="sh_symbol">:</span> Don<span class="sh_string">'t hide gridlines</span>
    <span class="sh_number">1</span> <span class="sh_symbol">:</span> Hide printed gridlines only
    <span class="sh_number">2</span> <span class="sh_symbol">:</span> Hide screen <span class="sh_keyword">and</span> printed gridlines</pre>

<p>If you don't supply an argument or use <code>undef</code> the default option is 1, i.e. only the printed gridlines are hidden.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="print_row_col_headers()">print_row_col_headers()</a></h2>

<p>Set the option to print the row and column headers on the printed page.</p>

<p>An Excel worksheet looks something like the following;</p>

<pre class="sh_perl sh_sourceCode">     <span class="sh_symbol">------------------------------------------</span>
    <span class="sh_symbol">|</span>   <span class="sh_symbol">|</span>   A   <span class="sh_symbol">|</span>   B   <span class="sh_symbol">|</span>   C   <span class="sh_symbol">|</span>   D   <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">------------------------------------------</span>
    <span class="sh_symbol">|</span> <span class="sh_number">1</span> <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">2</span> <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">3</span> <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
    <span class="sh_symbol">|</span> <span class="sh_number">4</span> <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
    <span class="sh_symbol">|...|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span></pre>

<p>The headers are the letters and numbers at the top and the left of 
the worksheet. Since these headers serve mainly as a indication of 
position on the worksheet they generally do not appear on the printed 
page. If you wish to have them printed you can use the <code>print_row_col_headers()</code> method :</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">print_row_col_headers</span><span class="sh_symbol">();</span></pre>

<p>Do not confuse these headers with page headers as described in the <code>set_header()</code> section above.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="print_area($first_row,_$first_col,_$last_row,_$last_col)">print_area($first_row, $first_col, $last_row, $last_col)</a></h2>

<p>This method is used to specify the area of the worksheet that will be
 printed. All four parameters must be specified. You can also use A1 
notation, see the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a>.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">print_area</span><span class="sh_symbol">(</span><span class="sh_string">'A1:H20'</span><span class="sh_symbol">);</span>    <span class="sh_comment"># Cells A1 to H20</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">print_area</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">19</span><span class="sh_symbol">,</span> <span class="sh_number">7</span><span class="sh_symbol">);</span> <span class="sh_comment"># The same</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">print_area</span><span class="sh_symbol">(</span><span class="sh_string">'A:H'</span><span class="sh_symbol">);</span>       <span class="sh_comment"># Columns A to H if rows have data</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="print_across()">print_across()</a></h2>

<p>The <code>print_across</code> method is used to change the default print direction. This is referred to by Excel as the sheet "page order".</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">print_across</span><span class="sh_symbol">();</span></pre>

<p>The default page order is shown below for a worksheet that extends over 4 pages. The order is called "down then across":</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">[</span><span class="sh_number">3</span><span class="sh_symbol">]</span>
    <span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]</span> <span class="sh_symbol">[</span><span class="sh_number">4</span><span class="sh_symbol">]</span></pre>

<p>However, by using the <code>print_across</code> method the print order will be changed to "across then down":</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]</span>
    <span class="sh_symbol">[</span><span class="sh_number">3</span><span class="sh_symbol">]</span> <span class="sh_symbol">[</span><span class="sh_number">4</span><span class="sh_symbol">]</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="fit_to_pages($width,_$height)">fit_to_pages($width, $height)</a></h2>

<p>The <code>fit_to_pages()</code> method is used to fit the printed 
area to a specific number of pages both vertically and horizontally. If 
the printed area exceeds the specified number of pages it will be scaled
 down to fit. This guarantees that the printed area will always appear 
on the specified number of pages even if the page size or margins 
change.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">fit_to_pages</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># Fit to 1x1 pages</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">fit_to_pages</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># Fit to 2x1 pages</span>
    <span class="sh_variable">$worksheet3</span><span class="sh_symbol">-&gt;</span><span class="sh_function">fit_to_pages</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">);</span> <span class="sh_comment"># Fit to 1x2 pages</span></pre>

<p>The print area can be defined using the <code>print_area()</code> method as described above.</p>

<p>A common requirement is to fit the printed output to <i>n</i> pages wide but have the height be as long as necessary. To achieve this set the <code>$height</code> to zero or leave it blank:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">fit_to_pages</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span> <span class="sh_comment"># 1 page wide and as long as necessary</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">fit_to_pages</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span>    <span class="sh_comment"># The same</span></pre>

<p>Note that although it is valid to use both <code>fit_to_pages()</code> and <code>set_print_scale()</code> on the same worksheet only one of these options can be active at a time. The last method call made will set the active option.</p>

<p>Note that <code>fit_to_pages()</code> will override any manual page breaks that are defined in the worksheet.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_start_page($start_page)">set_start_page($start_page)</a></h2>

<p>The <code>set_start_page()</code> method is used to set the number of the starting page when the worksheet is printed out. The default value is 1.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_start_page</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">);</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_print_scale($scale)">set_print_scale($scale)</a></h2>

<p>Set the scale factor of the printed page. Scale factors in the range <code>10 &lt;= $scale &lt;= 400</code> are valid:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_print_scale</span><span class="sh_symbol">(</span><span class="sh_number">50</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_print_scale</span><span class="sh_symbol">(</span><span class="sh_number">75</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet3</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_print_scale</span><span class="sh_symbol">(</span><span class="sh_number">300</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet4</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_print_scale</span><span class="sh_symbol">(</span><span class="sh_number">400</span><span class="sh_symbol">);</span></pre>

<p>The default scale factor is 100. Note, <code>set_print_scale()</code> does not affect the scale of the visible page in Excel. For that you should use <code>set_zoom()</code>.</p>

<p>Note also that although it is valid to use both <code>fit_to_pages()</code> and <code>set_print_scale()</code> on the same worksheet only one of these options can be active at a time. The last method call made will set the active option.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_h_pagebreaks(@breaks)">set_h_pagebreaks(@breaks)</a></h2>

<p>Add horizontal page breaks to a worksheet. A page break causes all 
the data that follows it to be printed on the next page. Horizontal page
 breaks act between rows. To create a page break between rows 20 and 21 
you must specify the break at row 21. However in zero index notation 
this is actually row 20. So you can pretend for a small while that you 
are using 1 index notation:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_h_pagebreaks</span><span class="sh_symbol">(</span><span class="sh_number">20</span><span class="sh_symbol">);</span> <span class="sh_comment"># Break between row 20 and 21</span></pre>

<p>The <code>set_h_pagebreaks()</code> method will accept a list of page breaks and you can call it more than once:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_h_pagebreaks</span><span class="sh_symbol">(</span> <span class="sh_number">20</span><span class="sh_symbol">,</span>  <span class="sh_number">40</span><span class="sh_symbol">,</span>  <span class="sh_number">60</span><span class="sh_symbol">,</span>  <span class="sh_number">80</span><span class="sh_symbol">,</span> <span class="sh_number">100</span><span class="sh_symbol">);</span> <span class="sh_comment"># Add breaks</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_h_pagebreaks</span><span class="sh_symbol">(</span><span class="sh_number">120</span><span class="sh_symbol">,</span> <span class="sh_number">140</span><span class="sh_symbol">,</span> <span class="sh_number">160</span><span class="sh_symbol">,</span> <span class="sh_number">180</span><span class="sh_symbol">,</span> <span class="sh_number">200</span><span class="sh_symbol">);</span> <span class="sh_comment"># Add some more</span></pre>

<p>Note: If you specify the "fit to page" option via the <code>fit_to_pages()</code> method it will override all manual page breaks.</p>

<p>There is a silent limitation of about 1000 horizontal page breaks per worksheet in line with an Excel internal limitation.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_v_pagebreaks(@breaks)">set_v_pagebreaks(@breaks)</a></h2>

<p>Add vertical page breaks to a worksheet. A page break causes all the 
data that follows it to be printed on the next page. Vertical page 
breaks act between columns. To create a page break between columns 20 
and 21 you must specify the break at column 21. However in zero index 
notation this is actually column 20. So you can pretend for a small 
while that you are using 1 index notation:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_v_pagebreaks</span><span class="sh_symbol">(</span><span class="sh_number">20</span><span class="sh_symbol">);</span> <span class="sh_comment"># Break between column 20 and 21</span></pre>

<p>The <code>set_v_pagebreaks()</code> method will accept a list of page breaks and you can call it more than once:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_v_pagebreaks</span><span class="sh_symbol">(</span> <span class="sh_number">20</span><span class="sh_symbol">,</span>  <span class="sh_number">40</span><span class="sh_symbol">,</span>  <span class="sh_number">60</span><span class="sh_symbol">,</span>  <span class="sh_number">80</span><span class="sh_symbol">,</span> <span class="sh_number">100</span><span class="sh_symbol">);</span> <span class="sh_comment"># Add breaks</span>
    <span class="sh_variable">$worksheet2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_v_pagebreaks</span><span class="sh_symbol">(</span><span class="sh_number">120</span><span class="sh_symbol">,</span> <span class="sh_number">140</span><span class="sh_symbol">,</span> <span class="sh_number">160</span><span class="sh_symbol">,</span> <span class="sh_number">180</span><span class="sh_symbol">,</span> <span class="sh_number">200</span><span class="sh_symbol">);</span> <span class="sh_comment"># Add some more</span></pre>

<p>Note: If you specify the "fit to page" option via the <code>fit_to_pages()</code> method it will override all manual page breaks.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="CELL_FORMATTING">CELL FORMATTING <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>This section describes the methods and properties that are available 
for formatting cells in Excel. The properties of a cell that can be 
formatted include: fonts, colours, patterns, borders, alignment and 
number formatting.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Creating_and_using_a_Format_object">Creating and using a Format object</a></h2>

<p>Cell formatting is defined through a Format object. Format objects are created by calling the workbook <code>add_format()</code> method as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format1</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>       <span class="sh_comment"># Set properties later</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$format2</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span><span class="sh_variable">%props</span><span class="sh_symbol">);</span> <span class="sh_comment"># Set at creation</span></pre>

<p>The format object holds all the formatting properties that can be 
applied to a cell, a row or a column. The process of setting these 
properties is discussed in the next section.</p>

<p>Once a Format object has been constructed and its properties have been set it can be passed as an argument to the worksheet <code>write</code> methods as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'One'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_string</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Two'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_number</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_blank</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>Formats can also be passed to the worksheet <code>set_row()</code> and <code>set_column()</code> methods to define the default property for a row or column.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">15</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">15</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Format_methods_and_Format_properties">Format methods and Format properties</a></h2>

<p>The following table shows the Excel format categories, the formatting
 properties that can be applied and the equivalent object method:</p>

<pre class="sh_perl sh_sourceCode">    Category   Description       Property        Method Name
    <span class="sh_symbol">--------</span>   <span class="sh_symbol">-----------</span>       <span class="sh_symbol">--------</span>        <span class="sh_symbol">-----------</span>
    Font       Font type         font            <span class="sh_function">set_font</span><span class="sh_symbol">()</span>
               Font size         size            <span class="sh_function">set_size</span><span class="sh_symbol">()</span>
               Font color        color           <span class="sh_function">set_color</span><span class="sh_symbol">()</span>
               Bold              bold            <span class="sh_function">set_bold</span><span class="sh_symbol">()</span>
               Italic            italic          <span class="sh_function">set_italic</span><span class="sh_symbol">()</span>
               Underline         underline       <span class="sh_function">set_underline</span><span class="sh_symbol">()</span>
               Strikeout         font_strikeout  <span class="sh_function">set_font_strikeout</span><span class="sh_symbol">()</span>
               Super<span class="sh_symbol">/</span>Subscript   font_script     <span class="sh_function">set_font_script</span><span class="sh_symbol">()</span>
               Outline           font_outline    <span class="sh_function">set_font_outline</span><span class="sh_symbol">()</span>
               Shadow            font_shadow     <span class="sh_function">set_font_shadow</span><span class="sh_symbol">()</span>

    Number     Numeric <span class="sh_keyword">format</span>    num_format      <span class="sh_function">set_num_format</span><span class="sh_symbol">()</span>

    Protection Lock cells        locked          <span class="sh_function">set_locked</span><span class="sh_symbol">()</span>
               Hide formulas     hidden          <span class="sh_function">set_hidden</span><span class="sh_symbol">()</span>

    Alignment  Horizontal align  align           <span class="sh_function">set_align</span><span class="sh_symbol">()</span>
               Vertical align    valign          <span class="sh_function">set_align</span><span class="sh_symbol">()</span>
               Rotation          rotation        <span class="sh_function">set_rotation</span><span class="sh_symbol">()</span>
               Text wrap         text_wrap       <span class="sh_function">set_text_wrap</span><span class="sh_symbol">()</span>
               Justify <span class="sh_keyword">last</span>      text_justlast   <span class="sh_function">set_text_justlast</span><span class="sh_symbol">()</span>
               Center across     center_across   <span class="sh_function">set_center_across</span><span class="sh_symbol">()</span>
               Indentation       indent          <span class="sh_function">set_indent</span><span class="sh_symbol">()</span>
               Shrink to fit     shrink          <span class="sh_function">set_shrink</span><span class="sh_symbol">()</span>

    Pattern    Cell pattern      pattern         <span class="sh_function">set_pattern</span><span class="sh_symbol">()</span>
               Background color  bg_color        <span class="sh_function">set_bg_color</span><span class="sh_symbol">()</span>
               Foreground color  fg_color        <span class="sh_function">set_fg_color</span><span class="sh_symbol">()</span>

    Border     Cell border       border          <span class="sh_function">set_border</span><span class="sh_symbol">()</span>
               Bottom border     bottom          <span class="sh_function">set_bottom</span><span class="sh_symbol">()</span>
               Top border        top             <span class="sh_function">set_top</span><span class="sh_symbol">()</span>
               Left border       left            <span class="sh_function">set_left</span><span class="sh_symbol">()</span>
               Right border      right           <span class="sh_function">set_right</span><span class="sh_symbol">()</span>
               Border color      border_color    <span class="sh_function">set_border_color</span><span class="sh_symbol">()</span>
               Bottom color      bottom_color    <span class="sh_function">set_bottom_color</span><span class="sh_symbol">()</span>
               Top color         top_color       <span class="sh_function">set_top_color</span><span class="sh_symbol">()</span>
               Left color        left_color      <span class="sh_function">set_left_color</span><span class="sh_symbol">()</span>
               Right color       right_color     <span class="sh_function">set_right_color</span><span class="sh_symbol">()</span></pre>

<p>There are two ways of setting Format properties: by using the object 
method interface or by setting the property directly. For example, a 
typical use of the method interface would be as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_color</span><span class="sh_symbol">(</span><span class="sh_string">'red'</span><span class="sh_symbol">);</span></pre>

<p>By comparison the properties can be set directly by passing a hash of properties to the Format constructor:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>bold <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> color <span class="sh_symbol">=&gt;</span> <span class="sh_string">'red'</span><span class="sh_symbol">);</span></pre>

<p>or after the Format has been constructed by means of the <code>set_format_properties()</code> method as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_format_properties</span><span class="sh_symbol">(</span>bold <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> color <span class="sh_symbol">=&gt;</span> <span class="sh_string">'red'</span><span class="sh_symbol">);</span></pre>

<p>You can also store the properties in one or more named hashes and pass them to the required method:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">%font</span>    <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>
                    font  <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Arial'</span><span class="sh_symbol">,</span>
                    size  <span class="sh_symbol">=&gt;</span> <span class="sh_number">12</span><span class="sh_symbol">,</span>
                    color <span class="sh_symbol">=&gt;</span> <span class="sh_string">'blue'</span><span class="sh_symbol">,</span>
                    bold  <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
                  <span class="sh_symbol">);</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">%shading</span> <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>
                    bg_color <span class="sh_symbol">=&gt;</span> <span class="sh_string">'green'</span><span class="sh_symbol">,</span>
                    pattern  <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
                  <span class="sh_symbol">);</span>


    <span class="sh_keyword">my</span> <span class="sh_variable">$format1</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span><span class="sh_variable">%font</span><span class="sh_symbol">);</span>           <span class="sh_comment"># Font only</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$format2</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span><span class="sh_variable">%font</span><span class="sh_symbol">,</span> <span class="sh_variable">%shading</span><span class="sh_symbol">);</span> <span class="sh_comment"># Font and shading</span></pre>

<p>The provision of two ways of setting properties might lead you to 
wonder which is the best way. The method mechanism may be better is you 
prefer setting properties via method calls (which the author did when 
the code was first written) otherwise passing properties to the 
constructor has proved to be a little more flexible and self documenting
 in practice. An additional advantage of working with property hashes is
 that it allows you to share formatting between workbook objects as 
shown in the example above.</p>

<p>The Perl/Tk style of adding properties is also supported:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">%font</span>    <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>
                    <span class="sh_symbol">-</span>font      <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Arial'</span><span class="sh_symbol">,</span>
                    <span class="sh_symbol">-</span>size      <span class="sh_symbol">=&gt;</span> <span class="sh_number">12</span><span class="sh_symbol">,</span>
                    <span class="sh_symbol">-</span>color     <span class="sh_symbol">=&gt;</span> <span class="sh_string">'blue'</span><span class="sh_symbol">,</span>
                    <span class="sh_symbol">-</span>bold      <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
                  <span class="sh_symbol">);</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Working_with_formats">Working with formats</a></h2>

<p>The default format is Arial 10 with all other properties off.</p>

<p>Each unique format in Spreadsheet::WriteExcel must have a 
corresponding Format object. It isn't possible to use a Format with a 
write() method and then redefine the Format for use at a later stage. 
This is because a Format is applied to a cell not in its current state 
but in its final state. Consider the following example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_color</span><span class="sh_symbol">(</span><span class="sh_string">'red'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'Cell A1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_color</span><span class="sh_symbol">(</span><span class="sh_string">'green'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'B1'</span><span class="sh_symbol">,</span> <span class="sh_string">'Cell B1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>Cell A1 is assigned the Format <code>$format</code> which is 
initially set to the colour red. However, the colour is subsequently set
 to green. When Excel displays Cell A1 it will display the final state 
of the Format which in this case will be the colour green.</p>

<p>In general a method call without an argument will turn a property on, for example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format1</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">();</span>  <span class="sh_comment"># Turns bold on</span>
    <span class="sh_variable">$format1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># Also turns bold on</span>
    <span class="sh_variable">$format1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span> <span class="sh_comment"># Turns bold off</span></pre>

<h1><a class="u" href="#___top" title="click to go to top of document" name="FORMAT_METHODS">FORMAT METHODS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>The Format object methods are described in more detail in the following sections. In addition, there is a Perl program called <code>formats.pl</code> in the <code>examples</code> directory of the WriteExcel distribution. This program creates an Excel workbook called <code>formats.xls</code> which contains examples of almost all the format types.</p>

<p>The following Format methods are available:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_function">set_font</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_size</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_color</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_bold</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_italic</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_underline</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_font_strikeout</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_font_script</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_font_outline</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_font_shadow</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_num_format</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_locked</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_hidden</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_align</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_rotation</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_text_wrap</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_text_justlast</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_center_across</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_indent</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_shrink</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_pattern</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_bg_color</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_fg_color</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_border</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_bottom</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_top</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_left</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_right</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_border_color</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_bottom_color</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_top_color</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_left_color</span><span class="sh_symbol">()</span>
    <span class="sh_function">set_right_color</span><span class="sh_symbol">()</span></pre>

<p>The above methods can also be applied directly as properties. For example <code>$format-&gt;set_bold()</code> is equivalent to <code>$workbook-&gt;add_format(bold =&gt; 1)</code>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_format_properties(%properties)">set_format_properties(%properties)</a></h2>

<p>The properties of an existing Format object can be also be set by means of <code>set_format_properties()</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_format_properties</span><span class="sh_symbol">(</span>bold <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> color <span class="sh_symbol">=&gt;</span> <span class="sh_string">'red'</span><span class="sh_symbol">);</span></pre>

<p>However, this method is here mainly for legacy reasons. It is preferable to set the properties in the format constructor:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>bold <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> color <span class="sh_symbol">=&gt;</span> <span class="sh_string">'red'</span><span class="sh_symbol">);</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_font($fontname)">set_font($fontname)</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Font is Arial
    Default action<span class="sh_symbol">:</span>     None
    Valid args<span class="sh_symbol">:</span>         Any valid font name</pre>

<p>Specify the font used:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_font</span><span class="sh_symbol">(</span><span class="sh_string">'Times New Roman'</span><span class="sh_symbol">);</span></pre>

<p>Excel can only display fonts that are installed on the system that it
 is running on. Therefore it is best to use the fonts that come as 
standard such as 'Arial', 'Times New Roman' and 'Courier New'. See also 
the Fonts worksheet created by formats.pl</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_size()">set_size()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Font size is <span class="sh_number">10</span>
    Default action<span class="sh_symbol">:</span>     Set font size to <span class="sh_number">1</span>
    Valid args<span class="sh_symbol">:</span>         Integer <span class="sh_keyword">values</span> from <span class="sh_number">1</span> to as big as your screen<span class="sh_symbol">.</span></pre>

<p>Set the font size. Excel adjusts the height of a row to accommodate 
the largest font size in the row. You can also explicitly specify the 
height of a row using the set_row() worksheet method.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_size</span><span class="sh_symbol">(</span><span class="sh_number">30</span><span class="sh_symbol">);</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_color()">set_color()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Excels default color<span class="sh_symbol">,</span> usually black
    Default action<span class="sh_symbol">:</span>     Set the default color
    Valid args<span class="sh_symbol">:</span>         Integers from <span class="sh_number">8</span><span class="sh_symbol">..</span><span class="sh_number">63</span> or the following strings<span class="sh_symbol">:</span>
                        <span class="sh_string">'black'</span>
                        <span class="sh_string">'blue'</span>
                        <span class="sh_string">'brown'</span>
                        <span class="sh_string">'cyan'</span>
                        <span class="sh_string">'gray'</span>
                        <span class="sh_string">'green'</span>
                        <span class="sh_string">'lime'</span>
                        <span class="sh_string">'magenta'</span>
                        <span class="sh_string">'navy'</span>
                        <span class="sh_string">'orange'</span>
                        <span class="sh_string">'pink'</span>
                        <span class="sh_string">'purple'</span>
                        <span class="sh_string">'red'</span>
                        <span class="sh_string">'silver'</span>
                        <span class="sh_string">'white'</span>
                        <span class="sh_string">'yellow'</span></pre>

<p>Set the font colour. The <code>set_color()</code> method is used as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_color</span><span class="sh_symbol">(</span><span class="sh_string">'red'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'wheelbarrow'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>Note: The <code>set_color()</code> method is used to set the colour of the font in a cell. To set the colour of a cell use the <code>set_bg_color()</code> and <code>set_pattern()</code> methods.</p>

<p>For additional examples see the 'Named colors' and 'Standard colors' worksheets created by formats.pl in the examples directory.</p>

<p>See also <a href="#COLOURS_IN_EXCEL" class="podlinkpod">"COLOURS IN EXCEL"</a>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_bold()">set_bold()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      bold is off
    Default action<span class="sh_symbol">:</span>     Turn bold on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span> <span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span></pre>

<p>Set the bold property of the font:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">();</span>  <span class="sh_comment"># Turn bold on</span></pre>

<p>[1] Actually, values in the range 100..1000 are also valid. 400 is 
normal, 700 is bold and 1000 is very bold indeed. It is probably best to
 set the value to 1 and use normal bold.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_italic()">set_italic()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Italic is off
    Default action<span class="sh_symbol">:</span>     Turn italic on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span></pre>

<p>Set the italic property of the font:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_italic</span><span class="sh_symbol">();</span>  <span class="sh_comment"># Turn italic on</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_underline()">set_underline()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Underline is off
    Default action<span class="sh_symbol">:</span>     Turn on single underline
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span>  <span class="sh_symbol">=</span> No underline
                        <span class="sh_number">1</span>  <span class="sh_symbol">=</span> Single underline
                        <span class="sh_number">2</span>  <span class="sh_symbol">=</span> Double underline
                        <span class="sh_number">33</span> <span class="sh_symbol">=</span> Single accounting underline
                        <span class="sh_number">34</span> <span class="sh_symbol">=</span> Double accounting underline</pre>

<p>Set the underline property of the font.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_underline</span><span class="sh_symbol">();</span>   <span class="sh_comment"># Single underline</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_font_strikeout()">set_font_strikeout()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Strikeout is off
    Default action<span class="sh_symbol">:</span>     Turn strikeout on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span></pre>

<p>Set the strikeout property of the font.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_font_script()">set_font_script()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Super<span class="sh_symbol">/</span>Subscript is off
    Default action<span class="sh_symbol">:</span>     Turn Superscript on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span>  <span class="sh_symbol">=</span> Normal
                        <span class="sh_number">1</span>  <span class="sh_symbol">=</span> Superscript
                        <span class="sh_number">2</span>  <span class="sh_symbol">=</span> Subscript</pre>

<p>Set the superscript/subscript property of the font. This format is currently not very useful.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_font_outline()">set_font_outline()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Outline is off
    Default action<span class="sh_symbol">:</span>     Turn outline on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span></pre>

<p>Macintosh only.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_font_shadow()">set_font_shadow()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Shadow is off
    Default action<span class="sh_symbol">:</span>     Turn shadow on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span></pre>

<p>Macintosh only.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_num_format()">set_num_format()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      General <span class="sh_keyword">format</span>
    Default action<span class="sh_symbol">:</span>     Format <span class="sh_keyword">index</span> <span class="sh_number">1</span>
    Valid args<span class="sh_symbol">:</span>         See the following table</pre>

<p>This method is used to define the numerical format of a number in 
Excel. It controls whether a number is displayed as an integer, a 
floating point number, a date, a currency value or some other user 
defined format.</p>

<p>The numerical format of a cell can be specified by using a format string or an index to one of Excel's built-in formats:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format1</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$format2</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'d mmm yyyy'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Format string</span>
    <span class="sh_variable">$format2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_number">0x0f</span><span class="sh_symbol">);</span>         <span class="sh_comment"># Format index</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">36892.521</span><span class="sh_symbol">,</span> <span class="sh_variable">$format1</span><span class="sh_symbol">);</span>      <span class="sh_comment"># 1 Jan 2001</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">36892.521</span><span class="sh_symbol">,</span> <span class="sh_variable">$format2</span><span class="sh_symbol">);</span>      <span class="sh_comment"># 1-Jan-01</span></pre>

<p>Using format strings you can define very sophisticated formatting of numbers.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$format01</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'0.000'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">3.1415926</span><span class="sh_symbol">,</span> <span class="sh_variable">$format01</span><span class="sh_symbol">);</span>    <span class="sh_comment"># 3.142</span>

    <span class="sh_variable">$format02</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'#,##0'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1234.56</span><span class="sh_symbol">,</span>   <span class="sh_variable">$format02</span><span class="sh_symbol">);</span>    <span class="sh_comment"># 1,235</span>

    <span class="sh_variable">$format03</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'#,##0.00'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1234.56</span><span class="sh_symbol">,</span>   <span class="sh_variable">$format03</span><span class="sh_symbol">);</span>    <span class="sh_comment"># 1,234.56</span>

    <span class="sh_variable">$format04</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'$0.00'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">49.99</span><span class="sh_symbol">,</span>     <span class="sh_variable">$format04</span><span class="sh_symbol">);</span>    <span class="sh_comment"># $49.99</span>

    <span class="sh_comment"># Note you can use other currency symbols such as the pound or yen as well.</span>
    <span class="sh_comment"># Other currencies may require the use of Unicode.</span>

    <span class="sh_variable">$format07</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'mm/dd/yy'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">6</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">36892.521</span><span class="sh_symbol">,</span> <span class="sh_variable">$format07</span><span class="sh_symbol">);</span>    <span class="sh_comment"># 01/01/01</span>

    <span class="sh_variable">$format08</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'mmm d yyyy'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">7</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">36892.521</span><span class="sh_symbol">,</span> <span class="sh_variable">$format08</span><span class="sh_symbol">);</span>    <span class="sh_comment"># Jan 1 2001</span>

    <span class="sh_variable">$format09</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'d mmmm yyyy'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">8</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">36892.521</span><span class="sh_symbol">,</span> <span class="sh_variable">$format09</span><span class="sh_symbol">);</span>    <span class="sh_comment"># 1 January 2001</span>

    <span class="sh_variable">$format10</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'dd/mm/yyyy hh:mm AM/PM'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">9</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">36892.521</span><span class="sh_symbol">,</span> <span class="sh_variable">$format10</span><span class="sh_symbol">);</span>    <span class="sh_comment"># 01/01/2001 12:30 AM</span>

    <span class="sh_variable">$format11</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'0 "dollar and" .00 "cents"'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1.87</span><span class="sh_symbol">,</span>      <span class="sh_variable">$format11</span><span class="sh_symbol">);</span>    <span class="sh_comment"># 1 dollar and .87 cents</span>

    <span class="sh_comment"># Conditional formatting</span>
    <span class="sh_variable">$format12</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'[Green]General;[Red]-General;General'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">11</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">123</span><span class="sh_symbol">,</span>       <span class="sh_variable">$format12</span><span class="sh_symbol">);</span>    <span class="sh_comment"># &gt; 0 Green</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">12</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_symbol">-</span><span class="sh_number">45</span><span class="sh_symbol">,</span>       <span class="sh_variable">$format12</span><span class="sh_symbol">);</span>    <span class="sh_comment"># &lt; 0 Red</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">13</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>         <span class="sh_variable">$format12</span><span class="sh_symbol">);</span>    <span class="sh_comment"># = 0 Default colour</span>

    <span class="sh_comment"># Zip code</span>
    <span class="sh_variable">$format13</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'00000'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">14</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'01209'</span><span class="sh_symbol">,</span>   <span class="sh_variable">$format13</span><span class="sh_symbol">);</span></pre>

<p>The number system used for dates is described in <a href="#DATES_AND_TIME_IN_EXCEL" class="podlinkpod">"DATES AND TIME IN EXCEL"</a>.</p>

<p>The colour format should have one of the following values:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_symbol">[</span>Black<span class="sh_symbol">]</span> <span class="sh_symbol">[</span>Blue<span class="sh_symbol">]</span> <span class="sh_symbol">[</span>Cyan<span class="sh_symbol">]</span> <span class="sh_symbol">[</span>Green<span class="sh_symbol">]</span> <span class="sh_symbol">[</span>Magenta<span class="sh_symbol">]</span> <span class="sh_symbol">[</span>Red<span class="sh_symbol">]</span> <span class="sh_symbol">[</span>White<span class="sh_symbol">]</span> <span class="sh_symbol">[</span>Yellow<span class="sh_symbol">]</span></pre>

<p>Alternatively you can specify the colour based on a colour index as follows: <code>[Color n]</code>, where n is a standard Excel colour index - 7. See the 'Standard colors' worksheet created by formats.pl.</p>

<p>For more information refer to the documentation on formatting in the <code>docs</code> directory of the Spreadsheet::WriteExcel distro, the Excel on-line help or <a href="http://office.microsoft.com/en-gb/assistance/HP051995001033.aspx" class="podlinkurl">http://office.microsoft.com/en-gb/assistance/HP051995001033.aspx</a>.</p>

<p>You should ensure that the format string is valid in Excel prior to using it in WriteExcel.</p>

<p>Excel's built-in formats are shown in the following table:</p>

<pre class="sh_perl sh_sourceCode">    Index   Index   Format String
    <span class="sh_number">0</span>       <span class="sh_number">0x00</span>    General
    <span class="sh_number">1</span>       <span class="sh_number">0x01</span>    <span class="sh_number">0</span>
    <span class="sh_number">2</span>       <span class="sh_number">0x02</span>    <span class="sh_number">0.00</span>
    <span class="sh_number">3</span>       <span class="sh_number">0x03</span>    <span class="sh_comment">#,##0</span>
    <span class="sh_number">4</span>       <span class="sh_number">0x04</span>    <span class="sh_comment">#,##0.00</span>
    <span class="sh_number">5</span>       <span class="sh_number">0x05</span>    <span class="sh_symbol">(</span>$<span class="sh_comment">#,##0_);($#,##0)</span>
    <span class="sh_number">6</span>       <span class="sh_number">0x06</span>    <span class="sh_symbol">(</span>$<span class="sh_comment">#,##0_);[Red]($#,##0)</span>
    <span class="sh_number">7</span>       <span class="sh_number">0x07</span>    <span class="sh_symbol">(</span>$<span class="sh_comment">#,##0.00_);($#,##0.00)</span>
    <span class="sh_number">8</span>       <span class="sh_number">0x08</span>    <span class="sh_symbol">(</span>$<span class="sh_comment">#,##0.00_);[Red]($#,##0.00)</span>
    <span class="sh_number">9</span>       <span class="sh_number">0x09</span>    <span class="sh_number">0</span><span class="sh_symbol">%</span>
    <span class="sh_number">10</span>      <span class="sh_number">0x0a</span>    <span class="sh_number">0.00</span><span class="sh_symbol">%</span>
    <span class="sh_number">11</span>      <span class="sh_number">0x0b</span>    <span class="sh_number">0.00E+00</span>
    <span class="sh_number">12</span>      <span class="sh_number">0x0c</span>    <span class="sh_comment"># ?/?</span>
    <span class="sh_number">13</span>      <span class="sh_number">0x0d</span>    <span class="sh_comment"># ??/??</span>
    <span class="sh_number">14</span>      <span class="sh_number">0x0e</span>    <span class="sh_keyword">m</span><span class="sh_regexp">/d/</span>yy
    <span class="sh_number">15</span>      <span class="sh_number">0x0f</span>    d<span class="sh_symbol">-</span>mmm<span class="sh_symbol">-</span>yy
    <span class="sh_number">16</span>      <span class="sh_number">0x10</span>    d<span class="sh_symbol">-</span>mmm
    <span class="sh_number">17</span>      <span class="sh_number">0x11</span>    mmm<span class="sh_symbol">-</span>yy
    <span class="sh_number">18</span>      <span class="sh_number">0x12</span>    h<span class="sh_symbol">:</span>mm AM<span class="sh_symbol">/</span>PM
    <span class="sh_number">19</span>      <span class="sh_number">0x13</span>    h<span class="sh_symbol">:</span>mm<span class="sh_symbol">:</span>ss AM<span class="sh_symbol">/</span>PM
    <span class="sh_number">20</span>      <span class="sh_number">0x14</span>    h<span class="sh_symbol">:</span>mm
    <span class="sh_number">21</span>      <span class="sh_number">0x15</span>    h<span class="sh_symbol">:</span>mm<span class="sh_symbol">:</span>ss
    <span class="sh_number">22</span>      <span class="sh_number">0x16</span>    <span class="sh_keyword">m</span><span class="sh_regexp">/d/</span>yy h<span class="sh_symbol">:</span>mm
    <span class="sh_symbol">..</span>      <span class="sh_symbol">....</span>    <span class="sh_symbol">...........</span>
    <span class="sh_number">37</span>      <span class="sh_number">0x25</span>    <span class="sh_symbol">(</span><span class="sh_comment">#,##0_);(#,##0)</span>
    <span class="sh_number">38</span>      <span class="sh_number">0x26</span>    <span class="sh_symbol">(</span><span class="sh_comment">#,##0_);[Red](#,##0)</span>
    <span class="sh_number">39</span>      <span class="sh_number">0x27</span>    <span class="sh_symbol">(</span><span class="sh_comment">#,##0.00_);(#,##0.00)</span>
    <span class="sh_number">40</span>      <span class="sh_number">0x28</span>    <span class="sh_symbol">(</span><span class="sh_comment">#,##0.00_);[Red](#,##0.00)</span>
    <span class="sh_number">41</span>      <span class="sh_number">0x29</span>    <span class="sh_function">_</span><span class="sh_symbol">(*</span> <span class="sh_comment">#,##0_);_(* (#,##0);_(* "-"_);_(@_)</span>
    <span class="sh_number">42</span>      <span class="sh_number">0x2a</span>    <span class="sh_function">_</span><span class="sh_symbol">(</span>$<span class="sh_symbol">*</span> <span class="sh_comment">#,##0_);_($* (#,##0);_($* "-"_);_(@_)</span>
    <span class="sh_number">43</span>      <span class="sh_number">0x2b</span>    <span class="sh_function">_</span><span class="sh_symbol">(*</span> <span class="sh_comment">#,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)</span>
    <span class="sh_number">44</span>      <span class="sh_number">0x2c</span>    <span class="sh_function">_</span><span class="sh_symbol">(</span>$<span class="sh_symbol">*</span> <span class="sh_comment">#,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)</span>
    <span class="sh_number">45</span>      <span class="sh_number">0x2d</span>    mm<span class="sh_symbol">:</span>ss
    <span class="sh_number">46</span>      <span class="sh_number">0x2e</span>    <span class="sh_symbol">[</span>h<span class="sh_symbol">]:</span>mm<span class="sh_symbol">:</span>ss
    <span class="sh_number">47</span>      <span class="sh_number">0x2f</span>    mm<span class="sh_symbol">:</span>ss<span class="sh_number">.0</span>
    <span class="sh_number">48</span>      <span class="sh_number">0x30</span>    <span class="sh_comment">##0.0E+0</span>
    <span class="sh_number">49</span>      <span class="sh_number">0x31</span>    @</pre>

<p>For examples of these formatting codes see the 'Numerical formats' 
worksheet created by formats.pl. See also the number_formats1.html and 
the number_formats2.html documents in the <code>docs</code> directory of the distro.</p>

<p>Note 1. Numeric formats 23 to 36 are not documented by Microsoft and may differ in international versions.</p>

<p>Note 2. In Excel 5 the dollar sign appears as a dollar sign. In Excel 97-2000 it appears as the defined local currency symbol.</p>

<p>Note 3. The red negative numeric formats display slightly differently in Excel 5 and Excel 97-2000.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_locked()">set_locked()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Cell locking is on
    Default action<span class="sh_symbol">:</span>     Turn locking on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span></pre>

<p>This property can be used to prevent modification of a cells 
contents. Following Excel's convention, cell locking is turned on by 
default. However, it only has an effect if the worksheet has been 
protected, see the worksheet <code>protect()</code> method.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$locked</span>  <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$locked</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_locked</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># A non-op</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$unlocked</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$locked</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_locked</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Enable worksheet protection</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">protect</span><span class="sh_symbol">();</span>

    <span class="sh_comment"># This cell cannot be edited.</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'=1+2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$locked</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># This cell can be edited.</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span> <span class="sh_string">'=1+2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$unlocked</span><span class="sh_symbol">);</span></pre>

<p>Note: This offers weak protection even with a password, see the note in relation to the <code>protect()</code> method.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_hidden()">set_hidden()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Formula hiding is off
    Default action<span class="sh_symbol">:</span>     Turn hiding on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span></pre>

<p>This property is used to hide a formula while still displaying its 
result. This is generally used to hide complex calculations from end 
users who are only interested in the result. It only has an effect if 
the worksheet has been protected, see the worksheet <code>protect()</code> method.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$hidden</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$hidden</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_hidden</span><span class="sh_symbol">();</span>

    <span class="sh_comment"># Enable worksheet protection</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">protect</span><span class="sh_symbol">();</span>

    <span class="sh_comment"># The formula in this cell isn't visible</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'=1+2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$hidden</span><span class="sh_symbol">);</span></pre>

<p>Note: This offers weak protection even with a password, see the note in relation to the <code>protect()</code> method.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_align()">set_align()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Alignment is off
    Default action<span class="sh_symbol">:</span>     Left alignment
    Valid args<span class="sh_symbol">:</span>         <span class="sh_string">'left'</span>              Horizontal
                        <span class="sh_string">'center'</span>
                        <span class="sh_string">'right'</span>
                        <span class="sh_string">'fill'</span>
                        <span class="sh_string">'justify'</span>
                        <span class="sh_string">'center_across'</span>

                        <span class="sh_string">'top'</span>               Vertical
                        <span class="sh_string">'vcenter'</span>
                        <span class="sh_string">'bottom'</span>
                        <span class="sh_string">'vjustify'</span></pre>

<p>This method is used to set the horizontal and vertical text alignment
 within a cell. Vertical and horizontal alignments can be combined. The 
method is used as follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_align</span><span class="sh_symbol">(</span><span class="sh_string">'center'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_align</span><span class="sh_symbol">(</span><span class="sh_string">'vcenter'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">30</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'X'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>Text can be aligned across two or more adjacent cells using the <code>center_across</code> property. However, for genuine merged cells it is better to use the <code>merge_range()</code> worksheet method.</p>

<p>The <code>vjustify</code> (vertical justify) option can be used to 
provide automatic text wrapping in a cell. The height of the cell will 
be adjusted to accommodate the wrapped text. To specify where the text 
wraps use the <code>set_text_wrap()</code> method.</p>

<p>For further examples see the 'Alignment' worksheet created by formats.pl.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_center_across()">set_center_across()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Center across selection is off
    Default action<span class="sh_symbol">:</span>     Turn center across on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">1</span></pre>

<p>Text can be aligned across two or more adjacent cells using the <code>set_center_across()</code> method. This is an alias for the <code>set_align('center_across')</code> method call.</p>

<p>Only one cell should contain the text, the other cells should be blank:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_center_across</span><span class="sh_symbol">();</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_string">'Center across selection'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_blank</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>See also the <code>merge1.pl</code> to <code>merge6.pl</code> programs in the <code>examples</code> directory and the <code>merge_range()</code> method.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_text_wrap()">set_text_wrap()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Text wrap is off
    Default action<span class="sh_symbol">:</span>     Turn text wrap on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span></pre>

<p>Here is an example using the text wrap property, the escape character <code>\n</code> is used to indicate the end of line:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_text_wrap</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">"It's\na bum\nwrap"</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>Excel will adjust the height of the row to accommodate the wrapped 
text. A similar effect can be obtained without newlines using the <code>set_align('vjustify')</code> method. See the <code>textwrap.pl</code> program in the <code>examples</code> directory.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_rotation()">set_rotation()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Text rotation is off
    Default action<span class="sh_symbol">:</span>     None
    Valid args<span class="sh_symbol">:</span>         Integers in the range <span class="sh_symbol">-</span><span class="sh_number">90</span> to <span class="sh_number">90</span> <span class="sh_keyword">and</span> <span class="sh_number">270</span></pre>

<p>Set the rotation of the text in a cell. The rotation can be any angle in the range -90 to 90 degrees.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_rotation</span><span class="sh_symbol">(</span><span class="sh_number">30</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'This text is rotated'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>The angle 270 is also supported. This indicates text where the letters run from top to bottom.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_indent()">set_indent()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Text indentation is off
    Default action<span class="sh_symbol">:</span>     Indent text <span class="sh_number">1</span> level
    Valid args<span class="sh_symbol">:</span>         Positive integers</pre>

<p>This method can be used to indent text. The argument, which should be an integer, is taken as the level of indentation:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_indent</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'This text is indented'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>Indentation is a horizontal alignment property. It will override any 
other horizontal properties but it can be used in conjunction with 
vertical properties.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_shrink()">set_shrink()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Text shrinking is off
    Default action<span class="sh_symbol">:</span>     Turn <span class="sh_string">"shrink to fit"</span> on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">1</span></pre>

<p>This method can be used to shrink text so that it fits in a cell.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_shrink</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Honey, I shrunk the text!'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_text_justlast()">set_text_justlast()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Justify <span class="sh_keyword">last</span> is off
    Default action<span class="sh_symbol">:</span>     Turn justify <span class="sh_keyword">last</span> on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span></pre>

<p>Only applies to Far Eastern versions of Excel.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_pattern()">set_pattern()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Pattern is off
    Default action<span class="sh_symbol">:</span>     Solid fill is on
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0</span> <span class="sh_symbol">..</span> <span class="sh_number">18</span></pre>

<p>Set the background pattern of a cell.</p>

<p>Examples of the available patterns are shown in the 'Patterns' 
worksheet created by formats.pl. However, it is unlikely that you will 
ever need anything other than Pattern 1 which is a solid fill of the 
background color.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_bg_color()">set_bg_color()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Color is off
    Default action<span class="sh_symbol">:</span>     Solid fill<span class="sh_symbol">.</span>
    Valid args<span class="sh_symbol">:</span>         See <span class="sh_function">set_color</span><span class="sh_symbol">()</span></pre>

<p>The <code>set_bg_color()</code> method can be used to set the background colour of a pattern. Patterns are defined via the <code>set_pattern()</code> method. If a pattern hasn't been defined then a solid fill pattern is used as the default.</p>

<p>Here is an example of how to set up a solid fill in a cell:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>

    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_pattern</span><span class="sh_symbol">();</span> <span class="sh_comment"># This is optional when using a solid fill</span>

    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bg_color</span><span class="sh_symbol">(</span><span class="sh_string">'green'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'Ray'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>For further examples see the 'Patterns' worksheet created by formats.pl.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_fg_color()">set_fg_color()</a></h2>

<pre class="sh_perl sh_sourceCode">    Default state<span class="sh_symbol">:</span>      Color is off
    Default action<span class="sh_symbol">:</span>     Solid fill<span class="sh_symbol">.</span>
    Valid args<span class="sh_symbol">:</span>         See <span class="sh_function">set_color</span><span class="sh_symbol">()</span></pre>

<p>The <code>set_fg_color()</code> method can be used to set the foreground colour of a pattern.</p>

<p>For further examples see the 'Patterns' worksheet created by formats.pl.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_border()">set_border()</a></h2>

<pre class="sh_perl sh_sourceCode">    Also applies to<span class="sh_symbol">:</span>    <span class="sh_function">set_bottom</span><span class="sh_symbol">()</span>
                        <span class="sh_function">set_top</span><span class="sh_symbol">()</span>
                        <span class="sh_function">set_left</span><span class="sh_symbol">()</span>
                        <span class="sh_function">set_right</span><span class="sh_symbol">()</span>

    Default state<span class="sh_symbol">:</span>      Border is off
    Default action<span class="sh_symbol">:</span>     Set border type <span class="sh_number">1</span>
    Valid args<span class="sh_symbol">:</span>         <span class="sh_number">0-13</span><span class="sh_symbol">,</span> See below<span class="sh_symbol">.</span></pre>

<p>A cell border is comprised of a border on the bottom, top, left and right. These can be set to the same value using <code>set_border()</code> or individually using the relevant method calls shown above.</p>

<p>The following shows the border styles sorted by Spreadsheet::WriteExcel index number:</p>

<pre class="sh_perl sh_sourceCode">    Index   Name            Weight   Style
    <span class="sh_symbol">=====</span>   <span class="sh_symbol">=============</span>   <span class="sh_symbol">======</span>   <span class="sh_symbol">===========</span>
    <span class="sh_number">0</span>       None            <span class="sh_number">0</span>
    <span class="sh_number">1</span>       Continuous      <span class="sh_number">1</span>        <span class="sh_symbol">-----------</span>
    <span class="sh_number">2</span>       Continuous      <span class="sh_number">2</span>        <span class="sh_symbol">-----------</span>
    <span class="sh_number">3</span>       Dash            <span class="sh_number">1</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span>
    <span class="sh_number">4</span>       Dot             <span class="sh_number">1</span>        <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span>
    <span class="sh_number">5</span>       Continuous      <span class="sh_number">3</span>        <span class="sh_symbol">-----------</span>
    <span class="sh_number">6</span>       Double          <span class="sh_number">3</span>        <span class="sh_symbol">===========</span>
    <span class="sh_number">7</span>       Continuous      <span class="sh_number">0</span>        <span class="sh_symbol">-----------</span>
    <span class="sh_number">8</span>       Dash            <span class="sh_number">2</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span>
    <span class="sh_number">9</span>       Dash Dot        <span class="sh_number">1</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span>
    <span class="sh_number">10</span>      Dash Dot        <span class="sh_number">2</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span>
    <span class="sh_number">11</span>      Dash Dot Dot    <span class="sh_number">1</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span>
    <span class="sh_number">12</span>      Dash Dot Dot    <span class="sh_number">2</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span>
    <span class="sh_number">13</span>      SlantDash Dot   <span class="sh_number">2</span>        <span class="sh_string">/ - . /</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span></pre>

<p>The following shows the borders sorted by style:</p>

<pre class="sh_perl sh_sourceCode">    Name            Weight   Style         Index
    <span class="sh_symbol">=============</span>   <span class="sh_symbol">======</span>   <span class="sh_symbol">===========</span>   <span class="sh_symbol">=====</span>
    Continuous      <span class="sh_number">0</span>        <span class="sh_symbol">-----------</span>   <span class="sh_number">7</span>
    Continuous      <span class="sh_number">1</span>        <span class="sh_symbol">-----------</span>   <span class="sh_number">1</span>
    Continuous      <span class="sh_number">2</span>        <span class="sh_symbol">-----------</span>   <span class="sh_number">2</span>
    Continuous      <span class="sh_number">3</span>        <span class="sh_symbol">-----------</span>   <span class="sh_number">5</span>
    Dash            <span class="sh_number">1</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span>   <span class="sh_number">3</span>
    Dash            <span class="sh_number">2</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span>   <span class="sh_number">8</span>
    Dash Dot        <span class="sh_number">1</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span>   <span class="sh_number">9</span>
    Dash Dot        <span class="sh_number">2</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span>   <span class="sh_number">10</span>
    Dash Dot Dot    <span class="sh_number">1</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span>   <span class="sh_number">11</span>
    Dash Dot Dot    <span class="sh_number">2</span>        <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span>   <span class="sh_number">12</span>
    Dot             <span class="sh_number">1</span>        <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span>   <span class="sh_number">4</span>
    Double          <span class="sh_number">3</span>        <span class="sh_symbol">===========</span>   <span class="sh_number">6</span>
    None            <span class="sh_number">0</span>                      <span class="sh_number">0</span>
    SlantDash Dot   <span class="sh_number">2</span>        <span class="sh_string">/ - . /</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span>   <span class="sh_number">13</span></pre>

<p>The following shows the borders in the order shown in the Excel Dialog.</p>

<pre class="sh_perl sh_sourceCode">    Index   Style             Index   Style
    <span class="sh_symbol">=====</span>   <span class="sh_symbol">=====</span>             <span class="sh_symbol">=====</span>   <span class="sh_symbol">=====</span>
    <span class="sh_number">0</span>       None              <span class="sh_number">12</span>      <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span>
    <span class="sh_number">7</span>       <span class="sh_symbol">-----------</span>       <span class="sh_number">13</span>      <span class="sh_string">/ - . /</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span>
    <span class="sh_number">4</span>       <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span>       <span class="sh_number">10</span>      <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span>
    <span class="sh_number">11</span>      <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">.</span>       <span class="sh_number">8</span>       <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span>
    <span class="sh_number">9</span>       <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span> <span class="sh_symbol">-</span> <span class="sh_symbol">.</span>       <span class="sh_number">2</span>       <span class="sh_symbol">-----------</span>
    <span class="sh_number">3</span>       <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span> <span class="sh_symbol">-</span>       <span class="sh_number">5</span>       <span class="sh_symbol">-----------</span>
    <span class="sh_number">1</span>       <span class="sh_symbol">-----------</span>       <span class="sh_number">6</span>       <span class="sh_symbol">===========</span></pre>

<p>Examples of the available border styles are shown in the 'Borders' worksheet created by formats.pl.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="set_border_color()">set_border_color()</a></h2>

<pre class="sh_perl sh_sourceCode">    Also applies to<span class="sh_symbol">:</span>    <span class="sh_function">set_bottom_color</span><span class="sh_symbol">()</span>
                        <span class="sh_function">set_top_color</span><span class="sh_symbol">()</span>
                        <span class="sh_function">set_left_color</span><span class="sh_symbol">()</span>
                        <span class="sh_function">set_right_color</span><span class="sh_symbol">()</span>

    Default state<span class="sh_symbol">:</span>      Color is off
    Default action<span class="sh_symbol">:</span>     Undefined
    Valid args<span class="sh_symbol">:</span>         See <span class="sh_function">set_color</span><span class="sh_symbol">()</span></pre>

<p>Set the colour of the cell borders. A cell border is comprised of a 
border on the bottom, top, left and right. These can be set to the same 
colour using <code>set_border_color()</code> or individually using the 
relevant method calls shown above. Examples of the border styles and 
colours are shown in the 'Borders' worksheet created by formats.pl.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="copy($format)">copy($format)</a></h2>

<p>This method is used to copy all of the properties from one Format object to another:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$lorry1</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$lorry1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$lorry1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_italic</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$lorry1</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_color</span><span class="sh_symbol">(</span><span class="sh_string">'red'</span><span class="sh_symbol">);</span>    <span class="sh_comment"># lorry1 is bold, italic and red</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$lorry2</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$lorry2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">copy</span><span class="sh_symbol">(</span><span class="sh_variable">$lorry1</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$lorry2</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_color</span><span class="sh_symbol">(</span><span class="sh_string">'yellow'</span><span class="sh_symbol">);</span> <span class="sh_comment"># lorry2 is bold, italic and yellow</span></pre>

<p>The <code>copy()</code> method is only useful if you are using the 
method interface to Format properties. It generally isn't required if 
you are setting Format properties directly using hashes.</p>

<p>Note: this is not a copy constructor, both objects must exist prior to copying.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="UNICODE_IN_EXCEL">UNICODE IN EXCEL <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>The following is a brief introduction to handling Unicode in <code>Spreadsheet::WriteExcel</code>.</p>

<p><i>For a more general introduction to Unicode handling in Perl see</i> <a href="http://search.cpan.org/perldoc?perlunitut" class="podlinkpod">perlunitut</a> and <a href="http://search.cpan.org/perldoc?perluniintro" class="podlinkpod">perluniintro</a>.</p>

<p>When using Spreadsheet::WriteExcel the best and easiest way to write unicode strings to an Excel file is to use <code>UTF-8</code>
 encoded strings and perl 5.8 (or later). Spreadsheet::WriteExcel also 
allows you to write unicode strings using older perls but it generally 
requires more work, as explained below.</p>

<p>Internally, Excel encodes unicode data as <code>UTF-16LE</code> (where LE means little-endian). If you are using perl 5.8+ then Spreadsheet::WriteExcel will convert <code>UTF-8</code> strings to <code>UTF-16LE</code> when required. No further intervention is required from the programmer, for example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># perl 5.8+ example:</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$smiley</span> <span class="sh_symbol">=</span> <span class="sh_string">"\x{263A}"</span><span class="sh_symbol">;</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello world'</span><span class="sh_symbol">);</span> <span class="sh_comment"># ASCII</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$smiley</span><span class="sh_symbol">);</span>       <span class="sh_comment"># UTF-8</span></pre>

<p>Spreadsheet::WriteExcel also lets you write unicode data as <code>UTF-16</code>. Since the majority of CPAN modules default to <code>UTF-16BE</code> (big-endian) Spreadsheet::WriteExcel also uses <code>UTF-16BE</code> and converts it internally to <code>UTF-16LE</code>:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># perl 5.005 example:</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$smiley</span> <span class="sh_symbol">=</span> <span class="sh_keyword">pack</span> <span class="sh_string">'n'</span><span class="sh_symbol">,</span> <span class="sh_number">0x263A</span><span class="sh_symbol">;</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span>               <span class="sh_symbol">(</span><span class="sh_string">'A3'</span><span class="sh_symbol">,</span> <span class="sh_string">'Hello world'</span><span class="sh_symbol">);</span> <span class="sh_comment"># ASCII</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_utf16be_string</span><span class="sh_symbol">(</span><span class="sh_string">'A4'</span><span class="sh_symbol">,</span> <span class="sh_variable">$smiley</span><span class="sh_symbol">);</span>       <span class="sh_comment"># UTF-16</span></pre>

<p>Although the above examples look similar there is an important difference. With <code>uft8</code> and perl 5.8+ Spreadsheet::WriteExcel treats <code>UTF-8</code> strings in exactly the same way as any other string. However, with <code>UTF16</code>
 data we need to distinguish it from other strings either by calling a 
separate function or by passing an additional flag to indicate the data 
type.</p>

<p>If you are dealing with non-ASCII characters that aren't in <code>UTF-8</code> then perl 5.8+ provides useful tools in the guise of the <code>Encode</code> module to help you to convert to the required format. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">use</span> Encode <span class="sh_string">'decode'</span><span class="sh_symbol">;</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$string</span> <span class="sh_symbol">=</span> <span class="sh_string">'some string with koi8-r characters'</span><span class="sh_symbol">;</span>
       <span class="sh_variable">$string</span> <span class="sh_symbol">=</span> <span class="sh_function">decode</span><span class="sh_symbol">(</span><span class="sh_string">'koi8-r'</span><span class="sh_symbol">,</span> <span class="sh_variable">$string</span><span class="sh_symbol">);</span> <span class="sh_comment"># koi8-r to utf8</span></pre>

<p>Alternatively you can read data from an encoded file and convert it to <code>UTF-8</code> as you read it in:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$file</span> <span class="sh_symbol">=</span> <span class="sh_string">'unicode_koi8r.txt'</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">open</span> FH<span class="sh_symbol">,</span> <span class="sh_string">'&lt;:encoding(koi8-r)'</span><span class="sh_symbol">,</span> <span class="sh_variable">$file</span>  or <span class="sh_keyword">die</span> <span class="sh_string">"Couldn't open $file: $!\n"</span><span class="sh_symbol">;</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$row</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">while</span> <span class="sh_symbol">(</span><span class="sh_string">&lt;FH&gt;</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_comment"># Data read in is now in utf8 format.</span>
        <span class="sh_keyword">chomp</span><span class="sh_symbol">;</span>
        <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_variable">$row</span><span class="sh_symbol">++,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_variable">$_</span><span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span></pre>

<p>These methodologies are explained in more detail in <a href="http://search.cpan.org/perldoc?perlunitut" class="podlinkpod">perlunitut</a>, <a href="http://search.cpan.org/perldoc?perluniintro" class="podlinkpod">perluniintro</a> and <a href="http://search.cpan.org/perldoc?perlunicode" class="podlinkpod">perlunicode</a>.</p>

<p>See also the <code>unicode_*.pl</code> programs in the examples directory of the distro.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="COLOURS_IN_EXCEL">COLOURS IN EXCEL <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Excel provides a colour palette of 56 colours. In 
Spreadsheet::WriteExcel these colours are accessed via their palette 
index in the range 8..63. This index is used to set the colour of fonts,
 cell patterns and cell borders. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>
                                        color <span class="sh_symbol">=&gt;</span> <span class="sh_number">12</span><span class="sh_symbol">,</span> <span class="sh_comment"># index for blue</span>
                                        font  <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Arial'</span><span class="sh_symbol">,</span>
                                        size  <span class="sh_symbol">=&gt;</span> <span class="sh_number">12</span><span class="sh_symbol">,</span>
                                        bold  <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
                                     <span class="sh_symbol">);</span></pre>

<p>The most commonly used colours can also be accessed by name. The name acts as a simple alias for the colour index:</p>

<pre class="sh_perl sh_sourceCode">    black     <span class="sh_symbol">=&gt;</span>    <span class="sh_number">8</span>
    blue      <span class="sh_symbol">=&gt;</span>   <span class="sh_number">12</span>
    brown     <span class="sh_symbol">=&gt;</span>   <span class="sh_number">16</span>
    cyan      <span class="sh_symbol">=&gt;</span>   <span class="sh_number">15</span>
    gray      <span class="sh_symbol">=&gt;</span>   <span class="sh_number">23</span>
    green     <span class="sh_symbol">=&gt;</span>   <span class="sh_number">17</span>
    lime      <span class="sh_symbol">=&gt;</span>   <span class="sh_number">11</span>
    magenta   <span class="sh_symbol">=&gt;</span>   <span class="sh_number">14</span>
    navy      <span class="sh_symbol">=&gt;</span>   <span class="sh_number">18</span>
    orange    <span class="sh_symbol">=&gt;</span>   <span class="sh_number">53</span>
    pink      <span class="sh_symbol">=&gt;</span>   <span class="sh_number">33</span>
    purple    <span class="sh_symbol">=&gt;</span>   <span class="sh_number">20</span>
    red       <span class="sh_symbol">=&gt;</span>   <span class="sh_number">10</span>
    silver    <span class="sh_symbol">=&gt;</span>   <span class="sh_number">22</span>
    white     <span class="sh_symbol">=&gt;</span>    <span class="sh_number">9</span>
    yellow    <span class="sh_symbol">=&gt;</span>   <span class="sh_number">13</span></pre>

<p>For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$font</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>color <span class="sh_symbol">=&gt;</span> <span class="sh_string">'red'</span><span class="sh_symbol">);</span></pre>

<p>Users of VBA in Excel should note that the equivalent colour indices are in the range 1..56 instead of 8..63.</p>

<p>If the default palette does not provide a required colour you can 
override one of the built-in values. This is achieved by using the <code>set_custom_color()</code> workbook method to adjust the RGB (red green blue) components of the colour:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$ferrari</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_custom_color</span><span class="sh_symbol">(</span><span class="sh_number">40</span><span class="sh_symbol">,</span> <span class="sh_number">216</span><span class="sh_symbol">,</span> <span class="sh_number">12</span><span class="sh_symbol">,</span> <span class="sh_number">12</span><span class="sh_symbol">);</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span>  <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>
                                        bg_color <span class="sh_symbol">=&gt;</span> <span class="sh_variable">$ferrari</span><span class="sh_symbol">,</span>
                                        pattern  <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
                                        border   <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span>
                                      <span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_blank</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>The default Excel colour palette is shown in <code>palette.html</code> in the <code>docs</code> directory of the distro. You can generate an Excel version of the palette using <code>colors.pl</code> in the <code>examples</code> directory.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="DATES_AND_TIME_IN_EXCEL">DATES AND TIME IN EXCEL <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>There are two important things to understand about dates and times in Excel:</p>

<dl>
<dt><a name="1"></a><a name="1_A_date/time_in_Excel_is_a_real_number_plus_an_Excel_number_format.">1 A date/time in Excel is a real number plus an Excel number format.</a></dt>

<dd>
</dd><dt><a name="2"></a><a name="2_Spreadsheet::WriteExcel_doesn't_automatically_convert_date/time_strings_in_write()_to_an_Excel_date/time.">2 Spreadsheet::WriteExcel doesn't automatically convert date/time strings in <code>write()</code> to an Excel date/time.</a></dt>
</dl>

<p>These two points are explained in more detail below along with some 
suggestions on how to convert times and dates to the required format.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="An_Excel_date/time_is_a_number_plus_a_format">An Excel date/time is a number plus a format</a></h2>

<p>If you write a date string with <code>write()</code> then all you will get is a string:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'02/03/04'</span><span class="sh_symbol">);</span> <span class="sh_comment"># !! Writes a string not a date. !!</span></pre>

<p>Dates and times in Excel are represented by real numbers, for example
 "Jan 1 2001 12:30 AM" is represented by the number 36892.521.</p>

<p>The integer part of the number stores the number of days since the 
epoch and the fractional part stores the percentage of the day.</p>

<p>A date or time in Excel is just like any other number. To have the 
number display as a date you must apply an Excel number format to it. 
Here are some examples.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment">#!/usr/bin/perl -w</span>

    <span class="sh_keyword">use</span> strict<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'date_examples.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'A:A'</span><span class="sh_symbol">,</span> <span class="sh_number">30</span><span class="sh_symbol">);</span> <span class="sh_comment"># For extra visibility.</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$number</span>    <span class="sh_symbol">=</span> <span class="sh_number">39506.5</span><span class="sh_symbol">;</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_variable">$number</span><span class="sh_symbol">);</span>            <span class="sh_comment">#     39506.5</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$format2</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>num_format <span class="sh_symbol">=&gt;</span> <span class="sh_string">'dd/mm/yy'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span> <span class="sh_variable">$number</span> <span class="sh_symbol">,</span> <span class="sh_variable">$format2</span><span class="sh_symbol">);</span> <span class="sh_comment">#     28/02/08</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$format3</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>num_format <span class="sh_symbol">=&gt;</span> <span class="sh_string">'mm/dd/yy'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A3'</span><span class="sh_symbol">,</span> <span class="sh_variable">$number</span> <span class="sh_symbol">,</span> <span class="sh_variable">$format3</span><span class="sh_symbol">);</span> <span class="sh_comment">#     02/28/08</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$format4</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>num_format <span class="sh_symbol">=&gt;</span> <span class="sh_string">'d-m-yyyy'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A4'</span><span class="sh_symbol">,</span> <span class="sh_variable">$number</span> <span class="sh_symbol">,</span> <span class="sh_variable">$format4</span><span class="sh_symbol">);</span> <span class="sh_comment">#     28-2-2008</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$format5</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>num_format <span class="sh_symbol">=&gt;</span> <span class="sh_string">'dd/mm/yy hh:mm'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A5'</span><span class="sh_symbol">,</span> <span class="sh_variable">$number</span> <span class="sh_symbol">,</span> <span class="sh_variable">$format5</span><span class="sh_symbol">);</span> <span class="sh_comment">#     28/02/08 12:00</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$format6</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>num_format <span class="sh_symbol">=&gt;</span> <span class="sh_string">'d mmm yyyy'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A6'</span><span class="sh_symbol">,</span> <span class="sh_variable">$number</span> <span class="sh_symbol">,</span> <span class="sh_variable">$format6</span><span class="sh_symbol">);</span> <span class="sh_comment">#     28 Feb 2008</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$format7</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>num_format <span class="sh_symbol">=&gt;</span> <span class="sh_string">'mmm d yyyy hh:mm AM/PM'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A7'</span><span class="sh_symbol">,</span> <span class="sh_variable">$number</span> <span class="sh_symbol">,</span> <span class="sh_variable">$format7</span><span class="sh_symbol">);</span> <span class="sh_comment">#     Feb 28 2008 12:00 PM</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Spreadsheet::WriteExcel_doesn't_automatically_convert_date/time_strings">Spreadsheet::WriteExcel doesn't automatically convert date/time strings</a></h2>

<p>Spreadsheet::WriteExcel doesn't automatically convert input date 
strings into Excel's formatted date numbers due to the large number of 
possible date formats and also due to the possibility of 
misinterpretation.</p>

<p>For example, does <code>02/03/04</code> mean March 2 2004, February 3 2004 or even March 4 2002.</p>

<p>Therefore, in order to handle dates you will have to convert them to 
numbers and apply an Excel format. Some methods for converting dates are
 listed in the next section.</p>

<p>The most direct way is to convert your dates to the ISO8601 <code>yyyy-mm-ddThh:mm:ss.sss</code> date format and use the <code>write_date_time()</code> worksheet method:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_date_time</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span> <span class="sh_string">'2001-01-01T12:20'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>See the <code>write_date_time()</code> section of the documentation for more details.</p>

<p>A general methodology for handling date strings with <code>write_date_time()</code> is:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_number">1</span><span class="sh_symbol">.</span> Identify incoming date<span class="sh_symbol">/</span>time strings with a regex<span class="sh_symbol">.</span>
    <span class="sh_number">2</span><span class="sh_symbol">.</span> Extract the component parts of the date<span class="sh_symbol">/</span>time using the same regex<span class="sh_symbol">.</span>
    <span class="sh_number">3</span><span class="sh_symbol">.</span> Convert the date<span class="sh_symbol">/</span>time to the ISO8601 <span class="sh_keyword">format</span><span class="sh_symbol">.</span>
    <span class="sh_number">4</span><span class="sh_symbol">.</span> Write the date<span class="sh_symbol">/</span>time using <span class="sh_function">write_date_time</span><span class="sh_symbol">()</span> <span class="sh_keyword">and</span> a number <span class="sh_keyword">format</span><span class="sh_symbol">.</span></pre>

<p>Here is an example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment">#!/usr/bin/perl -w</span>

    <span class="sh_keyword">use</span> strict<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>    <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'example.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span>   <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>

    <span class="sh_comment"># Set the default format for dates.</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$date_format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">(</span>num_format <span class="sh_symbol">=&gt;</span> <span class="sh_string">'mmm d yyyy'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Increase column width to improve visibility of data.</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'A:C'</span><span class="sh_symbol">,</span> <span class="sh_number">20</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Simulate reading from a data source.</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$row</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>

    <span class="sh_keyword">while</span> <span class="sh_symbol">(</span><span class="sh_string">&lt;DATA&gt;</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_keyword">chomp</span><span class="sh_symbol">;</span>

        <span class="sh_keyword">my</span> <span class="sh_variable">$col</span>  <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
        <span class="sh_keyword">my</span> <span class="sh_variable">@data</span> <span class="sh_symbol">=</span> <span class="sh_keyword">split</span> <span class="sh_string">' '</span><span class="sh_symbol">;</span>

        <span class="sh_keyword">for</span> <span class="sh_keyword">my</span> <span class="sh_variable">$item</span> <span class="sh_symbol">(</span><span class="sh_variable">@data</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>

            <span class="sh_comment"># Match dates in the following formats: d/m/yy, d/m/yyyy</span>
            <span class="sh_keyword">if</span> <span class="sh_symbol">(</span><span class="sh_variable">$item</span> <span class="sh_symbol">=~</span> <span class="sh_keyword">qr</span><span class="sh_regexp">[^(\d{1,2})/(\d{1,2})/(\d{4})$]</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>

                <span class="sh_comment"># Change to the date format required by write_date_time().</span>
                <span class="sh_keyword">my</span> <span class="sh_variable">$date</span> <span class="sh_symbol">=</span> <span class="sh_keyword">sprintf</span> <span class="sh_string">"%4d-%02d-%02dT"</span><span class="sh_symbol">,</span> <span class="sh_variable">$3</span><span class="sh_symbol">,</span> <span class="sh_variable">$2</span><span class="sh_symbol">,</span> <span class="sh_variable">$1</span><span class="sh_symbol">;</span>

                <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_date_time</span><span class="sh_symbol">(</span><span class="sh_variable">$row</span><span class="sh_symbol">,</span> <span class="sh_variable">$col</span><span class="sh_symbol">++,</span> <span class="sh_variable">$date</span><span class="sh_symbol">,</span> <span class="sh_variable">$date_format</span><span class="sh_symbol">);</span>
            <span class="sh_cbracket">}</span>
            <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span>
                <span class="sh_comment"># Just plain data</span>
                <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_variable">$row</span><span class="sh_symbol">,</span> <span class="sh_variable">$col</span><span class="sh_symbol">++,</span> <span class="sh_variable">$item</span><span class="sh_symbol">);</span>
            <span class="sh_cbracket">}</span>
        <span class="sh_cbracket">}</span>
        <span class="sh_variable">$row</span><span class="sh_symbol">++;</span>
    <span class="sh_cbracket">}</span>

    __DATA__
    Item    Cost    Date
    Book    <span class="sh_number">10</span>      <span class="sh_number">1</span><span class="sh_string">/9/</span><span class="sh_number">2007</span>
    Beer    <span class="sh_number">4</span>       <span class="sh_number">12</span><span class="sh_string">/9/</span><span class="sh_number">2007</span>
    Bed     <span class="sh_number">500</span>     <span class="sh_number">5</span><span class="sh_string">/10/</span><span class="sh_number">2007</span></pre>

<p>For a slightly more advanced solution you can modify the <code>write()</code> method to handle date formats of your choice via the <code>add_write_handler()</code> method. See the <code>add_write_handler()</code> section of the docs and the write_handler3.pl and write_handler4.pl programs in the examples directory of the distro.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Converting_dates_and_times_to_an_Excel_date_or_time">Converting dates and times to an Excel date or time</a></h2>

<p>The <code>write_date_time()</code> method above is just one way of handling dates and times.</p>

<p>The <a href="http://search.cpan.org/%7Ejmcnamara/Spreadsheet-WriteExcel-2.38/lib/Spreadsheet/WriteExcel/Utility.pm" class="podlinkpod">Spreadsheet::WriteExcel::Utility</a> module which is included in the distro has date/time handling functions:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">::</span>Utility<span class="sh_symbol">;</span>

    <span class="sh_variable">$date</span>           <span class="sh_symbol">=</span> <span class="sh_function">xl_date_list</span><span class="sh_symbol">(</span><span class="sh_number">2002</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>         <span class="sh_comment"># 37257</span>
    <span class="sh_variable">$date</span>           <span class="sh_symbol">=</span> <span class="sh_function">xl_parse_date</span><span class="sh_symbol">(</span><span class="sh_string">"11 July 1997"</span><span class="sh_symbol">);</span>    <span class="sh_comment"># 35622</span>
    <span class="sh_variable">$time</span>           <span class="sh_symbol">=</span> <span class="sh_function">xl_parse_time</span><span class="sh_symbol">(</span><span class="sh_string">'3:21:36 PM'</span><span class="sh_symbol">);</span>      <span class="sh_comment"># 0.64</span>
    <span class="sh_variable">$date</span>           <span class="sh_symbol">=</span> <span class="sh_function">xl_decode_date_EU</span><span class="sh_symbol">(</span><span class="sh_string">"13 May 2002"</span><span class="sh_symbol">);</span> <span class="sh_comment"># 37389</span></pre>

<p>Note: some of these functions require additional CPAN modules.</p>

<p>For date conversions using the CPAN <code>DateTime</code> framework see <a href="http://search.cpan.org/perldoc?DateTime%3A%3AFormat%3A%3AExcel" class="podlinkpod">DateTime::Format::Excel</a> <a href="http://search.cpan.org/search?dist=DateTime-Format-Excel" class="podlinkurl">http://search.cpan.org/search?dist=DateTime-Format-Excel</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="OUTLINES_AND_GROUPING_IN_EXCEL">OUTLINES AND GROUPING IN EXCEL <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Excel allows you to group rows or columns so that they can be hidden 
or displayed with a single mouse click. This feature is referred to as 
outlines.</p>

<p>Outlines can reduce complex data down to a few salient sub-totals or summaries.</p>

<p>This feature is best viewed in Excel but the following is an ASCII 
representation of what a worksheet with three outlines might look like. 
Rows 3-4 and rows 7-8 are grouped at level 2. Rows 2-9 are grouped at 
level 1. The lines at the left hand side are called outline level bars.</p>

<pre class="sh_perl sh_sourceCode">            <span class="sh_symbol">------------------------------------------</span>
     <span class="sh_number">1</span> <span class="sh_number">2</span> <span class="sh_number">3</span> <span class="sh_symbol">|</span>   <span class="sh_symbol">|</span>   A   <span class="sh_symbol">|</span>   B   <span class="sh_symbol">|</span>   C   <span class="sh_symbol">|</span>   D   <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
            <span class="sh_symbol">------------------------------------------</span>
      _    <span class="sh_symbol">|</span> <span class="sh_number">1</span> <span class="sh_symbol">|</span>   A   <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span>  _  <span class="sh_symbol">|</span> <span class="sh_number">2</span> <span class="sh_symbol">|</span>   B   <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span> <span class="sh_symbol">|</span>   <span class="sh_symbol">|</span> <span class="sh_number">3</span> <span class="sh_symbol">|</span>  <span class="sh_symbol">(</span>C<span class="sh_symbol">)</span>  <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span> <span class="sh_symbol">|</span>   <span class="sh_symbol">|</span> <span class="sh_number">4</span> <span class="sh_symbol">|</span>  <span class="sh_symbol">(</span>D<span class="sh_symbol">)</span>  <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span> <span class="sh_symbol">-</span>   <span class="sh_symbol">|</span> <span class="sh_number">5</span> <span class="sh_symbol">|</span>   E   <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span>  _  <span class="sh_symbol">|</span> <span class="sh_number">6</span> <span class="sh_symbol">|</span>   F   <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span> <span class="sh_symbol">|</span>   <span class="sh_symbol">|</span> <span class="sh_number">7</span> <span class="sh_symbol">|</span>  <span class="sh_symbol">(</span>G<span class="sh_symbol">)</span>  <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span> <span class="sh_symbol">|</span>   <span class="sh_symbol">|</span> <span class="sh_number">8</span> <span class="sh_symbol">|</span>  <span class="sh_symbol">(</span>H<span class="sh_symbol">)</span>  <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span> <span class="sh_symbol">-</span>   <span class="sh_symbol">|</span> <span class="sh_number">9</span> <span class="sh_symbol">|</span>   I   <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">-</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">.</span> <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span></pre>

<p>Clicking the minus sign on each of the level 2 outlines will collapse
 and hide the data as shown in the next figure. The minus sign changes 
to a plus sign to indicate that the data in the outline is hidden.</p>

<pre class="sh_perl sh_sourceCode">            <span class="sh_symbol">------------------------------------------</span>
     <span class="sh_number">1</span> <span class="sh_number">2</span> <span class="sh_number">3</span> <span class="sh_symbol">|</span>   <span class="sh_symbol">|</span>   A   <span class="sh_symbol">|</span>   B   <span class="sh_symbol">|</span>   C   <span class="sh_symbol">|</span>   D   <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
            <span class="sh_symbol">------------------------------------------</span>
      _    <span class="sh_symbol">|</span> <span class="sh_number">1</span> <span class="sh_symbol">|</span>   A   <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span>     <span class="sh_symbol">|</span> <span class="sh_number">2</span> <span class="sh_symbol">|</span>   B   <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span> <span class="sh_symbol">+</span>   <span class="sh_symbol">|</span> <span class="sh_number">5</span> <span class="sh_symbol">|</span>   E   <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span>     <span class="sh_symbol">|</span> <span class="sh_number">6</span> <span class="sh_symbol">|</span>   F   <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">|</span> <span class="sh_symbol">+</span>   <span class="sh_symbol">|</span> <span class="sh_number">9</span> <span class="sh_symbol">|</span>   I   <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">-</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">.</span> <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span></pre>

<p>Clicking on the minus sign on the level 1 outline will collapse the remaining rows as follows:</p>

<pre class="sh_perl sh_sourceCode">            <span class="sh_symbol">------------------------------------------</span>
     <span class="sh_number">1</span> <span class="sh_number">2</span> <span class="sh_number">3</span> <span class="sh_symbol">|</span>   <span class="sh_symbol">|</span>   A   <span class="sh_symbol">|</span>   B   <span class="sh_symbol">|</span>   C   <span class="sh_symbol">|</span>   D   <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
            <span class="sh_symbol">------------------------------------------</span>
           <span class="sh_symbol">|</span> <span class="sh_number">1</span> <span class="sh_symbol">|</span>   A   <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>       <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>
     <span class="sh_symbol">+</span>     <span class="sh_symbol">|</span> <span class="sh_symbol">.</span> <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span>  <span class="sh_symbol">|</span>  <span class="sh_symbol">...</span></pre>

<p>Grouping in <code>Spreadsheet::WriteExcel</code> is achieved by setting the outline level via the <code>set_row()</code> and <code>set_column()</code> worksheet methods:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_variable">$row</span><span class="sh_symbol">,</span> <span class="sh_variable">$height</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_variable">$hidden</span><span class="sh_symbol">,</span> <span class="sh_variable">$level</span><span class="sh_symbol">,</span> <span class="sh_variable">$collapsed</span><span class="sh_symbol">)</span>
    <span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_variable">$first_col</span><span class="sh_symbol">,</span> <span class="sh_variable">$last_col</span><span class="sh_symbol">,</span> <span class="sh_variable">$width</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_variable">$hidden</span><span class="sh_symbol">,</span> <span class="sh_variable">$level</span><span class="sh_symbol">,</span> <span class="sh_variable">$collapsed</span><span class="sh_symbol">)</span></pre>

<p>The following example sets an outline level of 1 for rows 1 and 2 (zero-indexed) and columns B to G. The parameters <code>$height</code> and <code>$XF</code> are assigned default values since they are undefined:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'B:G'</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p>Excel allows up to 7 outline levels. Therefore the <code>$level</code> parameter should be in the range <code>0 &lt;= $level &lt;= 7</code>.</p>

<p>Rows and columns can be collapsed by setting the <code>$hidden</code> flag for the hidden rows/columns and setting the <code>$collapsed</code> flag for the row/column that has the collapsed <code>+</code> symbol:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_row</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>        <span class="sh_comment"># Collapsed flag.</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'B:G'</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_string">'H:H'</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_keyword">undef</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span> <span class="sh_comment"># Collapsed flag.</span></pre>

<p>Note: Setting the <code>$collapsed</code> flag is particularly important for compatibility with OpenOffice.org and Gnumeric.</p>

<p>For a more complete example see the <code>outline.pl</code> and <code>outline_collapsed.pl</code> programs in the examples directory of the distro.</p>

<p>Some additional outline properties can be set via the <code>outline_settings()</code> worksheet method, see above.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="DATA_VALIDATION_IN_EXCEL">DATA VALIDATION IN EXCEL <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Data validation is a feature of Excel which allows you to restrict 
the data that a users enters in a cell and to display help and warning 
messages. It also allows you to restrict input to values in a drop down 
list.</p>

<p>A typical use case might be to restrict data in a cell to integer 
values in a certain range, to provide a help message to indicate the 
required value and to issue a warning if the input data doesn't meet the
 stated criteria. In Spreadsheet::WriteExcel we could do that as 
follows:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'B3'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">{</span>
            validate        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
            criteria        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'between'</span><span class="sh_symbol">,</span>
            minimum         <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
            maximum         <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span>
            input_title     <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Input an integer:'</span><span class="sh_symbol">,</span>
            input_message   <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Between 1 and 100'</span><span class="sh_symbol">,</span>
            error_message   <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Sorry, try again.'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<p>The above example would look like this in Excel: <a href="http://homepage.eircom.net/%7Ejmcnamara/perl/data_validation.jpg" class="podlinkurl">http://homepage.eircom.net/~jmcnamara/perl/data_validation.jpg</a>.</p>




<p>For more information on data validation see the following Microsoft 
support article "Description and examples of data validation in Excel": <a href="http://support.microsoft.com/kb/211485" class="podlinkurl">http://support.microsoft.com/kb/211485</a>.</p>

<p>The following sections describe how to use the <code>data_validation()</code> method and its various options.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="data_validation($row,_$col,_{_parameter_=&gt;_'value',_..._})">data_validation($row, $col, { parameter =&gt; 'value', ... })</a></h2>

<p>The <code>data_validation()</code> method is used to construct an Excel data validation.</p>

<p>It can be applied to a single cell or a range of cells. You can pass 3 parameters such as <code>($row, $col, {...})</code> or 5 parameters such as <code>($first_row, $first_col, $last_row, $last_col, {...})</code>. You can also use <code>A1</code> style notation. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>       <span class="sh_cbracket">{</span><span class="sh_symbol">...</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">4</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_cbracket">{</span><span class="sh_symbol">...</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Which are the same as:</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span>       <span class="sh_cbracket">{</span><span class="sh_symbol">...</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'A1:B5'</span><span class="sh_symbol">,</span>    <span class="sh_cbracket">{</span><span class="sh_symbol">...</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<p>See also the note about <a href="#Cell_notation" class="podlinkpod">"Cell notation"</a> for more information.</p>

<p>The last parameter in <code>data_validation()</code> must be a hash 
ref containing the parameters that describe the type and style of the 
data validation. The allowable parameters are:</p>

<pre class="sh_perl sh_sourceCode">    validate
    criteria
    value <span class="sh_symbol">|</span> minimum <span class="sh_symbol">|</span> source
    maximum
    ignore_blank
    dropdown

    input_title
    input_message
    show_input

    error_title
    error_message
    error_type
    show_error</pre>

<p>These parameters are explained in the following sections. Most of the
 parameters are optional, however, you will generally require the three 
main options <code>validate</code>, <code>criteria</code> and <code>value</code>.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'B3'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">{</span>
            validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
            criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span>
            value    <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<p>The <code>data_validation</code> method returns:</p>

<pre class="sh_perl sh_sourceCode">     <span class="sh_number">0</span> <span class="sh_keyword">for</span> success<span class="sh_symbol">.</span>
    <span class="sh_symbol">-</span><span class="sh_number">1</span> <span class="sh_keyword">for</span> insufficient number of arguments<span class="sh_symbol">.</span>
    <span class="sh_symbol">-</span><span class="sh_number">2</span> <span class="sh_keyword">for</span> row or column out of bounds<span class="sh_symbol">.</span>
    <span class="sh_symbol">-</span><span class="sh_number">3</span> <span class="sh_keyword">for</span> incorrect parameter or value<span class="sh_symbol">.</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="validate">validate</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>validate</code> parameter is used to set the type of data 
that you wish to validate. It is always required and it has no default 
value. Allowable values are:</p>

<pre class="sh_perl sh_sourceCode">    any
    integer
    decimal
    list
    date
    time
    <span class="sh_keyword">length</span>
    custom</pre>

<ul>
<li><b>any</b> is used to specify that the type of data is unrestricted.
 This is the same as not applying a data validation. It is only provided
 for completeness and isn't used very often in the context of 
Spreadsheet::WriteExcel.</li>

<li><b>integer</b> restricts the cell to integer values. Excel refers to this as 'whole number'.
<pre class="sh_perl sh_sourceCode">    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
    criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span></pre>
</li>

<li><b>decimal</b> restricts the cell to decimal values.
<pre class="sh_perl sh_sourceCode">    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'decimal'</span><span class="sh_symbol">,</span>
    criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_number">38.6</span><span class="sh_symbol">,</span></pre>
</li>

<li><b>list</b> restricts the cell to a set of user specified values. 
These can be passed in an array ref or as a cell range (named ranges 
aren't currently supported):
<pre class="sh_perl sh_sourceCode">    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'list'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_symbol">[</span><span class="sh_string">'open'</span><span class="sh_symbol">,</span> <span class="sh_string">'high'</span><span class="sh_symbol">,</span> <span class="sh_string">'close'</span><span class="sh_symbol">],</span>
    <span class="sh_comment"># Or like this:</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_string">'B1:B3'</span><span class="sh_symbol">,</span></pre>

<p>Excel requires that range references are only to cells on the same worksheet.</p>
</li>

<li><b>date</b> restricts the cell to date values. Dates in Excel are 
expressed as integer values but you can also pass an ISO860 style string
 as used in <code>write_date_time()</code>. See also <a href="#DATES_AND_TIME_IN_EXCEL" class="podlinkpod">"DATES AND TIME IN EXCEL"</a> for more information about working with Excel's dates.
<pre class="sh_perl sh_sourceCode">    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'date'</span><span class="sh_symbol">,</span>
    criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_number">39653</span><span class="sh_symbol">,</span> <span class="sh_comment"># 24 July 2008</span>
    <span class="sh_comment"># Or like this:</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_string">'2008-07-24T'</span><span class="sh_symbol">,</span></pre>
</li>

<li><b>time</b> restricts the cell to time values. Times in Excel are 
expressed as decimal values but you can also pass an ISO860 style string
 as used in <code>write_date_time()</code>. See also <a href="#DATES_AND_TIME_IN_EXCEL" class="podlinkpod">"DATES AND TIME IN EXCEL"</a> for more information about working with Excel's times.
<pre class="sh_perl sh_sourceCode">    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'time'</span><span class="sh_symbol">,</span>
    criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_number">0.5</span><span class="sh_symbol">,</span> <span class="sh_comment"># Noon</span>
    <span class="sh_comment"># Or like this:</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_string">'T12:00:00'</span><span class="sh_symbol">,</span></pre>
</li>

<li><b>length</b> restricts the cell data based on an integer string length. Excel refers to this as 'Text length'.
<pre class="sh_perl sh_sourceCode">    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'length'</span><span class="sh_symbol">,</span>
    criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_number">10</span><span class="sh_symbol">,</span></pre>
</li>

<li><b>custom</b> restricts the cell based on an external Excel formula that returns a <code>TRUE/FALSE</code> value.
<pre class="sh_perl sh_sourceCode">    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'custom'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_string">'=IF(A10&gt;B10,TRUE,FALSE)'</span><span class="sh_symbol">,</span></pre>
</li>
</ul>

<h2><a class="u" href="#___top" title="click to go to top of document" name="criteria">criteria</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>criteria</code> parameter is used to set the criteria by which the data in the cell is validated. It is almost always required except for the <code>list</code> and <code>custom</code> validate options. It has no default value. Allowable values are:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_string">'between'</span>
    <span class="sh_string">'not between'</span>
    <span class="sh_string">'equal to'</span>                  <span class="sh_symbol">|</span>  <span class="sh_string">'=='</span>  <span class="sh_symbol">|</span>  <span class="sh_string">'='</span>
    <span class="sh_string">'not equal to'</span>              <span class="sh_symbol">|</span>  <span class="sh_string">'!='</span>  <span class="sh_symbol">|</span>  <span class="sh_string">'&lt;&gt;'</span>
    <span class="sh_string">'greater than'</span>              <span class="sh_symbol">|</span>  <span class="sh_string">'&gt;'</span>
    <span class="sh_string">'less than'</span>                 <span class="sh_symbol">|</span>  <span class="sh_string">'&lt;'</span>
    <span class="sh_string">'greater than or equal to'</span>  <span class="sh_symbol">|</span>  <span class="sh_string">'&gt;='</span>
    <span class="sh_string">'less than or equal to'</span>     <span class="sh_symbol">|</span>  <span class="sh_string">'&lt;='</span></pre>

<p>You can either use Excel's textual description strings, in the first 
column above, or the more common operator alternatives. The following 
are equivalent:</p>

<pre class="sh_perl sh_sourceCode">    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
    criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'greater than'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span>

    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
    criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span></pre>

<p>The <code>list</code> and <code>custom</code> validate options don't require a <code>criteria</code>. If you specify one it will be ignored.</p>

<pre class="sh_perl sh_sourceCode">    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'list'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_symbol">[</span><span class="sh_string">'open'</span><span class="sh_symbol">,</span> <span class="sh_string">'high'</span><span class="sh_symbol">,</span> <span class="sh_string">'close'</span><span class="sh_symbol">],</span>

    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'custom'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_string">'=IF(A10&gt;B10,TRUE,FALSE)'</span><span class="sh_symbol">,</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="value_|_minimum_|_source">value | minimum | source</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>value</code> parameter is used to set the limiting value to which the <code>criteria</code> is applied. It is always required and it has no default value. You can also use the synonyms <code>minimum</code> or <code>source</code> to make the validation a little clearer and closer to Excel's description of the parameter:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment"># Use 'value'</span>
    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
    criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span>
    value    <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span>

    <span class="sh_comment"># Use 'minimum'</span>
    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
    criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'between'</span><span class="sh_symbol">,</span>
    minimum  <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
    maximum  <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span>

    <span class="sh_comment"># Use 'source'</span>
    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'list'</span><span class="sh_symbol">,</span>
    source   <span class="sh_symbol">=&gt;</span> <span class="sh_string">'$B$1:$B$3'</span><span class="sh_symbol">,</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="maximum">maximum</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>maximum</code> parameter is used to set the upper limiting value when the <code>criteria</code> is either <code>'between'</code> or <code>'not between'</code>:</p>

<pre class="sh_perl sh_sourceCode">    validate <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
    criteria <span class="sh_symbol">=&gt;</span> <span class="sh_string">'between'</span><span class="sh_symbol">,</span>
    minimum  <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
    maximum  <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="ignore_blank">ignore_blank</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>ignore_blank</code> parameter is used to toggle on and off 
the 'Ignore blank' option in the Excel data validation dialog. When the 
option is on the data validation is not applied to blank data in the 
cell. It is on by default.</p>

<pre class="sh_perl sh_sourceCode">    ignore_blank <span class="sh_symbol">=&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_comment"># Turn the option off</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="dropdown">dropdown</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>dropdown</code> parameter is used to toggle on and off the 
'In-cell dropdown' option in the Excel data validation dialog. When the 
option is on a dropdown list will be shown for <code>list</code> validations. It is on by default.</p>

<pre class="sh_perl sh_sourceCode">    dropdown <span class="sh_symbol">=&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>      <span class="sh_comment"># Turn the option off</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="input_title">input_title</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>input_title</code> parameter is used to set the title of 
the input message that is displayed when a cell is entered. It has no 
default value and is only displayed if the input message is displayed. 
See the <code>input_message</code> parameter below.</p>

<pre class="sh_perl sh_sourceCode">    input_title   <span class="sh_symbol">=&gt;</span> <span class="sh_string">'This is the input title'</span><span class="sh_symbol">,</span></pre>

<p>The maximum title length is 32 characters. UTF8 strings are handled automatically in perl 5.8 and later.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="input_message">input_message</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>input_message</code> parameter is used to set the input message that is displayed when a cell is entered. It has no default value.</p>

<pre class="sh_perl sh_sourceCode">    validate      <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
    criteria      <span class="sh_symbol">=&gt;</span> <span class="sh_string">'between'</span><span class="sh_symbol">,</span>
    minimum       <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
    maximum       <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span>
    input_title   <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Enter the applied discount:'</span><span class="sh_symbol">,</span>
    input_message <span class="sh_symbol">=&gt;</span> <span class="sh_string">'between 1 and 100'</span><span class="sh_symbol">,</span></pre>

<p>The message can be split over several lines using newlines, <code>"\n"</code> in double quoted strings.</p>

<pre class="sh_perl sh_sourceCode">    input_message <span class="sh_symbol">=&gt;</span> <span class="sh_string">"This is\na test."</span><span class="sh_symbol">,</span></pre>

<p>The maximum message length is 255 characters. UTF8 strings are handled automatically in perl 5.8 and later.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="show_input">show_input</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>show_input</code> parameter is used to toggle on and off 
the 'Show input message when cell is selected' option in the Excel data 
validation dialog. When the option is off an input message is not 
displayed even if it has been set using <code>input_message</code>. It is on by default.</p>

<pre class="sh_perl sh_sourceCode">    show_input <span class="sh_symbol">=&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>      <span class="sh_comment"># Turn the option off</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="error_title">error_title</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>error_title</code> parameter is used to set the title of 
the error message that is displayed when the data validation criteria is
 not met. The default error title is 'Microsoft Excel'.</p>

<pre class="sh_perl sh_sourceCode">    error_title   <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Input value is not valid'</span><span class="sh_symbol">,</span></pre>

<p>The maximum title length is 32 characters. UTF8 strings are handled automatically in perl 5.8 and later.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="error_message">error_message</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>error_message</code> parameter is used to set the error 
message that is displayed when a cell is entered. The default error 
message is "The value you entered is not valid.\nA user has restricted 
values that can be entered into the cell.".</p>

<pre class="sh_perl sh_sourceCode">    validate      <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
    criteria      <span class="sh_symbol">=&gt;</span> <span class="sh_string">'between'</span><span class="sh_symbol">,</span>
    minimum       <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
    maximum       <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span>
    error_title   <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Input value is not valid'</span><span class="sh_symbol">,</span>
    error_message <span class="sh_symbol">=&gt;</span> <span class="sh_string">'It should be an integer between 1 and 100'</span><span class="sh_symbol">,</span></pre>

<p>The message can be split over several lines using newlines, <code>"\n"</code> in double quoted strings.</p>

<pre class="sh_perl sh_sourceCode">    input_message <span class="sh_symbol">=&gt;</span> <span class="sh_string">"This is\na test."</span><span class="sh_symbol">,</span></pre>

<p>The maximum message length is 255 characters. UTF8 strings are handled automatically in perl 5.8 and later.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="error_type">error_type</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>error_type</code> parameter is used to specify the type of error dialog that is displayed. There are 3 options:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_string">'stop'</span>
    <span class="sh_string">'warning'</span>
    <span class="sh_string">'information'</span></pre>

<p>The default is <code>'stop'</code>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="show_error">show_error</a></h2>

<p>This parameter is passed in a hash ref to <code>data_validation()</code>.</p>

<p>The <code>show_error</code> parameter is used to toggle on and off 
the 'Show error alert after invalid data is entered' option in the Excel
 data validation dialog. When the option is off an error message is not 
displayed even if it has been set using <code>error_message</code>. It is on by default.</p>

<pre class="sh_perl sh_sourceCode">    show_error <span class="sh_symbol">=&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>      <span class="sh_comment"># Turn the option off</span></pre>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Data_Validation_Examples">Data Validation Examples</a></h2>

<p>Example 1. Limiting input to an integer greater than a fixed value.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">{</span>
            validate        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
            criteria        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span>
            value           <span class="sh_symbol">=&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<p>Example 2. Limiting input to an integer greater than a fixed value where the value is referenced from a cell.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'A2'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">{</span>
            validate        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
            criteria        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'&gt;'</span><span class="sh_symbol">,</span>
            value           <span class="sh_symbol">=&gt;</span> <span class="sh_string">'=E3'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<p>Example 3. Limiting input to a decimal in a fixed range.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'A3'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">{</span>
            validate        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'decimal'</span><span class="sh_symbol">,</span>
            criteria        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'between'</span><span class="sh_symbol">,</span>
            minimum         <span class="sh_symbol">=&gt;</span> <span class="sh_number">0.1</span><span class="sh_symbol">,</span>
            maximum         <span class="sh_symbol">=&gt;</span> <span class="sh_number">0.5</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<p>Example 4. Limiting input to a value in a dropdown list.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'A4'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">{</span>
            validate        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'list'</span><span class="sh_symbol">,</span>
            source          <span class="sh_symbol">=&gt;</span> <span class="sh_symbol">[</span><span class="sh_string">'open'</span><span class="sh_symbol">,</span> <span class="sh_string">'high'</span><span class="sh_symbol">,</span> <span class="sh_string">'close'</span><span class="sh_symbol">],</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<p>Example 5. Limiting input to a value in a dropdown list where the list is specified as a cell range.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'A5'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">{</span>
            validate        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'list'</span><span class="sh_symbol">,</span>
            source          <span class="sh_symbol">=&gt;</span> <span class="sh_string">'=E4:G4'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<p>Example 6. Limiting input to a date in a fixed range.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'A6'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">{</span>
            validate        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'date'</span><span class="sh_symbol">,</span>
            criteria        <span class="sh_symbol">=&gt;</span> <span class="sh_string">'between'</span><span class="sh_symbol">,</span>
            minimum         <span class="sh_symbol">=&gt;</span> <span class="sh_string">'2008-01-01T'</span><span class="sh_symbol">,</span>
            maximum         <span class="sh_symbol">=&gt;</span> <span class="sh_string">'2008-12-12T'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<p>Example 7. Displaying a message when the cell is selected.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">data_validation</span><span class="sh_symbol">(</span><span class="sh_string">'A7'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">{</span>
            validate      <span class="sh_symbol">=&gt;</span> <span class="sh_string">'integer'</span><span class="sh_symbol">,</span>
            criteria      <span class="sh_symbol">=&gt;</span> <span class="sh_string">'between'</span><span class="sh_symbol">,</span>
            minimum       <span class="sh_symbol">=&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">,</span>
            maximum       <span class="sh_symbol">=&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span>
            input_title   <span class="sh_symbol">=&gt;</span> <span class="sh_string">'Enter an integer:'</span><span class="sh_symbol">,</span>
            input_message <span class="sh_symbol">=&gt;</span> <span class="sh_string">'between 1 and 100'</span><span class="sh_symbol">,</span>
        <span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<p>See also the <code>data_validate.pl</code> program in the examples directory of the distro.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="ROW_HEIGHTS_AND_WORKSHEET_OBJECTS">ROW HEIGHTS AND WORKSHEET OBJECTS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>The following relates to worksheet objects such as images, comments and charts.</p>

<p>If you specify the height of a row that contains a worksheet object 
then Spreadsheet::WriteExcel will adjust the height of the object to 
maintain its default or user specified dimensions. In this way the 
object won't appear stretched or compressed in Excel.</p>

<p>However, Excel can also adjust the height of a row automatically if 
it contains cells that have the text wrap property set or contain large 
fonts. In these cases the height of the row is unknown to 
Spreadsheet::WriteExcel at execution time and the scaling calculations 
it performs are incorrect. The effect of this is that the object is 
stretched with the row when it is displayed in Excel.</p>

<p>In order to avoid this issue you should use the <code>set_row()</code> method to explicitly specify the height of any row that may otherwise be changed automatically by Excel.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="FORMULAS_AND_FUNCTIONS_IN_EXCEL">FORMULAS AND FUNCTIONS IN EXCEL <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Caveats">Caveats</a></h2>

<p>The first thing to note is that there are still some outstanding issues with the implementation of formulas and functions:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_number">1</span><span class="sh_symbol">.</span> Writing a formula is much slower than writing the equivalent string<span class="sh_symbol">.</span>
    <span class="sh_number">2</span><span class="sh_symbol">.</span> You cannot <span class="sh_keyword">use</span> array constants<span class="sh_symbol">,</span> <span class="sh_keyword">i</span><span class="sh_symbol">.</span>e<span class="sh_symbol">.</span> <span class="sh_cbracket">{</span><span class="sh_number">1</span><span class="sh_symbol">;</span><span class="sh_number">2</span><span class="sh_symbol">;</span><span class="sh_number">3</span><span class="sh_cbracket">}</span><span class="sh_symbol">,</span> in functions<span class="sh_symbol">.</span>
    <span class="sh_number">3</span><span class="sh_symbol">.</span> Unary minus isn<span class="sh_string">'t supported.</span>
    <span class="sh_number">4</span><span class="sh_symbol">.</span> Whitespace is not preserved around operators<span class="sh_symbol">.</span>
    <span class="sh_number">5</span><span class="sh_symbol">.</span> Named ranges are not supported<span class="sh_symbol">.</span>
    <span class="sh_number">6</span><span class="sh_symbol">.</span> Array formulas are not supported<span class="sh_symbol">.</span></pre>

<p>However, these constraints will be removed in future versions. They 
are here because of a trade-off between features and time. Also, it is 
possible to work around issue 1 using the <code>store_formula()</code> and <code>repeat_formula()</code> methods as described later in this section.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Introduction">Introduction</a></h2>

<p>The following is a brief introduction to formulas and functions in Excel and Spreadsheet::WriteExcel.</p>

<p>A formula is a string that begins with an equals sign:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_string">'=A1+B1'</span>
    <span class="sh_string">'=AVERAGE(1, 2, 3)'</span></pre>

<p>The formula can contain numbers, strings, boolean values, cell 
references, cell ranges and functions. Named ranges are not supported. 
Formulas should be written as they appear in Excel, that is cells and 
functions must be in uppercase.</p>

<p>Cells in Excel are referenced using the A1 notation system where the 
column is designated by a letter and the row by a number. Columns range 
from A to IV i.e. 0 to 255, rows range from 1 to 65536. The <code>Spreadsheet::WriteExcel::Utility</code> module that is included in the distro contains helper functions for dealing with A1 notation, for example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">::</span>Utility<span class="sh_symbol">;</span>

    <span class="sh_symbol">(</span><span class="sh_variable">$row</span><span class="sh_symbol">,</span> <span class="sh_variable">$col</span><span class="sh_symbol">)</span> <span class="sh_symbol">=</span> <span class="sh_function">xl_cell_to_rowcol</span><span class="sh_symbol">(</span><span class="sh_string">'C2'</span><span class="sh_symbol">);</span>  <span class="sh_comment"># (1, 2)</span>
    <span class="sh_variable">$str</span>         <span class="sh_symbol">=</span> <span class="sh_function">xl_rowcol_to_cell</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">);</span>  <span class="sh_comment"># C2</span></pre>

<p>The Excel <code>$</code> notation in cell references is also 
supported. This allows you to specify whether a row or column is 
relative or absolute. This only has an effect if the cell is copied. The
 following examples show relative and absolute values.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_string">'=A1'</span>   <span class="sh_comment"># Column and row are relative</span>
    <span class="sh_string">'=$A1'</span>  <span class="sh_comment"># Column is absolute and row is relative</span>
    <span class="sh_string">'=A$1'</span>  <span class="sh_comment"># Column is relative and row is absolute</span>
    <span class="sh_string">'=$A$1'</span> <span class="sh_comment"># Column and row are absolute</span></pre>

<p>Formulas can also refer to cells in other worksheets of the current workbook. For example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_string">'=Sheet2!A1'</span>
    <span class="sh_string">'=Sheet2!A1:A5'</span>
    <span class="sh_string">'=Sheet2:Sheet3!A1'</span>
    <span class="sh_string">'=Sheet2:Sheet3!A1:A5'</span>
    <span class="sh_keyword">q</span><span class="sh_string">{='Test Data'!A1}</span>
    <span class="sh_keyword">q</span><span class="sh_string">{='Test Data1:Test Data2'!A1}</span></pre>

<p>The sheet reference and the cell reference are separated by <code>!</code>
 the exclamation mark symbol. If worksheet names contain spaces, commas 
or parentheses then Excel requires that the name is enclosed in single 
quotes as shown in the last two examples above. In order to avoid using a
 lot of escape characters you can use the quote operator <code>q{}</code> to protect the quotes. See <code>perlop</code> in the main Perl documentation. Only valid sheet names that have been added using the <code>add_worksheet()</code> method can be used in formulas. You cannot reference external workbooks.</p>

<p>The following table lists the operators that are available in Excel's
 formulas. The majority of the operators are the same as Perl's, 
differences are indicated:</p>

<pre class="sh_perl sh_sourceCode">    Arithmetic operators<span class="sh_symbol">:</span>
    <span class="sh_symbol">=====================</span>
    Operator  Meaning                   Example
       <span class="sh_symbol">+</span>      Addition                  <span class="sh_number">1+2</span>
       <span class="sh_symbol">-</span>      Subtraction               <span class="sh_number">2-1</span>
       <span class="sh_symbol">*</span>      Multiplication            <span class="sh_number">2</span><span class="sh_symbol">*</span><span class="sh_number">3</span>
       <span class="sh_string">/      Division                  1/</span><span class="sh_number">4</span>
       <span class="sh_symbol">^</span>      Exponentiation            <span class="sh_number">2</span><span class="sh_symbol">^</span><span class="sh_number">3</span>      <span class="sh_comment"># Equivalent to **</span>
       <span class="sh_symbol">-</span>      Unary minus               <span class="sh_symbol">-(</span><span class="sh_number">1+2</span><span class="sh_symbol">)</span>   <span class="sh_comment"># Not yet supported</span>
       <span class="sh_symbol">%</span>      <span class="sh_function">Percent</span> <span class="sh_symbol">(</span>Not modulus<span class="sh_symbol">)</span>     <span class="sh_number">13</span><span class="sh_symbol">%</span>      <span class="sh_comment"># Not supported, [1]</span>


    Comparison operators<span class="sh_symbol">:</span>
    <span class="sh_symbol">=====================</span>
    Operator  Meaning                   Example
        <span class="sh_symbol">=</span>     Equal to                  A1 <span class="sh_symbol">=</span>  B1 <span class="sh_comment"># Equivalent to ==</span>
        <span class="sh_string">&lt;&gt;</span>    Not equal to              A1 <span class="sh_string">&lt;&gt;</span> B1 <span class="sh_comment"># Equivalent to !=</span>
        <span class="sh_symbol">&gt;</span>     Greater than              A1 <span class="sh_symbol">&gt;</span>  B1
        <span class="sh_string">&lt;     Less than                 A1 &lt;  B1</span>
        <span class="sh_symbol">&gt;=</span>    Greater than or equal to  A1 <span class="sh_symbol">&gt;=</span> B1
        <span class="sh_string">&lt;=    Less than or equal to     A1 &lt;= B1</span>


    String operator<span class="sh_symbol">:</span>
    <span class="sh_symbol">================</span>
    Operator  Meaning                   Example
        <span class="sh_symbol">&amp;</span>     Concatenation             <span class="sh_string">"Hello "</span> <span class="sh_symbol">&amp;</span> <span class="sh_string">"World!"</span> <span class="sh_comment"># [2]</span>


    Reference operators<span class="sh_symbol">:</span>
    <span class="sh_symbol">====================</span>
    Operator  Meaning                   Example
        <span class="sh_symbol">:</span>     Range operator            A1<span class="sh_symbol">:</span>A4               <span class="sh_comment"># [3]</span>
        <span class="sh_symbol">,</span>     Union operator            <span class="sh_function">SUM</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2+2</span><span class="sh_symbol">,</span> B3<span class="sh_symbol">)</span>     <span class="sh_comment"># [4]</span>


    Notes<span class="sh_symbol">:</span>
    <span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]:</span> You can get a percentage with formatting <span class="sh_keyword">and</span> modulus with <span class="sh_function">MOD</span><span class="sh_symbol">().</span>
    <span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">]:</span> Equivalent <span class="sh_function">to</span> <span class="sh_symbol">(</span><span class="sh_string">"Hello "</span> <span class="sh_symbol">.</span> <span class="sh_string">"World!"</span><span class="sh_symbol">)</span> in Perl<span class="sh_symbol">.</span>
    <span class="sh_symbol">[</span><span class="sh_number">3</span><span class="sh_symbol">]:</span> This range is equivalent to cells A1<span class="sh_symbol">,</span> A2<span class="sh_symbol">,</span> A3 <span class="sh_keyword">and</span> A4<span class="sh_symbol">.</span>
    <span class="sh_symbol">[</span><span class="sh_number">4</span><span class="sh_symbol">]:</span> The comma behaves like the list separator in Perl<span class="sh_symbol">.</span></pre>

<p>The range and comma operators can have different symbols in 
non-English versions of Excel. These will be supported in a later 
version of Spreadsheet::WriteExcel. European users of Excel take note:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'=SUM(1; 2; 3)'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Wrong!!</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'=SUM(1, 2, 3)'</span><span class="sh_symbol">);</span> <span class="sh_comment"># Okay</span></pre>

<p>The following table lists all of the core functions supported by 
Excel 5 and Spreadsheet::WriteExcel. Any additional functions that are 
available through the "Analysis ToolPak" or other add-ins are not 
supported. These functions have all been tested to verify that they 
work.</p>

<pre class="sh_perl sh_sourceCode">    ABS           DB            INDIRECT      NORMINV       SLN
    ACOS          DCOUNT        INFO          NORMSDIST     SLOPE
    ACOSH         DCOUNTA       INT           NORMSINV      SMALL
    ADDRESS       DDB           INTERCEPT     NOT           SQRT
    AND           DEGREES       IPMT          NOW           STANDARDIZE
    AREAS         DEVSQ         IRR           NPER          STDEV
    ASIN          DGET          ISBLANK       NPV           STDEVP
    ASINH         DMAX          ISERR         ODD           STEYX
    ATAN          DMIN          ISERROR       OFFSET        SUBSTITUTE
    ATAN2         DOLLAR        ISLOGICAL     OR            SUBTOTAL
    ATANH         DPRODUCT      ISNA          PEARSON       SUM
    AVEDEV        DSTDEV        ISNONTEXT     PERCENTILE    SUMIF
    AVERAGE       DSTDEVP       ISNUMBER      PERCENTRANK   SUMPRODUCT
    BETADIST      DSUM          ISREF         PERMUT        SUMSQ
    BETAINV       DVAR          ISTEXT        PI            SUMX2MY2
    BINOMDIST     DVARP         KURT          PMT           SUMX2PY2
    CALL          ERROR<span class="sh_symbol">.</span>TYPE    LARGE         POISSON       SUMXMY2
    CEILING       EVEN          LEFT          POWER         SYD
    CELL          EXACT         LEN           PPMT          T
    CHAR          EXP           LINEST        PROB          TAN
    CHIDIST       EXPONDIST     LN            PRODUCT       TANH
    CHIINV        FACT          LOG           PROPER        TDIST
    CHITEST       FALSE         LOG10         PV            TEXT
    CHOOSE        FDIST         LOGEST        QUARTILE      TIME
    CLEAN         FIND          LOGINV        RADIANS       TIMEVALUE
    CODE          FINV          LOGNORMDIST   RAND          TINV
    COLUMN        FISHER        LOOKUP        RANK          TODAY
    COLUMNS       FISHERINV     LOWER         RATE          TRANSPOSE
    COMBIN        FIXED         MATCH         REGISTER<span class="sh_symbol">.</span>ID   TREND
    CONCATENATE   FLOOR         MAX           REPLACE       TRIM
    CONFIDENCE    FORECAST      MDETERM       REPT          TRIMMEAN
    CORREL        FREQUENCY     MEDIAN        RIGHT         TRUE
    COS           FTEST         MID           ROMAN         TRUNC
    COSH          FV            MIN           ROUND         TTEST
    COUNT         GAMMADIST     MINUTE        ROUNDDOWN     TYPE
    COUNTA        GAMMAINV      MINVERSE      ROUNDUP       UPPER
    COUNTBLANK    GAMMALN       MIRR          ROW           VALUE
    COUNTIF       GEOMEAN       MMULT         ROWS          VAR
    COVAR         GROWTH        MOD           RSQ           VARP
    CRITBINOM     HARMEAN       MODE          SEARCH        VDB
    DATE          HLOOKUP       MONTH         SECOND        VLOOKUP
    DATEVALUE     HOUR          N             SIGN          WEEKDAY
    DAVERAGE      HYPGEOMDIST   NA            SIN           WEIBULL
    DAY           IF            NEGBINOMDIST  SINH          YEAR
    DAYS360       INDEX         NORMDIST      SKEW          ZTEST</pre>

<p>You can also modify the module to support function names in the 
following languages: German, French, Spanish, Portuguese, Dutch, 
Finnish, Italian and Swedish. See the <code>function_locale.pl</code> program in the <code>examples</code> directory of the distro.</p>

<p>For a general introduction to Excel's formulas and an explanation of 
the syntax of the function refer to the Excel help files or the 
following: <a href="http://office.microsoft.com/en-us/assistance/CH062528031033.aspx" class="podlinkurl">http://office.microsoft.com/en-us/assistance/CH062528031033.aspx</a>.</p>

<p>If your formula doesn't work in Spreadsheet::WriteExcel try the following:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_number">1</span><span class="sh_symbol">.</span> Verify that the formula works in <span class="sh_function">Excel</span> <span class="sh_symbol">(</span>or Gnumeric or OpenOffice<span class="sh_symbol">.</span>org<span class="sh_symbol">).</span>
    <span class="sh_number">2</span><span class="sh_symbol">.</span> Ensure that it isn<span class="sh_string">'t on the Caveats list shown above.</span>
    <span class="sh_number">3</span><span class="sh_symbol">.</span> Ensure that cell references <span class="sh_keyword">and</span> formula names are in uppercase<span class="sh_symbol">.</span>
    <span class="sh_number">4</span><span class="sh_symbol">.</span> Ensure that you are using <span class="sh_string">':'</span> as the range operator<span class="sh_symbol">,</span> A1<span class="sh_symbol">:</span>A4<span class="sh_symbol">.</span>
    <span class="sh_number">5</span><span class="sh_symbol">.</span> Ensure that you are using <span class="sh_string">','</span> as the union operator<span class="sh_symbol">,</span> <span class="sh_function">SUM</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span><span class="sh_number">2</span><span class="sh_symbol">,</span><span class="sh_number">3</span><span class="sh_symbol">).</span>
    <span class="sh_number">6</span><span class="sh_symbol">.</span> Ensure that the function is in the above table<span class="sh_symbol">.</span></pre>

<p>If you go through steps 1-6 and you still have a problem, mail me.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Improving_performance_when_working_with_formulas">Improving performance when working with formulas</a></h2>

<p>Writing a large number of formulas with Spreadsheet::WriteExcel can 
be slow. This is due to the fact that each formula has to be parsed and 
with the current implementation this is computationally expensive.</p>

<p>However, in a lot of cases the formulas that you write will be quite similar, for example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B1'</span><span class="sh_symbol">,</span>    <span class="sh_string">'=A1 * 3 + 50'</span><span class="sh_symbol">,</span>    <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B2'</span><span class="sh_symbol">,</span>    <span class="sh_string">'=A2 * 3 + 50'</span><span class="sh_symbol">,</span>    <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_symbol">...</span>
    <span class="sh_symbol">...</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B99'</span><span class="sh_symbol">,</span>   <span class="sh_string">'=A999 * 3 + 50'</span><span class="sh_symbol">,</span>  <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">write_formula</span><span class="sh_symbol">(</span><span class="sh_string">'B1000'</span><span class="sh_symbol">,</span> <span class="sh_string">'=A1000 * 3 + 50'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span></pre>

<p>In this example the cell reference changes in iterations from <code>A1</code> to <code>A1000</code>. The parser treats this variable as a <i>token</i>
 and arranges it according to predefined rules. However, since the 
parser is oblivious to the value of the token, it is essentially 
performing the same calculation 1000 times. This is inefficient.</p>

<p>The way to avoid this inefficiency and thereby speed up the writing 
of formulas is to parse the formula once and then repeatedly substitute 
similar tokens.</p>

<p>A formula can be parsed and stored via the <code>store_formula()</code> worksheet method. You can then use the <code>repeat_formula()</code> method to substitute <code>$pattern</code>, <code>$replace</code> pairs in the stored formula:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">my</span> <span class="sh_variable">$formula</span> <span class="sh_symbol">=</span> <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">store_formula</span><span class="sh_symbol">(</span><span class="sh_string">'=A1 * 3 + 50'</span><span class="sh_symbol">);</span>

    <span class="sh_keyword">for</span> <span class="sh_keyword">my</span> <span class="sh_variable">$row</span> <span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">..</span><span class="sh_number">999</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">repeat_formula</span><span class="sh_symbol">(</span><span class="sh_variable">$row</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_variable">$formula</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">,</span> <span class="sh_string">'A1'</span><span class="sh_symbol">,</span> <span class="sh_string">'A'</span><span class="sh_symbol">.(</span><span class="sh_variable">$row</span> <span class="sh_symbol">+</span><span class="sh_number">1</span><span class="sh_symbol">));</span>
    <span class="sh_cbracket">}</span></pre>

<p>On an arbitrary test machine this method was 10 times faster than the brute force method shown above.</p>

<p>For more information about how Spreadsheet::WriteExcel parses and stores formulas see the <code>Spreadsheet::WriteExcel::Formula</code> man page.</p>

<p>It should be noted however that the overall speed of direct formula parsing will be improved in a future version.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="EXAMPLES">EXAMPLES <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>See <a href="http://search.cpan.org/%7Ejmcnamara/Spreadsheet-WriteExcel-2.38/lib/Spreadsheet/WriteExcel/Examples.pm" class="podlinkpod">Spreadsheet::WriteExcel::Examples</a> for a full list of examples.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Example_1">Example 1</a></h2>

<p>The following example shows some of the basic features of Spreadsheet::WriteExcel.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment">#!/usr/bin/perl -w</span>

    <span class="sh_keyword">use</span> strict<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>

    <span class="sh_comment"># Create a new workbook called simple.xls and add a worksheet</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'simple.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>

    <span class="sh_comment"># The general syntax is write($row, $column, $token). Note that row and</span>
    <span class="sh_comment"># column are zero indexed</span>

    <span class="sh_comment"># Write some text</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_string">'Hi Excel!'</span><span class="sh_symbol">);</span>


    <span class="sh_comment"># Write some numbers</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_number">3</span><span class="sh_symbol">);</span>          <span class="sh_comment"># Writes 3</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_number">3.00000</span><span class="sh_symbol">);</span>    <span class="sh_comment"># Writes 3</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_number">3.00001</span><span class="sh_symbol">);</span>    <span class="sh_comment"># Writes 3.00001</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">5</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_number">3.14159</span><span class="sh_symbol">);</span>    <span class="sh_comment"># TeX revision no.?</span>


    <span class="sh_comment"># Write some formulas</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">7</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_string">'=A3 + A6'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">8</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>  <span class="sh_string">'=IF(A5&gt;3,"Yes", "No")'</span><span class="sh_symbol">);</span>


    <span class="sh_comment"># Write a hyperlink</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'</span><a href="http://www.perl.com/" class="podlinkurl"><span class="sh_string">http://www.perl.com/</span></a><span class="sh_string">'</span><span class="sh_symbol">);</span></pre>

<p></p><center><img src="WriteExcel.pm_files/a_simple.jpg" alt="Output from a_simple.pl" height="420" width="640"></center><p></p>


<h2><a class="u" href="#___top" title="click to go to top of document" name="Example_2">Example 2</a></h2>

<p>The following is a general example which demonstrates some features of working with multiple worksheets.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment">#!/usr/bin/perl -w</span>

    <span class="sh_keyword">use</span> strict<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>

    <span class="sh_comment"># Create a new Excel workbook</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span> <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'regions.xls'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Add some worksheets</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$north</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_string">'North'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$south</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_string">'South'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$east</span>  <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_string">'East'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$west</span>  <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_string">'West'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Add a Format</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_color</span><span class="sh_symbol">(</span><span class="sh_string">'blue'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Add a caption to each worksheet</span>
    <span class="sh_keyword">foreach</span> <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">(</span><span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">sheets</span><span class="sh_symbol">())</span> <span class="sh_cbracket">{</span>
        <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Sales'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>

    <span class="sh_comment"># Write some data</span>
    <span class="sh_variable">$north</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">200000</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$south</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">100000</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$east</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span> <span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">150000</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$west</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span> <span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">100000</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Set the active worksheet</span>
    <span class="sh_variable">$south</span><span class="sh_symbol">-&gt;</span><span class="sh_function">activate</span><span class="sh_symbol">();</span>

    <span class="sh_comment"># Set the width of the first column</span>
    <span class="sh_variable">$south</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">20</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Set the active cell</span>
    <span class="sh_variable">$south</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_selection</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span></pre>

<p></p><center><img src="WriteExcel.pm_files/regions.jpg" alt="Output from regions.pl" height="420" width="640"></center><p></p>


<h2><a class="u" href="#___top" title="click to go to top of document" name="Example_3">Example 3</a></h2>

<p>This example shows how to use a conditional numerical format with colours to indicate if a share price has gone up or down.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">use</span> strict<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>

    <span class="sh_comment"># Create a new workbook and add a worksheet</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'stocks.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>

    <span class="sh_comment"># Set the column width for columns 1, 2, 3 and 4</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">15</span><span class="sh_symbol">);</span>


    <span class="sh_comment"># Create a format for the column headings</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$header</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$header</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$header</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_size</span><span class="sh_symbol">(</span><span class="sh_number">12</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$header</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_color</span><span class="sh_symbol">(</span><span class="sh_string">'blue'</span><span class="sh_symbol">);</span>


    <span class="sh_comment"># Create a format for the stock price</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$f_price</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$f_price</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_align</span><span class="sh_symbol">(</span><span class="sh_string">'left'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$f_price</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'$0.00'</span><span class="sh_symbol">);</span>


    <span class="sh_comment"># Create a format for the stock volume</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$f_volume</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$f_volume</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_align</span><span class="sh_symbol">(</span><span class="sh_string">'left'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$f_volume</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'#,##0'</span><span class="sh_symbol">);</span>


    <span class="sh_comment"># Create a format for the price change. This is an example of a</span>
    <span class="sh_comment"># conditional format. The number is formatted as a percentage. If it is</span>
    <span class="sh_comment"># positive it is formatted in green, if it is negative it is formatted</span>
    <span class="sh_comment"># in red and if it is zero it is formatted as the default font colour</span>
    <span class="sh_comment"># (in this case black). Note: the [Green] format produces an unappealing</span>
    <span class="sh_comment"># lime green. Try [Color 10] instead for a dark green.</span>
    <span class="sh_comment">#</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$f_change</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$f_change</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_align</span><span class="sh_symbol">(</span><span class="sh_string">'left'</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$f_change</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_num_format</span><span class="sh_symbol">(</span><span class="sh_string">'[Green]0.0%;[Red]-0.0%;0.0%'</span><span class="sh_symbol">);</span>


    <span class="sh_comment"># Write out the data</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Company'</span><span class="sh_symbol">,</span><span class="sh_variable">$header</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_string">'Price'</span><span class="sh_symbol">,</span>  <span class="sh_variable">$header</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_string">'Volume'</span><span class="sh_symbol">,</span> <span class="sh_variable">$header</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_string">'Change'</span><span class="sh_symbol">,</span> <span class="sh_variable">$header</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Damage Inc.'</span>       <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">30.25</span><span class="sh_symbol">,</span>    <span class="sh_variable">$f_price</span> <span class="sh_symbol">);</span> <span class="sh_comment"># $30.25</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">1234567</span><span class="sh_symbol">,</span>  <span class="sh_variable">$f_volume</span><span class="sh_symbol">);</span> <span class="sh_comment"># 1,234,567</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">0.085</span><span class="sh_symbol">,</span>    <span class="sh_variable">$f_change</span><span class="sh_symbol">);</span> <span class="sh_comment"># 8.5% in green</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Dump Corp.'</span>        <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1.56</span><span class="sh_symbol">,</span>     <span class="sh_variable">$f_price</span> <span class="sh_symbol">);</span> <span class="sh_comment"># $1.56</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">7564</span><span class="sh_symbol">,</span>     <span class="sh_variable">$f_volume</span><span class="sh_symbol">);</span> <span class="sh_comment"># 7,564</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_symbol">-</span><span class="sh_number">0.015</span><span class="sh_symbol">,</span>   <span class="sh_variable">$f_change</span><span class="sh_symbol">);</span> <span class="sh_comment"># -1.5% in red</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Rev Ltd.'</span>          <span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0.13</span><span class="sh_symbol">,</span>     <span class="sh_variable">$f_price</span> <span class="sh_symbol">);</span> <span class="sh_comment"># $0.13</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">321</span><span class="sh_symbol">,</span>      <span class="sh_variable">$f_volume</span><span class="sh_symbol">);</span> <span class="sh_comment"># 321</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>        <span class="sh_variable">$f_change</span><span class="sh_symbol">);</span> <span class="sh_comment"># 0 in the font color (black)</span></pre>

<p></p><center><img src="WriteExcel.pm_files/stocks.jpg" alt="Output from stocks.pl" height="420" width="640"></center><p></p>


<h2><a class="u" href="#___top" title="click to go to top of document" name="Example_4">Example 4</a></h2>

<p>The following is a simple example of using functions.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment">#!/usr/bin/perl -w</span>

    <span class="sh_keyword">use</span> strict<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>

    <span class="sh_comment"># Create a new workbook and add a worksheet</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'stats.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">(</span><span class="sh_string">'Test data'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Set the column width for columns 1</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_column</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">20</span><span class="sh_symbol">);</span>


    <span class="sh_comment"># Create a format for the headings</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_format</span><span class="sh_symbol">();</span>
    <span class="sh_variable">$format</span><span class="sh_symbol">-&gt;</span><span class="sh_function">set_bold</span><span class="sh_symbol">();</span>


    <span class="sh_comment"># Write the sample data</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Sample'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">4</span><span class="sh_symbol">,</span> <span class="sh_number">4</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">5</span><span class="sh_symbol">,</span> <span class="sh_number">5</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">6</span><span class="sh_symbol">,</span> <span class="sh_number">6</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">7</span><span class="sh_symbol">,</span> <span class="sh_number">7</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">8</span><span class="sh_symbol">,</span> <span class="sh_number">8</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Length'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">25.4</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">25.4</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">24.8</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">4</span><span class="sh_symbol">,</span> <span class="sh_number">25.0</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">5</span><span class="sh_symbol">,</span> <span class="sh_number">25.3</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">6</span><span class="sh_symbol">,</span> <span class="sh_number">24.9</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">7</span><span class="sh_symbol">,</span> <span class="sh_number">25.2</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">8</span><span class="sh_symbol">,</span> <span class="sh_number">24.8</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Write some statistical functions</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Count'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">4</span><span class="sh_symbol">,</span>  <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_string">'=COUNT(B1:I1)'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">5</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Sum'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">5</span><span class="sh_symbol">,</span>  <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_string">'=SUM(B2:I2)'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">6</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Average'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">6</span><span class="sh_symbol">,</span>  <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_string">'=AVERAGE(B2:I2)'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">7</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Min'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">7</span><span class="sh_symbol">,</span>  <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_string">'=MIN(B2:I2)'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">8</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Max'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">8</span><span class="sh_symbol">,</span>  <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_string">'=MAX(B2:I2)'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">9</span><span class="sh_symbol">,</span>  <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Standard Deviation'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">9</span><span class="sh_symbol">,</span>  <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_string">'=STDEV(B2:I2)'</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_string">'Kurtosis'</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_string">'=KURT(B2:I2)'</span><span class="sh_symbol">);</span></pre>

<p></p><center><img src="WriteExcel.pm_files/stats.jpg" alt="Output from stats.pl" height="420" width="640"></center><p></p>


<h2><a class="u" href="#___top" title="click to go to top of document" name="Example_5">Example 5</a></h2>

<p>The following example converts a tab separated file called <code>tab.txt</code> into an Excel file called <code>tab.xls</code>.</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment">#!/usr/bin/perl -w</span>

    <span class="sh_keyword">use</span> strict<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">;</span>

    <span class="sh_keyword">open</span> <span class="sh_symbol">(</span>TABFILE<span class="sh_symbol">,</span> <span class="sh_string">'tab.txt'</span><span class="sh_symbol">)</span> or <span class="sh_keyword">die</span> <span class="sh_string">"tab.txt: $!"</span><span class="sh_symbol">;</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span>  <span class="sh_symbol">=</span> Spreadsheet<span class="sh_symbol">::</span>WriteExcel<span class="sh_symbol">-&gt;</span><span class="sh_function">new</span><span class="sh_symbol">(</span><span class="sh_string">'tab.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span> <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">add_worksheet</span><span class="sh_symbol">();</span>

    <span class="sh_comment"># Row and column are zero indexed</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$row</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>

    <span class="sh_keyword">while</span> <span class="sh_symbol">(</span><span class="sh_string">&lt;TABFILE&gt;</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
        <span class="sh_keyword">chomp</span><span class="sh_symbol">;</span>
        <span class="sh_comment"># Split on single tab</span>
        <span class="sh_keyword">my</span> <span class="sh_variable">@Fld</span> <span class="sh_symbol">=</span> <span class="sh_keyword">split</span><span class="sh_symbol">(</span><span class="sh_string">'\t'</span><span class="sh_symbol">,</span> <span class="sh_variable">$_</span><span class="sh_symbol">);</span>

        <span class="sh_keyword">my</span> <span class="sh_variable">$col</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
        <span class="sh_keyword">foreach</span> <span class="sh_keyword">my</span> <span class="sh_variable">$token</span> <span class="sh_symbol">(</span><span class="sh_variable">@Fld</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
            <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_variable">$row</span><span class="sh_symbol">,</span> <span class="sh_variable">$col</span><span class="sh_symbol">,</span> <span class="sh_variable">$token</span><span class="sh_symbol">);</span>
            <span class="sh_variable">$col</span><span class="sh_symbol">++;</span>
        <span class="sh_cbracket">}</span>
        <span class="sh_variable">$row</span><span class="sh_symbol">++;</span>
    <span class="sh_cbracket">}</span></pre>

<p>NOTE: This is a simple conversion program for illustrative purposes 
only. For converting a CSV or Tab separated or any other type of 
delimited text file to Excel I recommend the more rigorous csv2xls 
program that is part of H.Merijn Brand's Text::CSV_XS module distro.</p>

<p>See the examples/csv2xls link here: <a href="http://search.cpan.org/%7Ehmbrand/Text-CSV_XS/MANIFEST" class="podlinkurl">http://search.cpan.org/~hmbrand/Text-CSV_XS/MANIFEST</a>.</p>

<h2><a class="u" href="#___top" title="click to go to top of document" name="Additional_Examples">Additional Examples</a></h2>

<p>The following is a description of the example files that are provided
 in the standard Spreadsheet::WriteExcel distribution. They demonstrate 
the different features and options of the module. See <a href="http://search.cpan.org/%7Ejmcnamara/Spreadsheet-WriteExcel-2.38/lib/Spreadsheet/WriteExcel/Examples.pm" class="podlinkpod">Spreadsheet::WriteExcel::Examples</a> for more details.</p>

<pre class="sh_perl sh_sourceCode">    Getting started
    <span class="sh_symbol">===============</span>
    a_simple<span class="sh_symbol">.</span>pl             A get started example with some basic features<span class="sh_symbol">.</span>
    demo<span class="sh_symbol">.</span>pl                 A demo of some of the available features<span class="sh_symbol">.</span>
    regions<span class="sh_symbol">.</span>pl              A simple example of multiple worksheets<span class="sh_symbol">.</span>
    stats<span class="sh_symbol">.</span>pl                Basic formulas <span class="sh_keyword">and</span> functions<span class="sh_symbol">.</span>
    formats<span class="sh_symbol">.</span>pl              All the available formatting on several worksheets<span class="sh_symbol">.</span>
    bug_report<span class="sh_symbol">.</span>pl           A template <span class="sh_keyword">for</span> submitting bug reports<span class="sh_symbol">.</span>


    Advanced
    <span class="sh_symbol">========</span>
    autofilter<span class="sh_symbol">.</span>pl           Examples of worksheet autofilters<span class="sh_symbol">.</span>
    autofit<span class="sh_symbol">.</span>pl              Simulate Excel<span class="sh_string">'s autofit for column widths.</span>
    bigfile<span class="sh_symbol">.</span>pl              Write past the 7MB limit with OLE<span class="sh_symbol">::</span>Storage_Lite<span class="sh_symbol">.</span>
    cgi<span class="sh_symbol">.</span>pl                  A simple CGI program<span class="sh_symbol">.</span>
    chart_area<span class="sh_symbol">.</span>pl           A demo of area style charts<span class="sh_symbol">.</span>
    chart_bar<span class="sh_symbol">.</span>pl            A demo of <span class="sh_function">bar</span> <span class="sh_symbol">(</span>vertical histogram<span class="sh_symbol">)</span> style charts<span class="sh_symbol">.</span>
    chart_column<span class="sh_symbol">.</span>pl         A demo of <span class="sh_function">column</span> <span class="sh_symbol">(</span>histogram<span class="sh_symbol">)</span> style charts<span class="sh_symbol">.</span>
    chart_line<span class="sh_symbol">.</span>pl           A demo of line style charts<span class="sh_symbol">.</span>
    chart_pie<span class="sh_symbol">.</span>pl            A demo of pie style charts<span class="sh_symbol">.</span>
    chart_scatter<span class="sh_symbol">.</span>pl        A demo of scatter style charts<span class="sh_symbol">.</span>
    chart_stock<span class="sh_symbol">.</span>pl          A demo of stock style charts<span class="sh_symbol">.</span>
    chess<span class="sh_symbol">.</span>pl                An example of reusing formatting via properties<span class="sh_symbol">.</span>
    colors<span class="sh_symbol">.</span>pl               A demo of the colour palette <span class="sh_keyword">and</span> named colours<span class="sh_symbol">.</span>
    comments1<span class="sh_symbol">.</span>pl            Add comments to worksheet cells<span class="sh_symbol">.</span>
    comments2<span class="sh_symbol">.</span>pl            Add comments with advanced options<span class="sh_symbol">.</span>
    copyformat<span class="sh_symbol">.</span>pl           Example of copying a cell <span class="sh_keyword">format</span><span class="sh_symbol">.</span>
    data_validate<span class="sh_symbol">.</span>pl        An example of data validation <span class="sh_keyword">and</span> dropdown lists<span class="sh_symbol">.</span>
    date_time<span class="sh_symbol">.</span>pl            Write dates <span class="sh_keyword">and</span> <span class="sh_keyword">times</span> with <span class="sh_function">write_date_time</span><span class="sh_symbol">().</span>
    defined_name<span class="sh_symbol">.</span>pl         Example of how to create <span class="sh_keyword">defined</span> names<span class="sh_symbol">.</span>
    diag_border<span class="sh_symbol">.</span>pl          A simple example of diagonal cell borders<span class="sh_symbol">.</span>
    easter_egg<span class="sh_symbol">.</span>pl           Expose the Excel97 flight simulator<span class="sh_symbol">.</span>
    filehandle<span class="sh_symbol">.</span>pl           Examples of working with filehandles<span class="sh_symbol">.</span>
    formula_result<span class="sh_symbol">.</span>pl       Formulas with user specified results<span class="sh_symbol">.</span>
    headers<span class="sh_symbol">.</span>pl              Examples of worksheet headers <span class="sh_keyword">and</span> footers<span class="sh_symbol">.</span>
    hide_sheet<span class="sh_symbol">.</span>pl           Simple example of hiding a worksheet<span class="sh_symbol">.</span>
    hyperlink1<span class="sh_symbol">.</span>pl           Shows how to create web hyperlinks<span class="sh_symbol">.</span>
    hyperlink2<span class="sh_symbol">.</span>pl           Examples of internal <span class="sh_keyword">and</span> external hyperlinks<span class="sh_symbol">.</span>
    images<span class="sh_symbol">.</span>pl               Adding images to worksheets<span class="sh_symbol">.</span>
    indent<span class="sh_symbol">.</span>pl               An example of cell indentation<span class="sh_symbol">.</span>
    merge1<span class="sh_symbol">.</span>pl               A simple example of cell merging<span class="sh_symbol">.</span>
    merge2<span class="sh_symbol">.</span>pl               A simple example of cell merging with formatting<span class="sh_symbol">.</span>
    merge3<span class="sh_symbol">.</span>pl               Add hyperlinks to merged cells<span class="sh_symbol">.</span>
    merge4<span class="sh_symbol">.</span>pl               An advanced example of merging with formatting<span class="sh_symbol">.</span>
    merge5<span class="sh_symbol">.</span>pl               An advanced example of merging with formatting<span class="sh_symbol">.</span>
    merge6<span class="sh_symbol">.</span>pl               An example of merging with Unicode strings<span class="sh_symbol">.</span>
    mod_perl1<span class="sh_symbol">.</span>pl            A simple mod_perl <span class="sh_number">1</span> program<span class="sh_symbol">.</span>
    mod_perl2<span class="sh_symbol">.</span>pl            A simple mod_perl <span class="sh_number">2</span> program<span class="sh_symbol">.</span>
    outline<span class="sh_symbol">.</span>pl              An example of outlines <span class="sh_keyword">and</span> grouping<span class="sh_symbol">.</span>
    outline_collapsed<span class="sh_symbol">.</span>pl    An example of collapsed outlines<span class="sh_symbol">.</span>
    panes<span class="sh_symbol">.</span>pl                An examples of how to create panes<span class="sh_symbol">.</span>
    properties<span class="sh_symbol">.</span>pl           Add document properties to a workbook<span class="sh_symbol">.</span>
    protection<span class="sh_symbol">.</span>pl           Example of cell locking <span class="sh_keyword">and</span> formula hiding<span class="sh_symbol">.</span>
    repeat<span class="sh_symbol">.</span>pl               Example of writing repeated formulas<span class="sh_symbol">.</span>
    right_to_left<span class="sh_symbol">.</span>pl        Change default sheet direction to right to left<span class="sh_symbol">.</span>
    row_wrap<span class="sh_symbol">.</span>pl             How to wrap data from one worksheet onto another<span class="sh_symbol">.</span>
    sales<span class="sh_symbol">.</span>pl                An example of a simple sales spreadsheet<span class="sh_symbol">.</span>
    sendmail<span class="sh_symbol">.</span>pl             Send an Excel email attachment using Mail<span class="sh_symbol">::</span>Sender<span class="sh_symbol">.</span>
    stats_ext<span class="sh_symbol">.</span>pl            Same as stats<span class="sh_symbol">.</span>pl with external references<span class="sh_symbol">.</span>
    stocks<span class="sh_symbol">.</span>pl               Demonstrates conditional formatting<span class="sh_symbol">.</span>
    tab_colors<span class="sh_symbol">.</span>pl           Example of how to set worksheet tab colours<span class="sh_symbol">.</span>
    textwrap<span class="sh_symbol">.</span>pl             Demonstrates text wrapping options<span class="sh_symbol">.</span>
    win32ole<span class="sh_symbol">.</span>pl             A sample Win32<span class="sh_symbol">::</span>OLE example <span class="sh_keyword">for</span> comparison<span class="sh_symbol">.</span>
    write_arrays<span class="sh_symbol">.</span>pl         Example of writing 1D or 2D arrays of data<span class="sh_symbol">.</span>
    write_handler1<span class="sh_symbol">.</span>pl       Example of extending the <span class="sh_keyword">write</span><span class="sh_symbol">()</span> method<span class="sh_symbol">.</span> Step <span class="sh_number">1</span><span class="sh_symbol">.</span>
    write_handler2<span class="sh_symbol">.</span>pl       Example of extending the <span class="sh_keyword">write</span><span class="sh_symbol">()</span> method<span class="sh_symbol">.</span> Step <span class="sh_number">2</span><span class="sh_symbol">.</span>
    write_handler3<span class="sh_symbol">.</span>pl       Example of extending the <span class="sh_keyword">write</span><span class="sh_symbol">()</span> method<span class="sh_symbol">.</span> Step <span class="sh_number">3</span><span class="sh_symbol">.</span>
    write_handler4<span class="sh_symbol">.</span>pl       Example of extending the <span class="sh_keyword">write</span><span class="sh_symbol">()</span> method<span class="sh_symbol">.</span> Step <span class="sh_number">4</span><span class="sh_symbol">.</span>
    write_to_scalar<span class="sh_symbol">.</span>pl      Example of writing an Excel file to a Perl scalar<span class="sh_symbol">.</span>


    Unicode
    <span class="sh_symbol">=======</span>
    unicode_utf16<span class="sh_symbol">.</span>pl        Simple example of using Unicode UTF16 strings<span class="sh_symbol">.</span>
    unicode_utf16_japan<span class="sh_symbol">.</span>pl  Write Japanese Unicode strings using UTF<span class="sh_number">-16</span><span class="sh_symbol">.</span>
    unicode_cyrillic<span class="sh_symbol">.</span>pl     Write Russian Cyrillic strings using UTF<span class="sh_number">-8</span><span class="sh_symbol">.</span>
    unicode_list<span class="sh_symbol">.</span>pl         List the chars in a Unicode font<span class="sh_symbol">.</span>
    unicode_2022_jp<span class="sh_symbol">.</span>pl      Japanese<span class="sh_symbol">:</span> ISO<span class="sh_number">-2022</span><span class="sh_symbol">-</span>JP to utf8 in perl <span class="sh_number">5.8</span><span class="sh_symbol">.</span>
    unicode_8859_11<span class="sh_symbol">.</span>pl      Thai<span class="sh_symbol">:</span>     ISO<span class="sh_symbol">-</span>8859_11 to utf8 in perl <span class="sh_number">5.8</span><span class="sh_symbol">.</span>
    unicode_8859_7<span class="sh_symbol">.</span>pl       Greek<span class="sh_symbol">:</span>    ISO<span class="sh_symbol">-</span>8859_7  to utf8 in perl <span class="sh_number">5.8</span><span class="sh_symbol">.</span>
    unicode_big5<span class="sh_symbol">.</span>pl         Chinese<span class="sh_symbol">:</span>  BIG5        to utf8 in perl <span class="sh_number">5.8</span><span class="sh_symbol">.</span>
    unicode_cp1251<span class="sh_symbol">.</span>pl       Russian<span class="sh_symbol">:</span>  CP1251      to utf8 in perl <span class="sh_number">5.8</span><span class="sh_symbol">.</span>
    unicode_cp1256<span class="sh_symbol">.</span>pl       Arabic<span class="sh_symbol">:</span>   CP1256      to utf8 in perl <span class="sh_number">5.8</span><span class="sh_symbol">.</span>
    unicode_koi8r<span class="sh_symbol">.</span>pl        Russian<span class="sh_symbol">:</span>  KOI8<span class="sh_symbol">-</span>R      to utf8 in perl <span class="sh_number">5.8</span><span class="sh_symbol">.</span>
    unicode_polish_utf8<span class="sh_symbol">.</span>pl  Polish <span class="sh_symbol">:</span>  UTF8        to utf8 in perl <span class="sh_number">5.8</span><span class="sh_symbol">.</span>
    unicode_shift_jis<span class="sh_symbol">.</span>pl    Japanese<span class="sh_symbol">:</span> Shift JIS   to utf8 in perl <span class="sh_number">5.8</span><span class="sh_symbol">.</span>


    Utility
    <span class="sh_symbol">=======</span>
    csv2xls<span class="sh_symbol">.</span>pl              Program to convert a CSV file to an Excel file<span class="sh_symbol">.</span>
    tab2xls<span class="sh_symbol">.</span>pl              Program to convert a tab separated file to xls<span class="sh_symbol">.</span>
    datecalc1<span class="sh_symbol">.</span>pl            Convert Unix<span class="sh_symbol">/</span>Perl time to Excel time<span class="sh_symbol">.</span>
    datecalc2<span class="sh_symbol">.</span>pl            Calculate an Excel date using Date<span class="sh_symbol">::</span>Calc<span class="sh_symbol">.</span>
    lecxe<span class="sh_symbol">.</span>pl                Convert Excel to WriteExcel using Win32<span class="sh_symbol">::</span>OLE<span class="sh_symbol">.</span>


    Developer
    <span class="sh_symbol">=========</span>
    convertA1<span class="sh_symbol">.</span>pl            Helper functions <span class="sh_keyword">for</span> dealing with A1 notation<span class="sh_symbol">.</span>
    function_locale<span class="sh_symbol">.</span>pl      Add non<span class="sh_symbol">-</span>English function names to Formula<span class="sh_symbol">.</span>pm<span class="sh_symbol">.</span>
    writeA1<span class="sh_symbol">.</span>pl              Example of how to extend the module<span class="sh_symbol">.</span></pre>

<h1><a class="u" href="#___top" title="click to go to top of document" name="LIMITATIONS">LIMITATIONS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>The following limits are imposed by Excel:</p>

<pre class="sh_perl sh_sourceCode">    Description                          Limit
    <span class="sh_symbol">-----------------------------------</span>  <span class="sh_symbol">------</span>
    Maximum number of chars in a string  <span class="sh_number">32767</span>
    Maximum number of columns            <span class="sh_number">256</span>
    Maximum number of rows               <span class="sh_number">65536</span>
    Maximum chars in a sheet name        <span class="sh_number">31</span>
    Maximum chars in a header<span class="sh_symbol">/</span>footer     <span class="sh_number">254</span></pre>

<p>For Excel 2007+ file limits see the <a href="http://search.cpan.org/perldoc?Excel%3A%3AWriter%3A%3AXLSX" class="podlinkpod">Excel::Writer::XLSX</a> module.</p>

<p>The minimum file size is 6K due to the OLE overhead. The maximum file
 size is approximately 7MB (7087104 bytes) of BIFF data. This can be 
extended by installing Takanori Kawai's OLE::Storage_Lite module <a href="http://search.cpan.org/search?dist=OLE-Storage_Lite" class="podlinkurl">http://search.cpan.org/search?dist=OLE-Storage_Lite</a> see the <code>bigfile.pl</code> example in the <code>examples</code> directory of the distro.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="DOWNLOADING">DOWNLOADING <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>The latest version of this module is always available at: <a href="http://search.cpan.org/search?dist=Spreadsheet-WriteExcel/" class="podlinkurl">http://search.cpan.org/search?dist=Spreadsheet-WriteExcel/</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="REQUIREMENTS">REQUIREMENTS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>This module requires Perl &gt;= 5.005, Parse::RecDescent, File::Temp and OLE::Storage_Lite:</p>

<pre class="sh_perl sh_sourceCode">    <a href="http://search.cpan.org/search?dist=Parse-RecDescent/" class="podlinkurl">http<span class="sh_symbol">:</span><span class="sh_string">//search.cpan.org/search?dist=Parse-RecDescent/</span></a> <span class="sh_comment"># For formulas.</span>
    <a href="http://search.cpan.org/search?dist=File-Temp/" class="podlinkurl">http<span class="sh_symbol">:</span><span class="sh_string">//search.cpan.org/search?dist=File-Temp/</span></a>        <span class="sh_comment"># For set_tempdir().</span>
    <a href="http://search.cpan.org/search?dist=OLE-Storage_Lite/" class="podlinkurl">http<span class="sh_symbol">:</span><span class="sh_string">//search.cpan.org/search?dist=OLE-Storage_Lite/</span></a> <span class="sh_comment"># For files &gt; 7MB.</span></pre>

<p>Note, these aren't strict requirements. Spreadsheet::WriteExcel will 
work without these modules if you don't use write_formula(), 
set_tempdir() or create files greater than 7MB. However, it is best to 
install them if possible and they will be installed automatically if you
 use a tool such as CPAN.pm or ppm.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="INSTALLATION">INSTALLATION <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>See the INSTALL or install.html docs that come with the distribution or: <a href="http://search.cpan.org/src/JMCNAMARA/Spreadsheet-WriteExcel-2.31/INSTALL" class="podlinkurl">http://search.cpan.org/src/JMCNAMARA/Spreadsheet-WriteExcel-2.31/INSTALL</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="PORTABILITY">PORTABILITY <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Spreadsheet::WriteExcel will work on the majority of Windows, UNIX 
and Macintosh platforms. Specifically, the module will work on any 
system where perl packs floats in the 64 bit IEEE format. The float must
 also be in little-endian format but it will be reversed if necessary. 
Thus:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_keyword">print</span> <span class="sh_keyword">join</span><span class="sh_symbol">(</span><span class="sh_string">' '</span><span class="sh_symbol">,</span> <span class="sh_keyword">map</span> <span class="sh_cbracket">{</span> <span class="sh_keyword">sprintf</span> <span class="sh_string">'%#02x'</span><span class="sh_symbol">,</span> <span class="sh_variable">$_</span> <span class="sh_cbracket">}</span> <span class="sh_keyword">unpack</span><span class="sh_symbol">(</span><span class="sh_string">'C*'</span><span class="sh_symbol">,</span> <span class="sh_keyword">pack</span> <span class="sh_string">'d'</span><span class="sh_symbol">,</span> <span class="sh_number">1.2345</span><span class="sh_symbol">)),</span> <span class="sh_string">"\n"</span><span class="sh_symbol">;</span></pre>

<p>should give (or in reverse order):</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_number">0x8d</span> <span class="sh_number">0x97</span> <span class="sh_number">0x6e</span> <span class="sh_number">0x12</span> <span class="sh_number">0x83</span> <span class="sh_number">0xc0</span> <span class="sh_number">0xf3</span> <span class="sh_number">0x3f</span></pre>

<p>In general, if you don't know whether your system supports a 64 bit 
IEEE float or not, it probably does. If your system doesn't, WriteExcel 
will <code>croak()</code> with the message given in the <a href="#DIAGNOSTICS" class="podlinkpod">"DIAGNOSTICS"</a> section. You can check which platforms the module has been tested on at the CPAN testers site: <a href="http://testers.cpan.org/search?request=dist&amp;dist=Spreadsheet-WriteExcel" class="podlinkurl">http://testers.cpan.org/search?request=dist&amp;dist=Spreadsheet-WriteExcel</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="DIAGNOSTICS">DIAGNOSTICS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<dl>
<dt><a name="Filename"></a><a name="Filename_required_by_Spreadsheet::WriteExcel-&gt;new()">Filename required by Spreadsheet::WriteExcel-&gt;new()</a></dt>

<dd>
<p>A filename must be given in the constructor.</p>

</dd><dt><a name="Can"></a><a name="Can't_open_filename._It_may_be_in_use_or_protected.">Can't open filename. It may be in use or protected.</a></dt>

<dd>
<p>The file cannot be opened for writing. The directory that you are 
writing to may be protected or the file may be in use by another 
program.</p>

</dd><dt><a name="Unable"></a><a name="Unable_to_create_tmp_files_via_File::Temp::tempfile()...">Unable to create tmp files via File::Temp::tempfile()...</a></dt>

<dd>
<p>This is a <code>-w</code> warning. You will see it if you are using 
Spreadsheet::WriteExcel in an environment where temporary files cannot 
be created, in which case all data will be stored in memory. The warning
 is for information only: it does not affect creation but it will affect
 the speed of execution for large files. See the <code>set_tempdir</code> workbook method.</p>

</dd><dt><a name="Maximum"></a><a name="Maximum_file_size,_7087104,_exceeded.">Maximum file size, 7087104, exceeded.</a></dt>

<dd>
<p>The current OLE implementation only supports a maximum BIFF file of this size. This limit can be extended, see the <a href="#LIMITATIONS" class="podlinkpod">"LIMITATIONS"</a> section.</p>

</dd><dt><a name="Can"></a><a name="Can't_locate_Parse/RecDescent.pm_in_@INC_...">Can't locate Parse/RecDescent.pm in @INC ...</a></dt>

<dd>
<p>Spreadsheet::WriteExcel requires the Parse::RecDescent module. Download it from CPAN: <a href="http://search.cpan.org/search?dist=Parse-RecDescent" class="podlinkurl">http://search.cpan.org/search?dist=Parse-RecDescent</a></p>

</dd><dt><a name="Couldn"></a><a name="Couldn't_parse_formula_...">Couldn't parse formula ...</a></dt>

<dd>
<p>There are a large number of warnings which relate to badly formed formulas and functions. See the <a href="#FORMULAS_AND_FUNCTIONS_IN_EXCEL" class="podlinkpod">"FORMULAS AND FUNCTIONS IN EXCEL"</a> section for suggestions on how to avoid these errors. You should also check the formula in Excel to ensure that it is valid.</p>

</dd><dt><a name="Required"></a><a name="Required_floating_point_format_not_supported_on_this_platform.">Required floating point format not supported on this platform.</a></dt>

<dd>
<p>Operating system doesn't support 64 bit IEEE float or it is byte-ordered in a way unknown to WriteExcel.</p>

</dd><dt><a name="file"></a><a name="'file.xls'_cannot_be_accessed._The_file_may_be_read-only_...">'file.xls' cannot be accessed. The file may be read-only ...</a></dt>

<dd>
<p>You may sometimes encounter the following error when trying to open a
 file in Excel: "file.xls cannot be accessed. The file may be read-only,
 or you may be trying to access a read-only location. Or, the server the
 document is stored on may not be responding."</p>

<p>This error generally means that the Excel file has been corrupted. 
There are two likely causes of this: the file was FTPed in ASCII mode 
instead of binary mode or else the file was created with <code>UTF-8</code> data returned by an XML parser. See <a href="#Warning_about_XML::Parser_and_perl_5.6" class="podlinkpod">"Warning about XML::Parser and perl 5.6"</a> for further details.</p>
</dd>
</dl>

<h1><a class="u" href="#___top" title="click to go to top of document" name="THE_EXCEL_BINARY_FORMAT">THE EXCEL BINARY FORMAT <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>The following is some general information about the Excel binary format for anyone who may be interested.</p>

<p>Excel data is stored in the "Binary Interchange File Format" (BIFF) 
file format. Details of this format are given in "Excel 97-2007 Binary 
File Format Specification" <a href="http://www.microsoft.com/interop/docs/OfficeBinaryFormats.mspx" class="podlinkurl">http://www.microsoft.com/interop/docs/OfficeBinaryFormats.mspx</a>.</p>

<p>Daniel Rentz of OpenOffice.org has also written a detailed description of the Excel workbook records, see <a href="http://sc.openoffice.org/excelfileformat.pdf" class="podlinkurl">http://sc.openoffice.org/excelfileformat.pdf</a>.</p>

<p>Charles Wybble has collected together additional information about the Excel file format. See "The Chicago Project" at <a href="http://chicago.sourceforge.net/devel/" class="podlinkurl">http://chicago.sourceforge.net/devel/</a>.</p>

<p>The BIFF data is stored along with other data in an OLE Compound 
File. This is a structured storage which acts like a file system within a
 file. A Compound File is comprised of storages and streams which, to 
follow the file system analogy, are like directories and files.</p>

<p>The OLE format is explained in the "Windows Compound Binary File Format Specification" <a href="http://www.microsoft.com/interop/docs/supportingtechnologies.mspx" class="podlinkurl">http://www.microsoft.com/interop/docs/supportingtechnologies.mspx</a></p>

<p>The Digital Imaging Group have also detailed the OLE format in the JPEG2000 specification: see Appendix A of <a href="http://www.i3a.org/pdf/wg1n1017.pdf" class="podlinkurl">http://www.i3a.org/pdf/wg1n1017.pdf</a>.</p>

<p>Please note that the provision of this information does not 
constitute an invitation to start hacking at the BIFF or OLE file 
formats. There are more interesting ways to waste your time. ;-)</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="WRITING_EXCEL_FILES">WRITING EXCEL FILES <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Depending on your requirements, background and general sensibilities 
you may prefer one of the following methods of getting data into Excel:</p>

<ul>
<li>Win32::OLE module and office automation
<p>This requires a Windows platform and an installed copy of Excel. This
 is the most powerful and complete method for interfacing with Excel. 
See <a href="http://www.activestate.com/ASPN/Reference/Products/ActivePerl-5.6/faq/Windows/ActivePerl-Winfaq12.html" class="podlinkurl">http://www.activestate.com/ASPN/Reference/Products/ActivePerl-5.6/faq/Windows/ActivePerl-Winfaq12.html</a> and <a href="http://www.activestate.com/ASPN/Reference/Products/ActivePerl-5.6/site/lib/Win32/OLE.html" class="podlinkurl">http://www.activestate.com/ASPN/Reference/Products/ActivePerl-5.6/site/lib/Win32/OLE.html</a>.
 If your main platform is UNIX but you have the resources to set up a 
separate Win32/MSOffice server, you can convert office documents to 
text, postscript or PDF using Win32::OLE. For a demonstration of how to 
do this using Perl see Docserver: <a href="http://search.cpan.org/search?mode=module&amp;query=docserver" class="podlinkurl">http://search.cpan.org/search?mode=module&amp;query=docserver</a>.</p>
</li>

<li>CSV, comma separated variables or text
<p>If the file extension is <code>csv</code>, Excel will open and 
convert this format automatically. Generating a valid CSV file isn't as 
easy as it seems. Have a look at the DBD::RAM, DBD::CSV, Text::xSV and 
Text::CSV_XS modules.</p>
</li>

<li>DBI with DBD::ADO or DBD::ODBC
<p>Excel files contain an internal index table that allows them to act 
like a database file. Using one of the standard Perl database modules 
you can connect to an Excel file as a database.</p>
</li>

<li>DBD::Excel
<p>You can also access Spreadsheet::WriteExcel using the standard DBI interface via Takanori Kawai's DBD::Excel module <a href="http://search.cpan.org/dist/DBD-Excel" class="podlinkurl">http://search.cpan.org/dist/DBD-Excel</a></p>
</li>

<li>Spreadsheet::WriteExcelXML
<p>This module allows you to create an Excel XML file using the same interface as Spreadsheet::WriteExcel. See: <a href="http://search.cpan.org/dist/Spreadsheet-WriteExcelXML" class="podlinkurl">http://search.cpan.org/dist/Spreadsheet-WriteExcelXML</a></p>
</li>

<li>Excel::Template
<p>This module allows you to create an Excel file from an XML template in a manner similar to HTML::Template. See <a href="http://search.cpan.org/dist/Excel-Template/" class="podlinkurl">http://search.cpan.org/dist/Excel-Template/</a>.</p>
</li>

<li>Spreadsheet::WriteExcel::FromXML
<p>This module allows you to turn a simple XML file into an Excel file 
using Spreadsheet::WriteExcel as a back-end. The format of the XML file 
is defined by a supplied DTD: <a href="http://search.cpan.org/dist/Spreadsheet-WriteExcel-FromXML" class="podlinkurl">http://search.cpan.org/dist/Spreadsheet-WriteExcel-FromXML</a>.</p>
</li>

<li>Spreadsheet::WriteExcel::Simple
<p>This provides an easier interface to Spreadsheet::WriteExcel: <a href="http://search.cpan.org/dist/Spreadsheet-WriteExcel-Simple" class="podlinkurl">http://search.cpan.org/dist/Spreadsheet-WriteExcel-Simple</a>.</p>
</li>

<li>Spreadsheet::WriteExcel::FromDB
<p>This is a useful module for creating Excel files directly from a DB table: <a href="http://search.cpan.org/dist/Spreadsheet-WriteExcel-FromDB" class="podlinkurl">http://search.cpan.org/dist/Spreadsheet-WriteExcel-FromDB</a>.</p>
</li>

<li>HTML tables
<p>This is an easy way of adding formatting via a text based format.</p>
</li>

<li>XML or HTML
<p>The Excel XML and HTML file specification are available from <a href="http://msdn.microsoft.com/library/officedev/ofxml2k/ofxml2k.htm" class="podlinkurl">http://msdn.microsoft.com/library/officedev/ofxml2k/ofxml2k.htm</a>.</p>
</li>
</ul>

<p>For other Perl-Excel modules try the following search: <a href="http://search.cpan.org/search?mode=module&amp;query=excel" class="podlinkurl">http://search.cpan.org/search?mode=module&amp;query=excel</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="READING_EXCEL_FILES">READING EXCEL FILES <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>To read data from Excel files try:</p>

<ul>
<li>Spreadsheet::ParseExcel
<p>This uses the OLE::Storage-Lite module to extract data from an Excel file. <a href="http://search.cpan.org/dist/Spreadsheet-ParseExcel" class="podlinkurl">http://search.cpan.org/dist/Spreadsheet-ParseExcel</a>.</p>
</li>

<li>Spreadsheet::ParseExcel_XLHTML
<p>This module uses Spreadsheet::ParseExcel's interface but uses xlHtml (see below) to do the conversion: <a href="http://search.cpan.org/dist/Spreadsheet-ParseExcel_XLHTML" class="podlinkurl">http://search.cpan.org/dist/Spreadsheet-ParseExcel_XLHTML</a> Spreadsheet::ParseExcel_XLHTML</p>
</li>

<li>xlHtml
<p>This is an open source "Excel to HTML Converter" C/C++ project at <a href="http://chicago.sourceforge.net/xlhtml/" class="podlinkurl">http://chicago.sourceforge.net/xlhtml/</a>.</p>
</li>

<li>DBD::Excel (reading)
<p>You can also access Spreadsheet::ParseExcel using the standard DBI interface via Takanori Kawai's DBD::Excel module <a href="http://search.cpan.org/dist/DBD-Excel" class="podlinkurl">http://search.cpan.org/dist/DBD-Excel</a>.</p>
</li>

<li>Win32::OLE module and office automation (reading)
<p>See, the section <a href="#WRITING_EXCEL_FILES" class="podlinkpod">"WRITING EXCEL FILES"</a>.</p>
</li>

<li>HTML tables (reading)
<p>If the files are saved from Excel in a HTML format the data can be accessed using HTML::TableExtract <a href="http://search.cpan.org/dist/HTML-TableExtract" class="podlinkurl">http://search.cpan.org/dist/HTML-TableExtract</a>.</p>
</li>

<li>DBI with DBD::ADO or DBD::ODBC.
<p>See, the section <a href="#WRITING_EXCEL_FILES" class="podlinkpod">"WRITING EXCEL FILES"</a>.</p>
</li>

<li>XML::Excel
<p>Converts Excel files to XML using Spreadsheet::ParseExcel <a href="http://search.cpan.org/dist/XML-Excel" class="podlinkurl">http://search.cpan.org/dist/XML-Excel</a>.</p>
</li>

<li>OLE::Storage, aka LAOLA
<p>This is a Perl interface to OLE file formats. In particular, the distro contains an Excel to HTML converter called Herbert, <a href="http://user.cs.tu-berlin.de/%7Eschwartz/pmh/" class="podlinkurl">http://user.cs.tu-berlin.de/~schwartz/pmh/</a>. This has been superseded by the Spreadsheet::ParseExcel module.</p>
</li>
</ul>

<p>For other Perl-Excel modules try the following search: <a href="http://search.cpan.org/search?mode=module&amp;query=excel" class="podlinkurl">http://search.cpan.org/search?mode=module&amp;query=excel</a>.</p>

<p>If you wish to view Excel files on a UNIX/Linux platform check out the excellent Gnumeric spreadsheet application at <a href="http://www.gnome.org/projects/gnumeric/" class="podlinkurl">http://www.gnome.org/projects/gnumeric/</a> or OpenOffice.org at <a href="http://www.openoffice.org/" class="podlinkurl">http://www.openoffice.org/</a>.</p>

<p>If you wish to view Excel files on a Windows platform which doesn't 
have Excel installed you can use the free Microsoft Excel Viewer <a href="http://office.microsoft.com/downloads/2000/xlviewer.aspx" class="podlinkurl">http://office.microsoft.com/downloads/2000/xlviewer.aspx</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="MODIFYING_AND_REWRITING_EXCEL_FILES">MODIFYING AND REWRITING EXCEL FILES <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>An Excel file is a binary file within a binary file. It contains 
several interlinked checksums and changing even one byte can cause it to
 become corrupted.</p>

<p>As such you cannot simply append or update an Excel file. The only 
way to achieve this is to read the entire file into memory, make the 
required changes or additions and then write the file out again.</p>

<p>You can read and rewrite an Excel file using the 
Spreadsheet::ParseExcel::SaveParser module which is a wrapper around 
Spreadsheet::ParseExcel and Spreadsheet::WriteExcel. It is part of the 
Spreadsheet::ParseExcel package: <a href="http://search.cpan.org/search?dist=Spreadsheet-ParseExcel" class="podlinkurl">http://search.cpan.org/search?dist=Spreadsheet-ParseExcel</a>.</p>

<p>However, you can only rewrite the features that 
Spreadsheet::WriteExcel supports so macros, graphs and some other 
features in the original Excel file will be lost. Also, formulas aren't 
rewritten, only the result of a formula is written.</p>

<p>Here is an example:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_comment">#!/usr/bin/perl -w</span>

    <span class="sh_keyword">use</span> strict<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>ParseExcel<span class="sh_symbol">;</span>
    <span class="sh_keyword">use</span> Spreadsheet<span class="sh_symbol">::</span>ParseExcel<span class="sh_symbol">::</span>SaveParser<span class="sh_symbol">;</span>

    <span class="sh_comment"># Open the template with SaveParser</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$parser</span>   <span class="sh_symbol">=</span> new Spreadsheet<span class="sh_symbol">::</span>ParseExcel<span class="sh_symbol">::</span>SaveParser<span class="sh_symbol">;</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$template</span> <span class="sh_symbol">=</span> <span class="sh_variable">$parser</span><span class="sh_symbol">-&gt;</span><span class="sh_function">Parse</span><span class="sh_symbol">(</span><span class="sh_string">'template.xls'</span><span class="sh_symbol">);</span>

    <span class="sh_keyword">my</span> <span class="sh_variable">$sheet</span>    <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$row</span>      <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$col</span>      <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>

    <span class="sh_comment"># Get the format from the cell</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$format</span>   <span class="sh_symbol">=</span> <span class="sh_variable">$template</span><span class="sh_symbol">-&gt;</span><span class="sh_cbracket">{</span>Worksheet<span class="sh_cbracket">}</span><span class="sh_symbol">[</span><span class="sh_variable">$sheet</span><span class="sh_symbol">]</span>
                            <span class="sh_symbol">-&gt;</span><span class="sh_cbracket">{</span>Cells<span class="sh_cbracket">}</span><span class="sh_symbol">[</span><span class="sh_variable">$row</span><span class="sh_symbol">][</span><span class="sh_variable">$col</span><span class="sh_symbol">]</span>
                            <span class="sh_symbol">-&gt;</span><span class="sh_cbracket">{</span>FormatNo<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

    <span class="sh_comment"># Write data to some cells</span>
    <span class="sh_variable">$template</span><span class="sh_symbol">-&gt;</span><span class="sh_function">AddCell</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_variable">$row</span><span class="sh_symbol">,</span>   <span class="sh_variable">$col</span><span class="sh_symbol">,</span>   <span class="sh_number">1</span><span class="sh_symbol">,</span>     <span class="sh_variable">$format</span><span class="sh_symbol">);</span>
    <span class="sh_variable">$template</span><span class="sh_symbol">-&gt;</span><span class="sh_function">AddCell</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_variable">$row</span><span class="sh_number">+1</span><span class="sh_symbol">,</span> <span class="sh_variable">$col</span><span class="sh_symbol">,</span> <span class="sh_string">"Hello"</span><span class="sh_symbol">,</span> <span class="sh_variable">$format</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># Add a new worksheet</span>
    <span class="sh_variable">$template</span><span class="sh_symbol">-&gt;</span><span class="sh_function">AddWorksheet</span><span class="sh_symbol">(</span><span class="sh_string">'New Data'</span><span class="sh_symbol">);</span>

    <span class="sh_comment"># The SaveParser SaveAs() method returns a reference to a</span>
    <span class="sh_comment"># Spreadsheet::WriteExcel object. If you wish you can then</span>
    <span class="sh_comment"># use this to access any of the methods that aren't</span>
    <span class="sh_comment"># available from the SaveParser object. If you don't need</span>
    <span class="sh_comment"># to do this just use SaveAs().</span>
    <span class="sh_comment">#</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">;</span>

    <span class="sh_cbracket">{</span>
        <span class="sh_comment"># SaveAs generates a lot of harmless warnings about unset</span>
        <span class="sh_comment"># Worksheet properties. You can ignore them if you wish.</span>
        <span class="sh_keyword">local</span> $<span class="sh_symbol">^</span>W <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>

        <span class="sh_comment"># Rewrite the file or save as a new file</span>
        <span class="sh_variable">$workbook</span> <span class="sh_symbol">=</span> <span class="sh_variable">$template</span><span class="sh_symbol">-&gt;</span><span class="sh_function">SaveAs</span><span class="sh_symbol">(</span><span class="sh_string">'new.xls'</span><span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>

    <span class="sh_comment"># Use Spreadsheet::WriteExcel methods</span>
    <span class="sh_keyword">my</span> <span class="sh_variable">$worksheet</span>  <span class="sh_symbol">=</span> <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_function">sheets</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$worksheet</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">write</span><span class="sh_symbol">(</span><span class="sh_variable">$row</span><span class="sh_number">+2</span><span class="sh_symbol">,</span> <span class="sh_variable">$col</span><span class="sh_symbol">,</span> <span class="sh_string">"World2"</span><span class="sh_symbol">);</span>

    <span class="sh_variable">$workbook</span><span class="sh_symbol">-&gt;</span><span class="sh_keyword">close</span><span class="sh_symbol">();</span></pre>

<h1><a class="u" href="#___top" title="click to go to top of document" name="Warning_about_XML::Parser_and_perl_5.6">Warning about XML::Parser and perl 5.6 <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>You must be careful when using Spreadsheet::WriteExcel in conjunction
 with perl 5.6 and XML::Parser (and other XML parsers) due to the fact 
that the data returned by the parser is generally in <code>UTF-8</code> format.</p>

<p>When <code>UTF-8</code> strings are added to Spreadsheet::WriteExcel's internal data it causes the generated Excel file to become corrupt.</p>

<p>Note, this doesn't affect perl 5.005 (which doesn't try to handle <code>UTF-8</code>) or 5.8 (which handles it correctly).</p>

<p>To avoid this problem you should upgrade to perl 5.8, if possible, or
 else you should convert the output data from XML::Parser to ASCII or 
ISO-8859-1 using one of the following methods:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_variable">$new_str</span> <span class="sh_symbol">=</span> <span class="sh_keyword">pack</span> <span class="sh_string">'C*'</span><span class="sh_symbol">,</span> <span class="sh_keyword">unpack</span> <span class="sh_string">'U*'</span><span class="sh_symbol">,</span> <span class="sh_variable">$utf8_str</span><span class="sh_symbol">;</span>


    <span class="sh_keyword">use</span> Unicode<span class="sh_symbol">::</span>MapUTF8 <span class="sh_string">'from_utf8'</span><span class="sh_symbol">;</span>
    <span class="sh_variable">$new_str</span> <span class="sh_symbol">=</span> <span class="sh_function">from_utf8</span><span class="sh_symbol">(</span><span class="sh_cbracket">{</span><span class="sh_symbol">-</span>str <span class="sh_symbol">=&gt;</span> <span class="sh_variable">$utf8_str</span><span class="sh_symbol">,</span> <span class="sh_symbol">-</span>charset <span class="sh_symbol">=&gt;</span> <span class="sh_string">'ISO-8859-1'</span><span class="sh_cbracket">}</span><span class="sh_symbol">);</span></pre>

<h1><a class="u" href="#___top" title="click to go to top of document" name="Warning_about_Office_Service_Pack_3">Warning about Office Service Pack 3 <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>If you have Office Service Pack 3 (SP3) installed you may see the 
following warning when you open a file created by 
Spreadsheet::WriteExcel:</p>

<pre class="sh_perl sh_sourceCode">    <span class="sh_string">"File Error: data may have been lost"</span><span class="sh_symbol">.</span></pre>

<p>This is usually caused by multiple instances of data in a cell.</p>

<p>SP3 changed Excel's default behaviour when it encounters multiple 
data in a cell so that it issues a warning when the file is opened and 
it displays the first data that was written. Prior to SP3 it didn't 
issue a warning and displayed the last data written.</p>

<p>For a longer discussion and some workarounds see the following: <a href="http://groups.google.com/group/spreadsheet-writeexcel/browse_thread/thread/3dcea40e6620af3a" class="podlinkurl">http://groups.google.com/group/spreadsheet-writeexcel/browse_thread/thread/3dcea40e6620af3a</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="BUGS">BUGS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Formulas are formulae.</p>

<p>XML and <code>UTF-8</code> data on perl 5.6 can cause Excel files created by Spreadsheet::WriteExcel to become corrupt. See <a href="#Warning_about_XML::Parser_and_perl_5.6" class="podlinkpod">"Warning about XML::Parser and perl 5.6"</a> for further details.</p>

<p>The format object that is used with a <code>merge_range()</code> 
method call is marked internally as being associated with a merged 
range. It is a fatal error to use a merged format in a non-merged cell. 
The current workaround is to use separate formats for merged and 
non-merged cell. This restriction will be removed in a future release.</p>

<p>Nested formulas sometimes aren't parsed correctly and give a result 
of "#VALUE". If you come across a formula that parses like this, let me 
know.</p>

<p>Spreadsheet::ParseExcel: All formulas created by 
Spreadsheet::WriteExcel are read as having a value of zero. This is 
because Spreadsheet::WriteExcel only stores the formula and not the 
calculated result.</p>

<p>OpenOffice.org: No known issues in this release.</p>

<p>Gnumeric: No known issues in this release.</p>

<p>If you wish to submit a bug report run the <code>bug_report.pl</code> program in the <code>examples</code> directory of the distro.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="TO_DO">TO DO <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Spreadsheet::WriteExcel has been superseded by <a href="http://search.cpan.org/perldoc?Excel%3A%3AWriter%3A%3AXLSX" class="podlinkpod">Excel::Writer::XLSX</a>. All new feature and enhancements will be added to that module.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="REPOSITORY">REPOSITORY <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>The Spreadsheet::WriteExcel source code in host on github: <a href="http://github.com/jmcnamara/spreadsheet-writeexcel" class="podlinkurl">http://github.com/jmcnamara/spreadsheet-writeexcel</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="MAILING_LIST">MAILING LIST <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>There is a Google group for discussing and asking questions about 
Spreadsheet::WriteExcel. This is a good place to search to see if your 
question has been asked before: <a href="http://groups.google.com/group/spreadsheet-writeexcel" class="podlinkurl">http://groups.google.com/group/spreadsheet-writeexcel</a>.</p>




<p>Alternatively you can keep up to date with future releases by subscribing at: <a href="http://freshmeat.net/projects/writeexcel/" class="podlinkurl">http://freshmeat.net/projects/writeexcel/</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="DONATIONS">DONATIONS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>If you'd care to donate to the Spreadsheet::WriteExcel project, you can do so via PayPal: <a href="http://tinyurl.com/7ayes" class="podlinkurl">http://tinyurl.com/7ayes</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="SEE_ALSO">SEE ALSO <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p><a href="http://search.cpan.org/perldoc?Spreadsheet%3A%3AParseExcel" class="podlinkpod">Spreadsheet::ParseExcel</a>: <a href="http://search.cpan.org/dist/Spreadsheet-ParseExcel" class="podlinkurl">http://search.cpan.org/dist/Spreadsheet-ParseExcel</a>.</p>

<p>Spreadsheet-WriteExcel-FromXML: <a href="http://search.cpan.org/dist/Spreadsheet-WriteExcel-FromXML" class="podlinkurl">http://search.cpan.org/dist/Spreadsheet-WriteExcel-FromXML</a>.</p>

<p><a href="http://search.cpan.org/perldoc?Spreadsheet%3A%3AWriteExcel%3A%3AFromDB" class="podlinkpod">Spreadsheet::WriteExcel::FromDB</a>: <a href="http://search.cpan.org/dist/Spreadsheet-WriteExcel-FromDB" class="podlinkurl">http://search.cpan.org/dist/Spreadsheet-WriteExcel-FromDB</a>.</p>

<p><a href="http://search.cpan.org/perldoc?Excel%3A%3ATemplate" class="podlinkpod">Excel::Template</a>: <a href="http://search.cpan.org/%7Erkinyon/Excel-Template/" class="podlinkurl">http://search.cpan.org/~rkinyon/Excel-Template/</a>.</p>

<p><a href="http://search.cpan.org/perldoc?DateTime%3A%3AFormat%3A%3AExcel" class="podlinkpod">DateTime::Format::Excel</a>: <a href="http://search.cpan.org/dist/DateTime-Format-Excel" class="podlinkurl">http://search.cpan.org/dist/DateTime-Format-Excel</a>.</p>

<p>"Reading and writing Excel files with Perl" by Teodor Zlatanov, at IBM developerWorks: <a href="http://www-106.ibm.com/developerworks/library/l-pexcel/" class="podlinkurl">http://www-106.ibm.com/developerworks/library/l-pexcel/</a>.</p>

<p>"Excel-Dateien mit Perl erstellen - Controller im Gluck" by Peter 
Dintelmann and Christian Kirsch in the German Unix/web journal iX: <a href="http://www.heise.de/ix/artikel/2001/06/175/" class="podlinkurl">http://www.heise.de/ix/artikel/2001/06/175/</a>.</p>

<p><a href="http://search.cpan.org/%7Ejmcnamara/Spreadsheet-WriteExcel-2.38/lib/Spreadsheet/WriteExcel.pm" class="podlinkpod">Spreadsheet::WriteExcel</a> documentation in Japanese by Takanori Kawai. <a href="http://member.nifty.ne.jp/hippo2000/perltips/Spreadsheet/WriteExcel.htm" class="podlinkurl">http://member.nifty.ne.jp/hippo2000/perltips/Spreadsheet/WriteExcel.htm</a>.</p>

<p>Oesterly user brushes with fame: <a href="http://oesterly.com/releases/12102000.html" class="podlinkurl">http://oesterly.com/releases/12102000.html</a>.</p>

<p>The csv2xls program that is part of <a href="http://search.cpan.org/perldoc?Text%3A%3ACSV_XS" class="podlinkpod">Text::CSV_XS</a>: <a href="http://search.cpan.org/%7Ehmbrand/Text-CSV_XS/MANIFEST" class="podlinkurl">http://search.cpan.org/~hmbrand/Text-CSV_XS/MANIFEST</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="ACKNOWLEDGMENTS">ACKNOWLEDGMENTS <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>The following people contributed to the debugging and testing of Spreadsheet::WriteExcel:</p>

<p>Alexander Farber, Andre de Bruin, Arthur@ais, Artur Silveira da 
Cunha, Bob Rose, Borgar Olsen, Brian Foley, Brian White, Bob Mackay, 
Cedric Bouvier, Chad Johnson, CPAN testers, Damyan Ivanov, Daniel 
Berger, Daniel Gardner, Dmitry Kochurov, Eric Frazier, Ernesto Baschny, 
Felipe Perez Galiana, Gordon Simpson, Hanc Pavel, Harold Bamford, James 
Holmes, James Wilkinson, Johan Ekenberg, Johann Hanne, Jonathan Scott 
Duff, J.C. Wren, Kenneth Stacey, Keith Miller, Kyle Krom, Marc 
Rosenthal, Markus Schmitz, Michael Braig, Michael Buschauer, Mike 
Blazer, Michael Erickson, Michael W J West, Ning Xie, Paul J. Falbe, 
Paul Medynski, Peter Dintelmann, Pierre Laplante, Praveen Kotha, Reto 
Badertscher, Rich Sorden, Shane Ashby, Sharron McKenzie, Shenyu Zheng, 
Stephan Loescher, Steve Sapovits, Sven Passig, Svetoslav Marinov, Tamas 
Gulacsi, Troy Daniels, Vahe Sarkissian.</p>

<p>The following people contributed patches, examples or Excel information:</p>

<p>Andrew Benham, Bill Young, Cedric Bouvier, Charles Wybble, Daniel 
Rentz, David Robins, Franco Venturi, Guy Albertelli, Ian Penman, John 
Heitmann, Jon Guy, Kyle R. Burton, Pierre-Jean Vouette, Rubio, Marco 
Geri, Mark Fowler, Matisse Enzer, Sam Kington, Takanori Kawai, Tom 
O'Sullivan.</p>

<p>Many thanks to Ron McKelvey, Ronzo Consulting for Siemens, who sponsored the development of the formula caching routines.</p>

<p>Many thanks to Cassens Transport who sponsored the development of the embedded charts and autofilters.</p>

<p>Additional thanks to Takanori Kawai for translating the documentation into Japanese.</p>

<p>Gunnar Wolf maintains the Debian distro.</p>

<p>Thanks to Damian Conway for the excellent Parse::RecDescent.</p>

<p>Thanks to Tim Jenness for File::Temp.</p>

<p>Thanks to Michael Meeks and Jody Goldberg for their work on Gnumeric.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="DISCLAIMER_OF_WARRANTY">DISCLAIMER OF WARRANTY <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Because this software is licensed free of charge, there is no 
warranty for the software, to the extent permitted by applicable law. 
Except when otherwise stated in writing the copyright holders and/or 
other parties provide the software "as is" without warranty of any kind,
 either expressed or implied, including, but not limited to, the implied
 warranties of merchantability and fitness for a particular purpose. The
 entire risk as to the quality and performance of the software is with 
you. Should the software prove defective, you assume the cost of all 
necessary servicing, repair, or correction.</p>

<p>In no event unless required by applicable law or agreed to in writing
 will any copyright holder, or any other party who may modify and/or 
redistribute the software as permitted by the above licence, be liable 
to you for damages, including any general, special, incidental, or 
consequential damages arising out of the use or inability to use the 
software (including but not limited to loss of data or data being 
rendered inaccurate or losses sustained by you or third parties or a 
failure of the software to operate with any other software), even if 
such holder or other party has been advised of the possibility of such 
damages.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="LICENSE">LICENSE <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Either the Perl Artistic Licence <a href="http://dev.perl.org/licenses/artistic.html" class="podlinkurl">http://dev.perl.org/licenses/artistic.html</a> or the GPL <a href="http://www.opensource.org/licenses/gpl-license.php" class="podlinkurl">http://www.opensource.org/licenses/gpl-license.php</a>.</p>

<h1><a class="u" href="#___top" title="click to go to top of document" name="AUTHOR">AUTHOR <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>John McNamara jmcnamara@cpan.org</p>

<pre class="sh_perl sh_sourceCode">    The ashtray says
    You were up all night<span class="sh_symbol">.</span>
    When you went to bed
    With your darkest mind<span class="sh_symbol">.</span>
    Your pillow wept
    And covered your eyes<span class="sh_symbol">.</span>
    And you finally slept
    While the sun caught fire<span class="sh_symbol">.</span>

    You<span class="sh_string">'ve changed.</span>
      <span class="sh_symbol">--</span> Jeff Tweedy</pre>

<h1><a class="u" href="#___top" title="click to go to top of document" name="COPYRIGHT">COPYRIGHT <img alt="^" src="WriteExcel.pm_files/up.gif"></a></h1>

<p>Copyright MM-MMXII, John McNamara.</p>

<p>All Rights Reserved. This module is free software. It may be used, 
redistributed and/or modified under the same terms as Perl itself.</p>

</div>
<!-- This should probably be put in the <div class="footer"></div> -->
<script type="text/javascript">
    $(document).ready(function(){
        var startingStyle = $.cookie('css') ? $.cookie('css') : 'http://st.pimg.net/tucs/css/sh_none.min.css';
        $.fn.styleSwitch(startingStyle);
        $("#styleswitch").val(startingStyle);
        sh_highlightDocument();
        $("#styleswitch").bind(($.browser.msie ? "click" : "change"), function() {
            $.fn.styleSwitch($(this).val());
        });
    });
</script>
<div class="styleswitch">
    syntax highlighting:
    <select id="styleswitch">
        <option selected="selected" value="http://st.pimg.net/tucs/css/sh_none.min.css">no syntax highlighting</option>
        <option value="http://st.pimg.net/tucs/css/sh_acid.min.css">acid</option>
        <option value="http://st.pimg.net/tucs/css/sh_berries-dark.min.css">berries-dark</option>
        <option value="http://st.pimg.net/tucs/css/sh_berries-light.min.css">berries-light</option>
        <option value="http://st.pimg.net/tucs/css/sh_bipolar.min.css">bipolar</option>
        <option value="http://st.pimg.net/tucs/css/sh_blacknblue.min.css">blacknblue</option>
        <option value="http://st.pimg.net/tucs/css/sh_bright.min.css">bright</option>
        <option value="http://st.pimg.net/tucs/css/sh_contrast.min.css">contrast</option>
        <option value="http://st.pimg.net/tucs/css/sh_cpan.min.css">cpan</option>
        <option value="http://st.pimg.net/tucs/css/sh_darkblue.min.css">darkblue</option>
        <option value="http://st.pimg.net/tucs/css/sh_darkness.min.css">darkness</option>
        <option value="http://st.pimg.net/tucs/css/sh_desert.min.css">desert</option>
        <option value="http://st.pimg.net/tucs/css/sh_dull.min.css">dull</option>
        <option value="http://st.pimg.net/tucs/css/sh_easter.min.css">easter</option>
        <option value="http://st.pimg.net/tucs/css/sh_emacs.min.css">emacs</option>
        <option value="http://st.pimg.net/tucs/css/sh_golden.min.css">golden</option>
        <option value="http://st.pimg.net/tucs/css/sh_greenlcd.min.css">greenlcd</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-anjuta.min.css">ide-anjuta</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-codewarrior.min.css">ide-codewarrior</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-devcpp.min.css">ide-devcpp</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-eclipse.min.css">ide-eclipse</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-kdev.min.css">ide-kdev</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-msvcpp.min.css">ide-msvcpp</option>
        <option value="http://st.pimg.net/tucs/css/sh_kwrite.min.css">kwrite</option>
        <option value="http://st.pimg.net/tucs/css/sh_matlab.min.css">matlab</option>
        <option value="http://st.pimg.net/tucs/css/sh_navy.min.css">navy</option>
        <option value="http://st.pimg.net/tucs/css/sh_nedit.min.css">nedit</option>
        <option value="http://st.pimg.net/tucs/css/sh_neon.min.css">neon</option>
        <option value="http://st.pimg.net/tucs/css/sh_night.min.css">night</option>
        <option value="http://st.pimg.net/tucs/css/sh_pablo.min.css">pablo</option>
        <option value="http://st.pimg.net/tucs/css/sh_peachpuff.min.css">peachpuff</option>
        <option value="http://st.pimg.net/tucs/css/sh_print.min.css">print</option>
        <option value="http://st.pimg.net/tucs/css/sh_rand01.min.css">rand01</option>
	<option value="http://st.pimg.net/tucs/css/sh_solarized-dark.min.css">solarized-dark</option>
	<option value="http://st.pimg.net/tucs/css/sh_solarized-light.min.css">solarized-light</option>
        <option value="http://st.pimg.net/tucs/css/sh_style.min.css">style</option>
        <option value="http://st.pimg.net/tucs/css/sh_the.min.css">the</option>
        <option value="http://st.pimg.net/tucs/css/sh_typical.min.css">typical</option>
        <option value="http://st.pimg.net/tucs/css/sh_vampire.min.css">vampire</option>
        <option value="http://st.pimg.net/tucs/css/sh_vim-dark.min.css">vim-dark</option>
        <option value="http://st.pimg.net/tucs/css/sh_vim.min.css">vim</option>
        <option value="http://st.pimg.net/tucs/css/sh_whatis.min.css">whatis</option>
        <option value="http://st.pimg.net/tucs/css/sh_whitengrey.min.css">whitengrey</option>
        <option value="http://st.pimg.net/tucs/css/sh_zellner.min.css">zellner</option>
    </select>
</div>



<div class="footer"><div class="cpanstats">88818 Uploads, 26954 Distributions
117819 Modules, 10442 Uploaders
</div>
hosted by <a href="http://www.yellowbot.com/">YellowBot</a><br>
<a href="http://www.yellowbot.com/"><img alt="do. tag. write. share." src="WriteExcel.pm_files/yellowbot_logo.gif"></a>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="WriteExcel.pm_files/ga.js" type="text/javascript"></script>
<script type="text/javascript" src="WriteExcel.pm_files/v6test.js"></script>

<script type="text/javascript">
   // v6.target = '';
   if (!v6.target) { v6.only_once = true }
   v6.site = '7A0D89A6-2B82-11DF-B9DA-F61CBD13F020';
   v6.api_server = 'http://ipv4.v6test.develooper.com';
   try {
     v6.test();
   } catch(err) {}
</script>
<script type="text/javascript">
  $(document).ready(function(){
    $("a[href^=http:]").click(function(){
      var href = $(this).attr('href');
      var m = href.match('\/\/([^\/:]+)');
      _gaq.push(['_trackEvent','External',m[1],'Module']);
    });
    $("a[href^=/CPAN/]").click(function(){
      var href = $(this).attr('href');
      _gaq.push(['_trackEvent','Download',href,'Module']);
    });
  });
</script>
<!-- Thu Feb 28 03:16:42 2013 GMT (0.490054130554199) @cpansearch1 -->
 

</body></html>